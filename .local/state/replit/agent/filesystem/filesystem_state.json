{"file_contents":{"README.md":{"content":"# DEXX-TER - License Management System\n\nA robust key management system designed for game hack resellers, providing comprehensive key generation, administration, and tracking capabilities.\n\n## Key Features\n\n- Role-based access control (Admin and Reseller)\n- Dynamic key generation and management\n- Game license verification system\n- JSON file-based storage\n- Mobile-friendly UI with responsive design\n- Beautiful animations and visual effects\n\n## Tech Stack\n\n- **Frontend**: React, TailwindCSS, shadcn/ui components\n- **Backend**: Express.js\n- **Storage**: JSON file-based (no database required)\n- **Authentication**: Passport.js\n- **Form validation**: React Hook Form with Zod\n\n## Deployment Guide for Render\n\nDEXX-TER is configured to deploy easily on Render with minimal setup.\n\n### Prerequisites\n\n- A Render account\n- Git repository with your DEXX-TER codebase\n\n### Deployment Steps\n\n1. In your Render dashboard, click **New** and select **Web Service**.\n2. Connect your Git repository.\n3. Configure the following settings:\n   - **Name**: Choose a name for your service (e.g., `dexxterapp`)\n   - **Environment**: Node\n   - **Build Command**: `npm install && chmod +x ./deploy.sh && ./deploy.sh`\n   - **Start Command**: `npm start`\n4. Add the following environment variables:\n   - `NODE_ENV`: `production`\n   - `SESSION_SECRET`: Generate a random string or use Render's auto-generated secret\n   - `RENDER`: `true`\n5. Under **Advanced** settings, add a disk:\n   - Size: At least 1GB\n   - Mount Path: `/data`\n6. Click **Create Web Service**\n\nRender will automatically build and deploy your application. The JSON data files will be stored on the persistent disk at the `/data` directory. The deployment script ensures that the application's static assets are properly set up for production.\n\n## Alternative Deployment Method\n\nYou can also deploy using the `render.yaml` file included in the repository. This Blueprint allows for more automated setup:\n\n1. In your Render dashboard, click **New** and select **Blueprint**.\n2. Connect your Git repository.\n3. Render will automatically detect the `render.yaml` file and set up your services.\n4. Review the settings and click **Apply**.\n\n## Local Development\n\n1. Clone the repository\n2. Install dependencies: `npm install`\n3. Start the development server: `npm run dev`\n4. Open your browser to `http://localhost:5000`\n\n## License\n\nMIT","size_bytes":2378},"build.js":{"content":"// build.js - Custom build script to ensure proper directory structure for Render deployment\nimport { exec } from 'child_process';\nimport fs from 'fs';\nimport path from 'path';\n\n// Run the standard build commands\nconsole.log('Building the client...');\nexec('vite build', (error, stdout, stderr) => {\n  if (error) {\n    console.error(`Error building client: ${error.message}`);\n    return;\n  }\n  if (stderr) {\n    console.error(`Client build stderr: ${stderr}`);\n  }\n  console.log(stdout);\n  \n  console.log('Building the server...');\n  exec('esbuild server/index.ts --platform=node --packages=external --bundle --format=esm --outdir=dist', (error, stdout, stderr) => {\n    if (error) {\n      console.error(`Error building server: ${error.message}`);\n      return;\n    }\n    if (stderr) {\n      console.error(`Server build stderr: ${stderr}`);\n    }\n    console.log(stdout);\n    \n    // If we're here, both builds succeeded\n    console.log('Creating proper directory structure for Render...');\n    \n    // Create a public directory inside dist if it doesn't exist\n    const publicDir = path.join('dist', 'public');\n    if (!fs.existsSync(publicDir)) {\n      fs.mkdirSync(publicDir, { recursive: true });\n    }\n    \n    // Check if we have output in dist/assets\n    const assetsDir = path.join('dist', 'assets');\n    if (fs.existsSync(assetsDir)) {\n      // Copy all files from dist/assets to dist/public/assets\n      const publicAssetsDir = path.join(publicDir, 'assets');\n      if (!fs.existsSync(publicAssetsDir)) {\n        fs.mkdirSync(publicAssetsDir, { recursive: true });\n      }\n      \n      const assetFiles = fs.readdirSync(assetsDir);\n      assetFiles.forEach(file => {\n        const srcPath = path.join(assetsDir, file);\n        const destPath = path.join(publicAssetsDir, file);\n        fs.copyFileSync(srcPath, destPath);\n      });\n      \n      console.log(`Copied ${assetFiles.length} assets to dist/public/assets`);\n    }\n    \n    // Copy index.html to dist/public\n    const indexHtml = path.join('dist', 'index.html');\n    if (fs.existsSync(indexHtml)) {\n      fs.copyFileSync(indexHtml, path.join(publicDir, 'index.html'));\n      console.log('Copied index.html to dist/public');\n    } else {\n      console.error('Could not find dist/index.html to copy');\n    }\n    \n    console.log('Build completed successfully and prepared for Render deployment');\n  });\n});","size_bytes":2374},"deploy.sh":{"content":"#!/bin/bash\n\n# This script is used to prepare the build for deployment on Render\n\n# First, run the standard build command\necho \"Running standard build...\"\nnpm run build\n\n# Create the necessary directory structure\necho \"Creating proper directory structure for deployment...\"\n\n# Ensure we have the client directory structure\nmkdir -p dist/client\n\n# Check if we have the expected build output\nif [ -d \"dist/assets\" ]; then\n  echo \"Copying assets to client folder...\"\n  mkdir -p dist/client/assets\n  cp -R dist/assets/* dist/client/assets/\nfi\n\n# Copy index.html to client folder\nif [ -f \"dist/index.html\" ]; then\n  echo \"Copying index.html to client folder...\"\n  cp dist/index.html dist/client/\nfi\n\n# Create an info.txt file to help with debugging\necho \"Build completed at $(date)\" > dist/client/info.txt\necho \"NODE_ENV: $NODE_ENV\" >> dist/client/info.txt\necho \"PWD: $(pwd)\" >> dist/client/info.txt\necho \"Files in dist: $(ls -la dist)\" >> dist/client/info.txt\necho \"Files in dist/client: $(ls -la dist/client)\" >> dist/client/info.txt\n\n# Create data directory with proper permissions\necho \"Creating data directory with proper permissions...\"\nmkdir -p data\nchmod 777 data\necho \"Data directory created and permissions set\"\n\necho \"Deployment preparation complete!\"","size_bytes":1257},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","size_bytes":325},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","size_bytes":80},"render.yaml":{"content":"services:\n  - type: web\n    name: aestrial-hack\n    env: node\n    buildCommand: npm install && chmod +x ./deploy.sh && ./deploy.sh\n    startCommand: npm start\n    envVars:\n      - key: NODE_ENV\n        value: production\n      - key: SESSION_SECRET\n        generateValue: true\n      - key: RENDER\n        value: true\n      - key: COOKIE_SECURE\n        value: true \n      - key: COOKIE_SAME_SITE\n        value: none\n      - key: PUBLIC_URL\n        value: https://allfixedpanel.onrender.com/\n    disk:\n      name: data-dir\n      mountPath: /opt/render/project/src/data\n      sizeGB: 1\n","size_bytes":582},"replit.md":{"content":"# Overview\n\nDEXX-TER is a robust license management system designed for game hack resellers. The application provides comprehensive key generation, administration, and tracking capabilities with role-based access control supporting both administrators and resellers. The system features a modern React frontend with a clean, responsive dark-themed UI, while the backend handles authentication, key management, and data persistence through **MongoDB**.\n\n## Recent Changes (September 2025)\n\n- **MongoDB Migration Complete**: Successfully migrated from JSON file storage to MongoDB database\n  - Secure database connection using environment variables\n  - Fresh database setup with only admin user (admin/admin123)\n  - All data tables empty for fresh start (resellers, tokens, keys, devices, online updates)\n  - Enhanced security with credentials properly managed\n- **Replit Environment Setup**: Fully configured for Replit hosting\n  - Server running on port 5000 with proper configuration\n  - MongoDB connection established and working\n  - TypeScript compilation fixed and optimized\n- **Online Updates Feature**: Complete online update management system\n  - Admin panel for creating, editing, and managing updates\n  - Public API endpoint for app users to fetch active updates\n  - Form validation and real-time UI updates\n\n# User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n# System Architecture\n\n## Frontend Architecture\n\nThe client is built using modern React with TypeScript, utilizing a component-based architecture centered around:\n\n- **React Router**: Uses Wouter for lightweight client-side routing with protected routes based on user roles\n- **State Management**: React Query (TanStack Query) for server state management and caching\n- **UI Framework**: shadcn/ui components built on Radix UI primitives with TailwindCSS for styling\n- **Form Handling**: React Hook Form with Zod validation for type-safe form management\n- **Authentication**: Context-based auth provider with session management\n- **Build Tool**: Vite for fast development and optimized production builds\n\nThe application implements a clean separation between admin and reseller interfaces, with dedicated layouts and page components for each role. The UI features a dark theme with purple accents and includes mobile-responsive design patterns.\n\n## Backend Architecture\n\nThe server follows an Express.js architecture with MongoDB as the primary database:\n\n- **MongoDB Storage**: Full MongoDB integration with Mongoose ODM for all data persistence\n- **Session Management**: Express sessions with Passport.js for authentication, supporting both admin and reseller login flows\n- **API Design**: RESTful endpoints organized by user role (/api/admin/* and /api/reseller/*)\n- **Database Models**: Comprehensive MongoDB models for Admin, Reseller, Key, Token, Device, and OnlineUpdate\n- **Build Process**: ESBuild for server bundling with custom build scripts for deployment\n- **Security**: Environment-based database credentials, bcrypt password hashing, session management\n\nThe storage system uses MongoDB collections with proper indexing and validation, providing scalable data management with full CRUD operations and data integrity.\n\n## Authentication & Authorization\n\nThe system implements a role-based authentication system with two distinct user types:\n\n- **Admins**: Full system access including reseller management, token generation, and global statistics\n- **Resellers**: Limited access to their own key generation, management, and profile data\n\nAuthentication uses Passport.js local strategy with session-based persistence. The frontend implements protected routes that redirect based on user role, ensuring proper access control throughout the application.\n\n## Data Architecture\n\nThe application uses MongoDB for all data persistence with the following collections:\n\n- **Admins**: Admin user accounts with bcrypt-hashed passwords\n- **Resellers**: Reseller accounts with credits and registration information  \n- **Keys**: License keys with game association, expiry dates, and device limits\n- **Tokens**: Referral tokens for reseller registration\n- **Devices**: Device tracking for license key usage\n- **OnlineUpdates**: Admin-managed update messages for end users\n\nAll data operations use Mongoose models with proper validation, indexing, and relationship management. The database starts fresh with only the admin user and empty tables for all other entities.\n\n# External Dependencies\n\n## Core Dependencies\n\n- **mongoose**: MongoDB ODM for database operations and model management\n- **bcryptjs**: Password hashing and verification for secure authentication\n- **@radix-ui/***: Comprehensive UI component primitives for building the shadcn/ui interface\n- **@tanstack/react-query**: Server state management and caching solution\n- **passport & passport-local**: Authentication framework and local strategy implementation\n\n## Development & Build Tools\n\n- **vite & @vitejs/plugin-react**: Modern build tool and React plugin for development and production builds\n- **esbuild**: Fast JavaScript bundler for server-side code compilation\n- **tailwindcss**: Utility-first CSS framework for styling\n- **typescript & tsx**: TypeScript runtime and development tools\n\n## Form & Validation\n\n- **react-hook-form**: Performant form library with minimal re-renders\n- **zod & @hookform/resolvers**: Schema validation and form integration\n- **@radix-ui/react-***: UI component primitives for form elements\n\n## Deployment & Hosting\n\nThe application is configured for deployment on Replit with:\n- Automatic build scripts that handle both client and server compilation\n- Environment variable configuration for MongoDB connection (MONGODB_URI)\n- MongoDB Atlas cloud database for scalable data storage\n- Port 5000 configuration for Replit hosting requirements\n- Session-based authentication with secure cookie management\n\nThe system requires a MongoDB connection string as an environment variable and is fully operational in cloud hosting environments with proper database credentials management.","size_bytes":6071},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \"var(--radius)\",\n        md: \"calc(var(--radius) - 2px)\",\n        sm: \"calc(var(--radius) - 4px)\",\n      },\n      colors: {\n        background: \"hsl(var(--background))\",\n        foreground: \"hsl(var(--foreground))\",\n        card: {\n          DEFAULT: \"hsl(var(--card))\",\n          foreground: \"hsl(var(--card-foreground))\",\n        },\n        popover: {\n          DEFAULT: \"hsl(var(--popover))\",\n          foreground: \"hsl(var(--popover-foreground))\",\n        },\n        primary: {\n          DEFAULT: \"hsl(var(--primary))\",\n          foreground: \"hsl(var(--primary-foreground))\",\n        },\n        secondary: {\n          DEFAULT: \"hsl(var(--secondary))\",\n          foreground: \"hsl(var(--secondary-foreground))\",\n        },\n        muted: {\n          DEFAULT: \"hsl(var(--muted))\",\n          foreground: \"hsl(var(--muted-foreground))\",\n        },\n        accent: {\n          DEFAULT: \"hsl(var(--accent))\",\n          foreground: \"hsl(var(--accent-foreground))\",\n        },\n        destructive: {\n          DEFAULT: \"hsl(var(--destructive))\",\n          foreground: \"hsl(var(--destructive-foreground))\",\n        },\n        border: \"hsl(var(--border))\",\n        input: \"hsl(var(--input))\",\n        ring: \"hsl(var(--ring))\",\n        chart: {\n          \"1\": \"hsl(var(--chart-1))\",\n          \"2\": \"hsl(var(--chart-2))\",\n          \"3\": \"hsl(var(--chart-3))\",\n          \"4\": \"hsl(var(--chart-4))\",\n          \"5\": \"hsl(var(--chart-5))\",\n        },\n        sidebar: {\n          DEFAULT: \"hsl(var(--sidebar-background))\",\n          foreground: \"hsl(var(--sidebar-foreground))\",\n          primary: \"hsl(var(--sidebar-primary))\",\n          \"primary-foreground\": \"hsl(var(--sidebar-primary-foreground))\",\n          accent: \"hsl(var(--sidebar-accent))\",\n          \"accent-foreground\": \"hsl(var(--sidebar-accent-foreground))\",\n          border: \"hsl(var(--sidebar-border))\",\n          ring: \"hsl(var(--sidebar-ring))\",\n        },\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: {\n            height: \"0\",\n          },\n          to: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n        },\n        \"accordion-up\": {\n          from: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n          to: {\n            height: \"0\",\n          },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","size_bytes":2787},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\nimport { fileURLToPath, URL } from 'node:url';\n\nconst __dirname = path.dirname(fileURLToPath(import.meta.url));\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n        ]\n      : []),\n  ],\n  server: {\n    host: \"0.0.0.0\",\n    port: 5000,\n    hmr: {\n      port: 5000,\n    },\n  },\n  resolve: {\n    alias: {\n      \"@\": path.resolve(__dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(__dirname, \"shared\"),\n      \"@assets\": path.resolve(__dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(__dirname, \"client\"),\n  build: {\n    outDir: path.resolve(__dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n});\n","size_bytes":1046},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport * as nodePath from \"path\";\nimport cors from \"cors\";\nimport { registerRoutes } from \"./routes\";\nimport { setupVite, serveStatic, log } from \"./vite\";\nimport { connectDatabase } from \"./database\";\n\n// Add trust proxy to avoid issues with secure cookies behind a proxy/load balancer\n// when deployed on Render or similar platforms\n\nconst app = express();\n\n// Enable trust proxy to properly handle secure cookies in production environments\napp.set('trust proxy', 1);\n\n// CORS configuration\nconst isProduction = process.env.NODE_ENV === \"production\";\n\n// Define origins for CORS\nconst corsOrigin = isProduction\n  ? [process.env.CORS_ORIGIN || \"https://allfixedpanel.onrender.com/\"] // Allow configurable origin in production\n  : true; // Allow all origins in development\n\n// Apply CORS middleware with special handling for admin endpoints\napp.use((req, res, next) => {\n  // More restrictive CORS for admin endpoints\n  if (req.path.startsWith('/api/admin/')) {\n    // For admin endpoints, only allow same-origin requests in production\n    // In development, allow localhost origins only\n    const allowedAdminOrigin = isProduction \n      ? (process.env.CORS_ORIGIN || \"https://allfixedpanel.onrender.com/\").replace(/\\/$/, '')\n      : `${req.protocol}://${req.get('host')}`;\n    \n    cors({\n      origin: allowedAdminOrigin,\n      credentials: true,\n      methods: ['GET', 'POST', 'PUT', 'DELETE', 'OPTIONS'],\n      allowedHeaders: ['Content-Type', 'Authorization'],\n      optionsSuccessStatus: 200\n    })(req, res, next);\n  } else {\n    // Standard CORS for other endpoints\n    cors({\n      origin: corsOrigin,\n      credentials: true,\n      methods: ['GET', 'POST', 'PUT', 'DELETE', 'OPTIONS'],\n      allowedHeaders: ['Content-Type', 'Authorization']\n    })(req, res, next);\n  }\n});\n\n// Parse JSON and URL-encoded bodies\napp.use(express.json());\napp.use(express.urlencoded({ extended: false }));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const reqPath = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (reqPath.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${reqPath} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"…\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  // Connect to MongoDB first\n  try {\n    await connectDatabase();\n    log(\"MongoDB connection established\");\n  } catch (error) {\n    log(`Failed to connect to MongoDB: ${error}`);\n    process.exit(1);\n  }\n\n  const server = await registerRoutes(app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (app.get(\"env\") === \"development\") {\n    await setupVite(app, server);\n  } else {\n    // In production, we need to serve static files and handle client-side routing\n    serveStatic(app);\n    \n    // Add a catch-all route for client-side routing\n    app.get('*', (req, res, next) => {\n      // Let API routes pass through to be handled by 404 handler\n      if (req.path.startsWith('/api/')) {\n        return next();\n      }\n      console.log(`Serving index.html for client-side route: ${req.path}`);\n      res.sendFile(nodePath.resolve(process.cwd(), 'dist', 'public', 'index.html'));\n    });\n    \n    // Add 404 handler for unmatched API routes\n    app.use('/api/*', (req, res) => {\n      res.status(404).json({ message: 'API endpoint not found' });\n    });\n  }\n\n  // ALWAYS serve the app on port 5000\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = 5000;\n  server.listen({\n    port,\n    host: \"0.0.0.0\",\n    reusePort: true,\n  }, () => {\n    log(`serving on port ${port}`);\n  });\n})();\n","size_bytes":4493},"server/routes.ts":{"content":"import type { Express, Request, Response } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { WebSocketServer, WebSocket } from \"ws\";\nimport { MongoDBStorage } from \"./mongodb-storage\";\nimport { \n  insertAdminSchema,\n  insertResellerSchema, \n  insertKeySchema, \n  keyVerificationSchema, \n  addCreditsSchema,\n  gameEnum,\n  insertOnlineUpdateSchema,\n  updateOnlineUpdateSchema\n} from \"@shared/schema\";\nimport { nanoid } from \"nanoid\";\nimport session from \"express-session\";\nimport MemoryStore from \"memorystore\";\nimport passport from \"passport\";\nimport { Strategy as LocalStrategy } from \"passport-local\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { generateOTP, sendOTPEmail, testEmailConfiguration } from \"./email-service\";\n\n// Initialize MongoDB storage\nconst storage = new MongoDBStorage();\n\n// WebSocket clients storage - mapping reseller IDs to their WebSocket connections\nconst resellerConnections = new Map<number, Set<any>>();\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  // MongoDB storage handles all data persistence\n\n  // Set up session middleware\n  const SessionStore = MemoryStore(session);\n  \n  // Check if we're in a production environment\n  const isProduction = process.env.NODE_ENV === \"production\";\n  \n  console.log(\"Session configuration:\", {\n    production: isProduction,\n    secureCookie: process.env.COOKIE_SECURE,\n    sameSiteCookie: process.env.COOKIE_SAME_SITE\n  });\n  \n  // Set up session with different options based on environment\n  const isSecure = process.env.COOKIE_SECURE === \"true\" || isProduction;\n  \n  // For SameSite configuration\n  // Use 'lax' for better CSRF protection - blocks cross-site requests with credentials\n  // while still allowing same-site requests and top-level navigation\n  const sameSiteOption: boolean | 'lax' | 'strict' | 'none' | undefined = 'lax';\n\n  // Handle domain for production\n  const cookieDomain = isProduction && process.env.PUBLIC_URL \n    ? new URL(process.env.PUBLIC_URL).hostname \n    : undefined;\n\n  // Set up session config\n  const sessionConfig: session.SessionOptions = {\n    secret: process.env.SESSION_SECRET || \"keymaster-secret\",\n    // Setting resave to true to ensure session stays alive\n    resave: true, \n    // We need this for the initial session to be saved\n    saveUninitialized: true,\n    store: new SessionStore({\n      checkPeriod: 86400000 // 24 hours\n    }),\n    cookie: {\n      // Must be false for localhost, true for production HTTPS\n      secure: isSecure,\n      \n      // Set to a longer max age (7 days)\n      maxAge: 7 * 24 * 60 * 60 * 1000,\n      \n      // Standard path\n      path: \"/\",\n      \n      // Set domain conditionally (only in production)\n      ...(cookieDomain ? { domain: cookieDomain } : {}),\n      \n      // Handle sameSite setting\n      sameSite: sameSiteOption,\n      \n      // Secure cookie access - prevent XSS attacks\n      httpOnly: true\n    },\n    // Add proxy trust for production environments\n    proxy: isProduction\n  };\n  \n  // Log session configuration\n  console.log(\"Applied session cookie configuration:\", {\n    secure: sessionConfig.cookie?.secure,\n    sameSite: sessionConfig.cookie?.sameSite,\n    domain: sessionConfig.cookie?.domain,\n    httpOnly: sessionConfig.cookie?.httpOnly,\n    production: isProduction\n  });\n  \n  app.use(session(sessionConfig));\n\n  // Set up passport authentication\n  app.use(passport.initialize());\n  app.use(passport.session());\n\n  // Configure passport strategies\n  passport.use('admin', new LocalStrategy(async (username, password, done) => {\n    try {\n      const isValid = await storage.verifyAdminPassword(username, password);\n      if (!isValid) {\n        return done(null, false, { message: 'Incorrect username or password' });\n      }\n      const admin = await storage.getAdminByUsername(username);\n      if (!admin) {\n        return done(null, false, { message: 'Incorrect username or password' });\n      }\n      return done(null, { id: admin.id, username: admin.username, role: 'admin' });\n    } catch (err) {\n      return done(err);\n    }\n  }));\n\n  passport.use('reseller', new LocalStrategy(async (username, password, done) => {\n    try {\n      const isValid = await storage.verifyResellerPassword(username, password);\n      if (!isValid) {\n        return done(null, false, { message: 'Incorrect username or password' });\n      }\n      const reseller = await storage.getResellerByUsername(username);\n      if (!reseller) {\n        return done(null, false, { message: 'Incorrect username or password' });\n      }\n      if (!reseller.isActive) {\n        return done(null, false, { message: 'Account is suspended' });\n      }\n      return done(null, { id: reseller.id, username: reseller.username, role: 'reseller' });\n    } catch (err) {\n      return done(err);\n    }\n  }));\n\n  passport.serializeUser((user: any, done) => {\n    console.log(\"Serializing user:\", user);\n    done(null, JSON.stringify(user));\n  });\n\n  passport.deserializeUser((serializedUser: string, done) => {\n    try {\n      const user = JSON.parse(serializedUser);\n      console.log(\"Deserialized user:\", user);\n      done(null, user);\n    } catch (error) {\n      console.error(\"Error deserializing user:\", error);\n      done(error, null);\n    }\n  });\n\n  // Auth middleware\n  const isAuthenticated = (req: Request, res: Response, next: Function) => {\n    if (req.isAuthenticated()) {\n      return next();\n    }\n    res.status(401).json({ message: 'Unauthorized' });\n  };\n\n  const isAdmin = (req: Request, res: Response, next: Function) => {\n    if (req.isAuthenticated() && (req.user as any).role === 'admin') {\n      return next();\n    }\n    res.status(403).json({ message: 'Forbidden' });\n  };\n\n  const isReseller = (req: Request, res: Response, next: Function) => {\n    if (req.isAuthenticated() && (req.user as any).role === 'reseller') {\n      return next();\n    }\n    res.status(403).json({ message: 'Forbidden' });\n  };\n\n  // CSRF protection middleware for admin write endpoints\n  const csrfProtection = (req: Request, res: Response, next: Function) => {\n    // Get the expected origin from environment or default to the request host\n    const isProduction = process.env.NODE_ENV === \"production\";\n    let expectedOrigin: string;\n    \n    if (isProduction && process.env.PUBLIC_URL) {\n      expectedOrigin = process.env.PUBLIC_URL.replace(/\\/$/, ''); // Remove trailing slash\n    } else {\n      // In development, construct from request\n      expectedOrigin = `${req.protocol}://${req.get('host')}`;\n    }\n    \n    // Check Origin header first (preferred)\n    const origin = req.get('Origin');\n    if (origin) {\n      if (origin !== expectedOrigin) {\n        console.warn(`CSRF: Invalid origin - expected: ${expectedOrigin}, received: ${origin}`);\n        return res.status(403).json({ message: 'Forbidden: Invalid origin' });\n      }\n    } else {\n      // Fallback to Referer header if Origin is not present\n      const referer = req.get('Referer');\n      if (!referer) {\n        console.warn('CSRF: No Origin or Referer header found');\n        return res.status(403).json({ message: 'Forbidden: No origin header' });\n      }\n      \n      try {\n        const refererUrl = new URL(referer);\n        const refererOrigin = `${refererUrl.protocol}//${refererUrl.host}`;\n        \n        if (refererOrigin !== expectedOrigin) {\n          console.warn(`CSRF: Invalid referer - expected: ${expectedOrigin}, received: ${refererOrigin}`);\n          return res.status(403).json({ message: 'Forbidden: Invalid referer' });\n        }\n      } catch (error) {\n        console.warn('CSRF: Invalid referer header format');\n        return res.status(403).json({ message: 'Forbidden: Invalid referer format' });\n      }\n    }\n    \n    next();\n  };\n\n  // Combined middleware for admin write operations (CSRF + auth)\n  const adminWriteProtection = [isAdmin, csrfProtection];\n\n  // Function to log authentication process\n  const logAuthProcess = (method: string, user: any, session: any) => {\n    console.log(`==== Auth process for ${method} ====`);\n    console.log('User:', user);\n    console.log('Session ID:', session?.id);\n    console.log('Session cookie:', session?.cookie);\n    console.log('==== End auth process ====');\n  }\n\n  // Auth routes - Step 1: Verify admin credentials and send OTP\n  app.post('/api/auth/admin/login', async (req, res) => {\n    try {\n      const { username, password } = req.body;\n      console.log('Admin login step 1 - credential verification:', username);\n      \n      // Verify admin credentials\n      const isValid = await storage.verifyAdminPassword(username, password);\n      if (!isValid) {\n        console.log('Admin credentials invalid for:', username);\n        return res.status(401).json({ message: 'Incorrect username or password' });\n      }\n      \n      // Get admin details for email\n      const admin = await storage.getAdminByUsername(username);\n      if (!admin || !admin.email) {\n        console.log('Admin not found or no email:', username);\n        return res.status(500).json({ message: 'Admin configuration error' });\n      }\n      \n      // Generate and store OTP\n      const otp = generateOTP();\n      await storage.createOTP(admin.id, otp);\n      \n      // Send OTP via email\n      const emailSent = await sendOTPEmail(admin.email, otp);\n      if (!emailSent) {\n        console.error('Failed to send OTP email to:', admin.email);\n        return res.status(500).json({ message: 'Failed to send verification code' });\n      }\n      \n      console.log('✅ OTP sent successfully to admin:', username);\n      \n      // Store admin info in session for step 2 verification\n      req.session.pendingAdminLogin = {\n        adminId: admin.id,\n        username: admin.username,\n        timestamp: Date.now()\n      };\n      \n      res.json({ \n        message: 'Verification code sent to your email',\n        requiresOTP: true,\n        email: admin.email.replace(/(.{2}).*@/, '$1***@') // Mask email for security\n      });\n      \n    } catch (error) {\n      console.error('Admin login step 1 error:', error);\n      res.status(500).json({ message: 'Internal server error' });\n    }\n  });\n\n  // Auth routes - Step 2: Verify OTP and complete login\n  app.post('/api/auth/admin/verify-otp', async (req, res) => {\n    try {\n      const { otp } = req.body;\n      console.log('Admin login step 2 - OTP verification');\n      \n      // Check if there's a pending admin login\n      if (!req.session.pendingAdminLogin) {\n        return res.status(400).json({ message: 'No pending login. Please start over.' });\n      }\n      \n      const { adminId, username, timestamp } = req.session.pendingAdminLogin;\n      \n      // Check if the pending login is not too old (5 minutes max)\n      if (Date.now() - timestamp > 5 * 60 * 1000) {\n        delete req.session.pendingAdminLogin;\n        return res.status(400).json({ message: 'Login session expired. Please start over.' });\n      }\n      \n      // Verify OTP\n      const otpRecord = await storage.getOTP(adminId, otp);\n      if (!otpRecord) {\n        console.log('Invalid OTP for admin:', username);\n        return res.status(401).json({ message: 'Invalid verification code' });\n      }\n      \n      // Check if OTP is still valid (not used and not expired)\n      if (otpRecord.isUsed) {\n        console.log('OTP already used for admin:', username);\n        return res.status(401).json({ message: 'Verification code already used' });\n      }\n      \n      if (new Date() > otpRecord.expiresAt) {\n        console.log('OTP expired for admin:', username);\n        return res.status(401).json({ message: 'Verification code expired' });\n      }\n      \n      // Mark OTP as used\n      await storage.markOTPAsUsed(otpRecord.id);\n      \n      // Complete the login process\n      const user = { id: adminId, username, role: 'admin' };\n      \n      req.logIn(user, (err) => {\n        if (err) {\n          console.error('Login error after OTP verification:', err);\n          return res.status(500).json({ message: 'Login failed' });\n        }\n        \n        // Clean up pending login session\n        delete req.session.pendingAdminLogin;\n        \n        logAuthProcess('admin', user, req.session);\n        console.log('✅ Admin login completed successfully:', username);\n        \n        res.json({ user });\n      });\n      \n    } catch (error) {\n      console.error('Admin OTP verification error:', error);\n      res.status(500).json({ message: 'Internal server error' });\n    }\n  });\n\n  app.post('/api/auth/reseller/login', (req, res, next) => {\n    console.log('Reseller login attempt:', req.body.username);\n    \n    passport.authenticate('reseller', (err, user, info) => {\n      if (err) {\n        console.error('Auth error:', err);\n        return next(err);\n      }\n      if (!user) {\n        console.log('Auth failed:', info.message);\n        return res.status(401).json({ message: info.message });\n      }\n      \n      req.logIn(user, (err) => {\n        if (err) {\n          console.error('Login error:', err);\n          return next(err);\n        }\n        \n        logAuthProcess('reseller', user, req.session);\n        return res.json({ user });\n      });\n    })(req, res, next);\n  });\n\n  app.post('/api/auth/logout', (req, res) => {\n    req.logout(() => {\n      res.json({ success: true });\n    });\n  });\n\n  app.get('/api/auth/session', (req, res) => {\n    // Security: Session check without logging sensitive cookie data\n    console.log(\"Session check:\", {\n      isAuthenticated: req.isAuthenticated(),\n      user: req.user || null,\n      sessionID: req.sessionID\n    });\n    \n    if (req.isAuthenticated()) {\n      res.json({ isAuthenticated: true, user: req.user });\n    } else {\n      res.json({ isAuthenticated: false });\n    }\n  });\n  \n  // Debug endpoint for checking session state (production-safe)\n  app.get('/api/auth/debug', (req, res) => {\n    res.json({\n      isAuthenticated: req.isAuthenticated(),\n      sessionID: req.sessionID,\n      user: req.user || null,\n      userAgent: req.headers['user-agent'],\n      timestamp: new Date().toISOString()\n    });\n  });\n  \n  // Simple test endpoint that doesn't require authentication\n  app.get('/api/test', (req, res) => {\n    res.json({\n      message: \"API is working\",\n      timestamp: new Date().toISOString(),\n      environment: process.env.NODE_ENV,\n      sessionID: req.sessionID,\n      hasCookies: !!req.headers.cookie\n    });\n  });\n\n  // Registration route\n  app.post('/api/auth/reseller/register', async (req, res) => {\n    try {\n      const resellerData = insertResellerSchema.parse(req.body);\n      \n      // Check if username exists\n      const existingReseller = await storage.getResellerByUsername(resellerData.username);\n      if (existingReseller) {\n        return res.status(400).json({ message: 'Username already exists' });\n      }\n      \n      // Check if token exists and is not used\n      const token = await storage.getToken(resellerData.referralToken);\n      if (!token || token.isUsed) {\n        return res.status(400).json({ message: 'Invalid or already used referral token' });\n      }\n      \n      // Create reseller with additional credits from token\n      const resellerWithCredits = {\n        ...resellerData,\n        credits: (token.credits || 0) // Add credits from token\n      };\n      const reseller = await storage.createReseller(resellerWithCredits);\n      \n      // Mark token as used\n      await storage.useToken(resellerData.referralToken, resellerData.username);\n      \n      // Reseller creation successful - MongoDB storage handles all persistence\n      \n      res.status(201).json({ \n        success: true, \n        message: 'Registration successful',\n        reseller: {\n          id: reseller.id,\n          username: reseller.username,\n          credits: reseller.credits,\n          registrationDate: reseller.registrationDate\n        }\n      });\n    } catch (error) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  // Admin routes\n  app.get('/api/admin/stats', isAdmin, async (req, res) => {\n    try {\n      const stats = await storage.getStats();\n      res.json(stats);\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  app.get('/api/admin/resellers', isAdmin, async (req, res) => {\n    try {\n      const resellers = await storage.getAllResellers();\n      const resellersWithStats = await Promise.all(\n        resellers.map(async (reseller) => {\n          const keys = await storage.getKeysByResellerId(reseller.id);\n          const now = new Date();\n          const activeKeys = keys.filter(key => !key.isRevoked && new Date(key.expiryDate) > now).length;\n          return {\n            ...reseller,\n            totalKeys: keys.length,\n            activeKeys\n          };\n        })\n      );\n      res.json(resellersWithStats);\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n  \n  // Get all keys for a specific reseller (admin view)\n  app.get('/api/admin/resellers/:id/keys', isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const resellerId = parseInt(req.params.id);\n      if (isNaN(resellerId)) {\n        return res.status(400).json({ message: 'Invalid reseller ID' });\n      }\n      \n      const keys = await storage.getKeysByResellerId(resellerId);\n      \n      // Get device counts for each key\n      const keysWithDevices = await Promise.all(keys.map(async key => {\n        const devices = await storage.getDevicesByKeyId(key.id);\n        const now = new Date();\n        let status = key.isRevoked ? \"REVOKED\" : \n                    (new Date(key.expiryDate) <= now ? \"EXPIRED\" : \"ACTIVE\");\n        \n        return {\n          ...key,\n          deviceCount: devices.length,\n          status,\n          devices: devices\n        };\n      }));\n      \n      res.json(keysWithDevices);\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n  \n  // Admin route to revoke/delete a key\n  app.delete('/api/admin/keys/:id', isAuthenticated, isAdmin, async (req, res) => {\n    try {\n      const keyId = parseInt(req.params.id);\n      if (isNaN(keyId)) {\n        return res.status(400).json({ message: 'Invalid key ID' });\n      }\n      \n      const revokedKey = await storage.revokeKey(keyId);\n      if (!revokedKey) {\n        return res.status(404).json({ message: 'Key not found' });\n      }\n      \n      res.json({ success: true, message: 'Key revoked successfully', key: revokedKey });\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  app.post('/api/admin/resellers/credits', isAdmin, async (req, res) => {\n    try {\n      const { resellerId, amount } = addCreditsSchema.parse(req.body);\n      \n      const reseller = await storage.getReseller(resellerId);\n      if (!reseller) {\n        return res.status(404).json({ message: 'Reseller not found' });\n      }\n      \n      const updatedReseller = await storage.updateResellerCredits(resellerId, amount);\n      res.json({\n        success: true,\n        reseller: updatedReseller\n      });\n    } catch (error) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  app.post('/api/admin/resellers/:id/toggle-status', isAdmin, async (req, res) => {\n    try {\n      const id = parseInt(req.params.id);\n      const { isActive } = req.body;\n      \n      if (typeof isActive !== 'boolean') {\n        return res.status(400).json({ message: 'isActive must be a boolean' });\n      }\n      \n      const reseller = await storage.getReseller(id);\n      if (!reseller) {\n        return res.status(404).json({ message: 'Reseller not found' });\n      }\n      \n      const updatedReseller = await storage.updateResellerStatus(id, isActive);\n      \n      // Notify the reseller in real-time about the status change\n      notifyResellerStatusChange(id, isActive);\n      \n      res.json({\n        success: true,\n        reseller: updatedReseller\n      });\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  app.post('/api/admin/tokens/generate', isAdmin, async (req, res) => {\n    try {\n      const { credits } = req.body;\n      \n      // Validate credits\n      if (credits !== undefined && (typeof credits !== 'number' || credits < 0 || !Number.isInteger(credits))) {\n        return res.status(400).json({ message: 'Credits must be a non-negative integer' });\n      }\n      \n      const token = await storage.createToken(credits || 0);\n      res.status(201).json({\n        success: true,\n        token\n      });\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  app.get('/api/admin/tokens', isAdmin, async (req, res) => {\n    try {\n      const tokens = await storage.getAllTokens();\n      res.json(tokens);\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Database backup routes - MongoDB Collections\n  app.get('/api/admin/backup/collections', isAdmin, async (req, res) => {\n    try {\n      // Import MongoDB models\n      const { Admin } = await import('./models/Admin');\n      const { Reseller } = await import('./models/Reseller');\n      const { Key } = await import('./models/Key');\n      const { Token } = await import('./models/Token');\n      const { Device } = await import('./models/Device');\n      const { OnlineUpdate } = await import('./models/OnlineUpdate');\n\n      // Get document counts for each collection\n      const [adminsCount, resellersCount, keysCount, tokensCount, devicesCount, updatesCount] = await Promise.all([\n        Admin.countDocuments(),\n        Reseller.countDocuments(),\n        Key.countDocuments(),\n        Token.countDocuments(),\n        Device.countDocuments(),\n        OnlineUpdate.countDocuments()\n      ]);\n\n      // Get latest update timestamps\n      const [latestAdmin, latestReseller, latestKey, latestToken, latestDevice, latestUpdate] = await Promise.all([\n        Admin.findOne().sort({ createdAt: -1 }),\n        Reseller.findOne().sort({ createdAt: -1 }),\n        Key.findOne().sort({ createdAt: -1 }),\n        Token.findOne().sort({ createdAt: -1 }),\n        Device.findOne().sort({ createdAt: -1 }),\n        OnlineUpdate.findOne().sort({ createdAt: -1 })\n      ]);\n\n      const collections = [\n        {\n          name: 'admins.json',\n          collectionName: 'admins',\n          size: adminsCount * 150, // Approximate size\n          count: adminsCount,\n          modified: latestAdmin ? latestAdmin.createdAt : new Date(),\n          downloadUrl: '/api/admin/backup/download/admins.json'\n        },\n        {\n          name: 'resellers.json',\n          collectionName: 'resellers',\n          size: resellersCount * 200, // Approximate size\n          count: resellersCount,\n          modified: latestReseller ? latestReseller.createdAt : new Date(),\n          downloadUrl: '/api/admin/backup/download/resellers.json'\n        },\n        {\n          name: 'keys.json',\n          collectionName: 'keys',\n          size: keysCount * 180, // Approximate size\n          count: keysCount,\n          modified: latestKey ? latestKey.createdAt : new Date(),\n          downloadUrl: '/api/admin/backup/download/keys.json'\n        },\n        {\n          name: 'tokens.json',\n          collectionName: 'tokens',\n          size: tokensCount * 120, // Approximate size\n          count: tokensCount,\n          modified: latestToken ? latestToken.createdAt : new Date(),\n          downloadUrl: '/api/admin/backup/download/tokens.json'\n        },\n        {\n          name: 'devices.json',\n          collectionName: 'devices',\n          size: devicesCount * 100, // Approximate size\n          count: devicesCount,\n          modified: latestDevice ? latestDevice.createdAt : new Date(),\n          downloadUrl: '/api/admin/backup/download/devices.json'\n        },\n        {\n          name: 'online_updates.json',\n          collectionName: 'online_updates',\n          size: updatesCount * 250, // Approximate size\n          count: updatesCount,\n          modified: latestUpdate ? latestUpdate.createdAt : new Date(),\n          downloadUrl: '/api/admin/backup/download/online_updates.json'\n        }\n      ];\n      \n      res.json(collections);\n    } catch (error) {\n      console.error('Error fetching collections:', error);\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  app.get('/api/admin/backup/download/:filename', isAdmin, async (req, res) => {\n    try {\n      const filename = req.params.filename;\n      \n      // Define allowed collections\n      const allowedCollections = [\n        'admins.json',\n        'resellers.json',\n        'keys.json',\n        'tokens.json',\n        'devices.json',\n        'online_updates.json'\n      ];\n      \n      // Security check\n      if (!allowedCollections.includes(filename)) {\n        return res.status(404).json({ message: 'Collection not found' });\n      }\n      \n      // Import MongoDB models\n      const { Admin } = await import('./models/Admin');\n      const { Reseller } = await import('./models/Reseller');\n      const { Key } = await import('./models/Key');\n      const { Token } = await import('./models/Token');\n      const { Device } = await import('./models/Device');\n      const { OnlineUpdate } = await import('./models/OnlineUpdate');\n      \n      let data;\n      let collectionName;\n      \n      switch (filename) {\n        case 'admins.json':\n          data = await Admin.find({}).select('-__v -password').lean();\n          collectionName = 'admins';\n          break;\n        case 'resellers.json':\n          data = await Reseller.find({}).select('-__v -password').lean();\n          collectionName = 'resellers';\n          break;\n        case 'keys.json':\n          data = await Key.find({}).select('-__v').lean();\n          collectionName = 'keys';\n          break;\n        case 'tokens.json':\n          data = await Token.find({}).select('-__v').lean();\n          collectionName = 'tokens';\n          break;\n        case 'devices.json':\n          data = await Device.find({}).select('-__v').lean();\n          collectionName = 'devices';\n          break;\n        case 'online_updates.json':\n          data = await OnlineUpdate.find({}).select('-__v').lean();\n          collectionName = 'online_updates';\n          break;\n        default:\n          return res.status(404).json({ message: 'Collection not found' });\n      }\n      \n      // Format the response with metadata\n      const exportData = {\n        collection: collectionName,\n        exportDate: new Date().toISOString(),\n        totalRecords: data.length,\n        data: data\n      };\n      \n      // Set headers for file download\n      const sanitizedFilename = filename.replace(/[^a-zA-Z0-9.-]/g, '_');\n      res.setHeader('Content-Type', 'application/json');\n      res.setHeader('Content-Disposition', `attachment; filename=\"${sanitizedFilename}\"`);\n      \n      // Send the data as JSON\n      res.json(exportData);\n      \n    } catch (error: any) {\n      console.error('Download error:', error);\n      res.status(500).json({ message: error.message || 'Failed to download collection' });\n    }\n  });\n\n  app.get('/api/admin/backup/download-all', isAdmin, async (req, res) => {\n    try {\n      // Import MongoDB models\n      const { Admin } = await import('./models/Admin');\n      const { Reseller } = await import('./models/Reseller');\n      const { Key } = await import('./models/Key');\n      const { Token } = await import('./models/Token');\n      const { Device } = await import('./models/Device');\n      const { OnlineUpdate } = await import('./models/OnlineUpdate');\n      \n      // Fetch all data from MongoDB collections (excluding sensitive fields)\n      const [admins, resellers, keys, tokens, devices, onlineUpdates] = await Promise.all([\n        Admin.find({}).select('-__v -password').lean(),\n        Reseller.find({}).select('-__v -password').lean(),\n        Key.find({}).select('-__v').lean(),\n        Token.find({}).select('-__v').lean(),\n        Device.find({}).select('-__v').lean(),\n        OnlineUpdate.find({}).select('-__v').lean()\n      ]);\n      \n      // Create combined backup object\n      const timestamp = new Date().toISOString().replace(/[:.]/g, '-');\n      const archiveName = `dexter-complete-backup-${timestamp}.json`;\n      \n      const backup = {\n        exportDate: new Date().toISOString(),\n        databaseType: 'MongoDB',\n        collections: {\n          admins: {\n            totalRecords: admins.length,\n            data: admins\n          },\n          resellers: {\n            totalRecords: resellers.length,\n            data: resellers\n          },\n          keys: {\n            totalRecords: keys.length,\n            data: keys\n          },\n          tokens: {\n            totalRecords: tokens.length,\n            data: tokens\n          },\n          devices: {\n            totalRecords: devices.length,\n            data: devices\n          },\n          online_updates: {\n            totalRecords: onlineUpdates.length,\n            data: onlineUpdates\n          }\n        },\n        summary: {\n          totalCollections: 6,\n          totalRecords: admins.length + resellers.length + keys.length + tokens.length + devices.length + onlineUpdates.length\n        }\n      };\n      \n      res.setHeader('Content-Disposition', `attachment; filename=\"${archiveName}\"`);\n      res.setHeader('Content-Type', 'application/json');\n      res.json(backup);\n    } catch (error: any) {\n      console.error('Download all error:', error);\n      res.status(500).json({ message: error.message || 'Failed to download all collections' });\n    }\n  });\n\n  // Online Update routes\n  app.get('/api/admin/online-updates', isAdmin, async (req, res) => {\n    try {\n      const updates = await storage.getAllOnlineUpdates();\n      res.json(updates);\n    } catch (error: any) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  app.post('/api/admin/online-updates', adminWriteProtection, async (req, res) => {\n    try {\n      const updateData = insertOnlineUpdateSchema.parse(req.body);\n      const update = await storage.createOnlineUpdate(updateData);\n      res.status(201).json({\n        success: true,\n        update\n      });\n    } catch (error: any) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  app.get('/api/admin/online-updates/:id', isAdmin, async (req, res) => {\n    try {\n      const id = parseInt(req.params.id);\n      if (isNaN(id)) {\n        return res.status(400).json({ message: 'Invalid update ID' });\n      }\n      \n      const update = await storage.getOnlineUpdate(id);\n      if (!update) {\n        return res.status(404).json({ message: 'Update not found' });\n      }\n      \n      res.json(update);\n    } catch (error: any) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  app.put('/api/admin/online-updates/:id', adminWriteProtection, async (req, res) => {\n    try {\n      const id = parseInt(req.params.id);\n      if (isNaN(id)) {\n        return res.status(400).json({ message: 'Invalid update ID' });\n      }\n      \n      const updateData = updateOnlineUpdateSchema.parse({ id, ...req.body });\n      const update = await storage.updateOnlineUpdate(id, updateData);\n      \n      if (!update) {\n        return res.status(404).json({ message: 'Update not found' });\n      }\n      \n      res.json({\n        success: true,\n        update\n      });\n    } catch (error: any) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  app.delete('/api/admin/online-updates/:id', adminWriteProtection, async (req, res) => {\n    try {\n      const id = parseInt(req.params.id);\n      if (isNaN(id)) {\n        return res.status(400).json({ message: 'Invalid update ID' });\n      }\n      \n      const deleted = await storage.deleteOnlineUpdate(id);\n      if (!deleted) {\n        return res.status(404).json({ message: 'Update not found' });\n      }\n      \n      res.json({\n        success: true,\n        message: 'Update deleted successfully'\n      });\n    } catch (error: any) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Public API for apps to fetch active updates\n  app.get('/api/updates', async (req, res) => {\n    try {\n      const updates = await storage.getActiveOnlineUpdates();\n      res.json(updates);\n    } catch (error: any) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Reseller routes\n  app.get('/api/reseller/profile', isReseller, async (req, res) => {\n    try {\n      const user = req.user as any;\n      const reseller = await storage.getReseller(user.id);\n      if (!reseller) {\n        return res.status(404).json({ message: 'Reseller not found' });\n      }\n      \n      const keys = await storage.getKeysByResellerId(reseller.id);\n      const now = new Date();\n      const activeKeys = keys.filter(key => !key.isRevoked && new Date(key.expiryDate) > now).length;\n      const expiredKeys = keys.filter(key => !key.isRevoked && new Date(key.expiryDate) <= now).length;\n      \n      res.json({\n        id: reseller.id,\n        username: reseller.username,\n        credits: reseller.credits,\n        registrationDate: reseller.registrationDate,\n        activeKeys,\n        expiredKeys,\n        totalKeys: keys.length\n      });\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  app.get('/api/reseller/keys', isReseller, async (req, res) => {\n    try {\n      const user = req.user as any;\n      const keys = await storage.getKeysByResellerId(user.id);\n      \n      // Get device count for each key\n      const keysWithDevices = await Promise.all(\n        keys.map(async (key) => {\n          const devices = await storage.getDevicesByKeyId(key.id);\n          const now = new Date();\n          let status = key.isRevoked ? \"REVOKED\" : \n                      (new Date(key.expiryDate) <= now ? \"EXPIRED\" : \"ACTIVE\");\n          \n          return {\n            ...key,\n            devices: devices.length,\n            status\n          };\n        })\n      );\n      \n      res.json(keysWithDevices);\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  app.post('/api/reseller/keys/generate', isReseller, async (req, res) => {\n    try {\n      const user = req.user as any;\n      \n      // Log request data for debugging\n      console.log(\"Incoming key generation request:\", req.body);\n      \n      // Handle days parameter if provided instead of expiryDate\n      let formData = { ...req.body };\n      \n      // If days parameter is provided, calculate expiryDate based on days\n      if (req.body.days && !req.body.expiryDate) {\n        const days = parseInt(req.body.days);\n        const expiryDate = new Date();\n        expiryDate.setDate(expiryDate.getDate() + days);\n        formData.expiryDate = expiryDate;\n        console.log(`Calculated expiry date from ${days} days:`, expiryDate);\n      } else if (req.body.expiryDate) {\n        // Parse expiryDate string to Date if it's a string\n        formData.expiryDate = req.body.expiryDate instanceof Date \n          ? req.body.expiryDate \n          : new Date(req.body.expiryDate);\n      }\n      \n      // Validate data with schema\n      const keyData = insertKeySchema.parse(formData);\n      \n      // Log parsed data\n      console.log(\"Parsed key data:\", keyData);\n      \n      // Validate game enum\n      try {\n        gameEnum.parse(keyData.game);\n      } catch (error) {\n        return res.status(400).json({ message: 'Invalid game selection' });\n      }\n      \n      // Check if custom key already exists\n      if (keyData.keyString) {\n        const existingKey = await storage.getKey(keyData.keyString);\n        if (existingKey) {\n          return res.status(400).json({ message: 'This key already exists' });\n        }\n      }\n      \n      // Check reseller credits\n      const reseller = await storage.getReseller(user.id);\n      if (!reseller) {\n        return res.status(404).json({ message: 'Reseller not found' });\n      }\n      \n      const count = req.body.count || 1;\n      if (reseller.credits < count) {\n        return res.status(400).json({ message: 'Insufficient credits' });\n      }\n      \n      // Generate keys\n      const generatedKeys = [];\n      for (let i = 0; i < count; i++) {\n        const keyString = keyData.keyString || generateKeyString(keyData.game);\n        const key = await storage.createKey({\n          ...keyData,\n          keyString: i === 0 ? keyString : generateKeyString(keyData.game),\n          resellerId: user.id\n        });\n        generatedKeys.push(key);\n      }\n      \n      // Deduct credits\n      await storage.updateResellerCredits(user.id, -count);\n      \n      // Keys successfully stored in MongoDB\n      \n      res.status(201).json({\n        success: true,\n        keys: generatedKeys,\n        remainingCredits: reseller.credits - count\n      });\n    } catch (error) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  app.post('/api/reseller/keys/:id/revoke', isReseller, async (req, res) => {\n    try {\n      const keyId = parseInt(req.params.id);\n      const user = req.user as any;\n      \n      // Find the key\n      const keys = await storage.getKeysByResellerId(user.id);\n      const key = keys.find(k => k.id === keyId);\n      \n      if (!key) {\n        return res.status(404).json({ message: 'Key not found or does not belong to you' });\n      }\n      \n      // Revoke the key\n      const revokedKey = await storage.revokeKey(keyId);\n      \n      res.json({\n        success: true,\n        key: revokedKey\n      });\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  app.get('/api/reseller/keys/:id', isReseller, async (req, res) => {\n    try {\n      const keyId = parseInt(req.params.id);\n      const user = req.user as any;\n      \n      // Find the key\n      const keys = await storage.getKeysByResellerId(user.id);\n      const key = keys.find(k => k.id === keyId);\n      \n      if (!key) {\n        return res.status(404).json({ message: 'Key not found or does not belong to you' });\n      }\n      \n      // Get devices associated with the key\n      const devices = await storage.getDevicesByKeyId(keyId);\n      \n      // Calculate status\n      const now = new Date();\n      let status = key.isRevoked ? \"REVOKED\" : \n                  (new Date(key.expiryDate) <= now ? \"EXPIRED\" : \"ACTIVE\");\n      \n      res.json({\n        ...key,\n        devices,\n        status\n      });\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  app.post('/api/reseller/keys/:id/devices/:deviceId/remove', isReseller, async (req, res) => {\n    try {\n      const keyId = parseInt(req.params.id);\n      const deviceId = req.params.deviceId;\n      const user = req.user as any;\n      \n      // Find the key\n      const keys = await storage.getKeysByResellerId(user.id);\n      const key = keys.find(k => k.id === keyId);\n      \n      if (!key) {\n        return res.status(404).json({ message: 'Key not found or does not belong to you' });\n      }\n      \n      // Remove the device\n      const success = await storage.removeDevice(deviceId, keyId);\n      \n      if (!success) {\n        return res.status(404).json({ message: 'Device not found' });\n      }\n      \n      res.json({\n        success: true,\n        message: 'Device removed successfully'\n      });\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Public API for key verification\n  app.post('/api/verify', async (req, res) => {\n    try {\n      const { key: keyString, deviceId, game } = keyVerificationSchema.parse(req.body);\n      \n      // Find the key\n      const key = await storage.getKey(keyString);\n      \n      // Key not found\n      if (!key) {\n        return res.json({\n          valid: false,\n          message: \"Invalid license key\"\n        });\n      }\n      \n      // Check if key is for the right game\n      if (key.game !== game) {\n        return res.json({\n          valid: false,\n          message: \"License key is not valid for this game\"\n        });\n      }\n      \n      // Check if key is revoked\n      if (key.isRevoked) {\n        return res.json({\n          valid: false,\n          message: \"License key has been revoked\"\n        });\n      }\n      \n      // Check if key is expired\n      const now = new Date();\n      if (new Date(key.expiryDate) <= now) {\n        return res.json({\n          valid: false,\n          message: \"License key has expired\",\n          expiry: key.expiryDate\n        });\n      }\n      \n      // Get devices for this key\n      const devices = await storage.getDevicesByKeyId(key.id);\n      \n      // Check if device is already registered\n      const deviceExists = devices.some(d => d.deviceId === deviceId);\n      \n      // If device exists, return success\n      if (deviceExists) {\n        return res.json({\n          valid: true,\n          expiry: key.expiryDate,\n          deviceLimit: key.deviceLimit,\n          currentDevices: devices.length,\n          message: \"License valid\"\n        });\n      }\n      \n      // Check device limit\n      if (devices.length >= key.deviceLimit) {\n        return res.json({\n          valid: false,\n          expiry: key.expiryDate,\n          deviceLimit: key.deviceLimit,\n          currentDevices: devices.length,\n          message: \"Device limit reached for this license key\"\n        });\n      }\n      \n      // Register new device\n      await storage.addDevice({\n        keyId: key.id,\n        deviceId\n      });\n      \n      // Return success\n      return res.json({\n        valid: true,\n        expiry: key.expiryDate,\n        deviceLimit: key.deviceLimit,\n        currentDevices: devices.length + 1,\n        message: \"License valid\"\n      });\n    } catch (error) {\n      res.status(400).json({ \n        valid: false,\n        message: error.message \n      });\n    }\n  });\n\n  // GET API for key verification\n  app.get('/api/verify/:key/:game/:deviceId', async (req, res) => {\n    try {\n      const keyString = req.params.key;\n      const game = req.params.game;\n      const deviceId = req.params.deviceId;\n      \n      // Validate params\n      if (!keyString || !game || !deviceId) {\n        return res.status(400).json({ \n          valid: false,\n          message: \"Missing required parameters. Need key, game, and deviceId.\" \n        });\n      }\n\n      // Validate game\n      if (![\"PUBG MOBILE\", \"LAST ISLAND OF SURVIVAL\", \"STANDOFF2\"].includes(game)) {\n        return res.status(400).json({ \n          valid: false,\n          message: \"Invalid game. Must be one of: PUBG MOBILE, LAST ISLAND OF SURVIVAL, STANDOFF2\" \n        });\n      }\n      \n      // Find the key\n      const key = await storage.getKey(keyString);\n      \n      // Key not found\n      if (!key) {\n        return res.json({\n          valid: false,\n          message: \"Invalid license key\"\n        });\n      }\n      \n      // Check if key is for the right game\n      if (key.game !== game) {\n        return res.json({\n          valid: false,\n          message: \"License key is not valid for this game\"\n        });\n      }\n      \n      // Check if key is revoked\n      if (key.isRevoked) {\n        return res.json({\n          valid: false,\n          message: \"License key has been revoked\"\n        });\n      }\n      \n      // Check if key is expired\n      const now = new Date();\n      if (new Date(key.expiryDate) <= now) {\n        return res.json({\n          valid: false,\n          message: \"License key has expired\",\n          expiry: key.expiryDate\n        });\n      }\n      \n      // Get devices for this key\n      const devices = await storage.getDevicesByKeyId(key.id);\n      \n      // Check if device is already registered\n      const deviceExists = devices.some(d => d.deviceId === deviceId);\n      \n      // If device exists, return success\n      if (deviceExists) {\n        return res.json({\n          valid: true,\n          expiry: key.expiryDate,\n          deviceLimit: key.deviceLimit,\n          currentDevices: devices.length,\n          message: \"License valid\"\n        });\n      }\n      \n      // Check device limit\n      if (devices.length >= key.deviceLimit) {\n        return res.json({\n          valid: false,\n          expiry: key.expiryDate,\n          deviceLimit: key.deviceLimit,\n          currentDevices: devices.length,\n          message: \"Device limit reached for this license key\"\n        });\n      }\n      \n      // Return success but do not register device (GET request is for checking only)\n      return res.json({\n        valid: true,\n        expiry: key.expiryDate,\n        deviceLimit: key.deviceLimit,\n        currentDevices: devices.length,\n        canRegister: true,\n        message: \"License valid, device can be registered\"\n      });\n    } catch (error) {\n      res.status(400).json({ \n        valid: false,\n        message: \"Error verifying license key\" \n      });\n    }\n  });\n\n  // Helper functions\n  function generateKeyString(game: string): string {\n    let prefix = \"\";\n    \n    if (game === \"PUBG MOBILE\") {\n      prefix = \"PBGM\";\n    } else if (game === \"LAST ISLAND OF SURVIVAL\") {\n      prefix = \"LIOS\";\n    } else if (game === \"STANDOFF2\") {\n      prefix = \"STDF\";\n    }\n    \n    const segments = [\n      nanoid(5).toUpperCase(),\n      nanoid(5).toUpperCase(),\n      nanoid(5).toUpperCase()\n    ];\n    \n    return `${prefix}-${segments.join('-')}`;\n  }\n\n  const httpServer = createServer(app);\n  \n  // Setup WebSocket server for real-time notifications\n  const wss = new WebSocketServer({ \n    server: httpServer,\n    path: '/ws'\n  });\n\n  wss.on('connection', (ws, req) => {\n    console.log('WebSocket connection established');\n    \n    // Handle incoming messages from clients\n    ws.on('message', async (message) => {\n      try {\n        const data = JSON.parse(message.toString());\n        \n        if (data.type === 'auth' && data.resellerId) {\n          // Associate this WebSocket connection with a reseller ID\n          const resellerId = parseInt(data.resellerId);\n          \n          // Verify the reseller exists and is active before associating the connection\n          try {\n            const reseller = await storage.getReseller(resellerId);\n            if (!reseller) {\n              ws.send(JSON.stringify({\n                type: 'auth_error',\n                message: 'Invalid reseller ID'\n              }));\n              ws.close(1008, 'Invalid reseller ID');\n              return;\n            }\n            \n            if (!reseller.isActive) {\n              ws.send(JSON.stringify({\n                type: 'auth_error', \n                message: 'Account is suspended'\n              }));\n              ws.close(1008, 'Account suspended');\n              return;\n            }\n            \n            if (!resellerConnections.has(resellerId)) {\n              resellerConnections.set(resellerId, new Set());\n            }\n            resellerConnections.get(resellerId)?.add(ws);\n            \n            // Store reseller ID on the WebSocket for cleanup\n            (ws as any).resellerId = resellerId;\n            \n            console.log(`Reseller ${resellerId} connected via WebSocket`);\n            \n            // Send confirmation\n            ws.send(JSON.stringify({\n              type: 'auth_success',\n              message: 'WebSocket authenticated'\n            }));\n          } catch (error) {\n            console.error('Error authenticating WebSocket connection:', error);\n            ws.send(JSON.stringify({\n              type: 'auth_error',\n              message: 'Authentication failed'\n            }));\n            ws.close(1011, 'Authentication failed');\n          }\n        }\n      } catch (error) {\n        console.error('Error parsing WebSocket message:', error);\n      }\n    });\n\n    // Handle disconnection\n    ws.on('close', () => {\n      const resellerId = (ws as any).resellerId;\n      if (resellerId && resellerConnections.has(resellerId)) {\n        resellerConnections.get(resellerId)?.delete(ws);\n        \n        // Clean up empty sets\n        if (resellerConnections.get(resellerId)?.size === 0) {\n          resellerConnections.delete(resellerId);\n        }\n        \n        console.log(`Reseller ${resellerId} disconnected from WebSocket`);\n      }\n    });\n\n    ws.on('error', (error) => {\n      console.error('WebSocket error:', error);\n    });\n  });\n\n  // Function to notify reseller of suspension status change\n  function notifyResellerStatusChange(resellerId: number, isActive: boolean) {\n    const connections = resellerConnections.get(resellerId);\n    if (connections && connections.size > 0) {\n      const message = JSON.stringify({\n        type: 'status_change',\n        isActive,\n        message: isActive \n          ? 'Your account has been reactivated by the admin.'\n          : 'YOUR ACCOUNT HAS BEEN SUSPENDED BY ADMIN, CONTACT ADMIN FOR MORE DETAILS.'\n      });\n      \n      connections.forEach(ws => {\n        if (ws.readyState === WebSocket.OPEN) {\n          ws.send(message);\n        }\n      });\n      \n      console.log(`Notified reseller ${resellerId} of status change: ${isActive ? 'activated' : 'suspended'}`);\n    }\n  }\n  \n  return httpServer;\n}\n","size_bytes":49024},"server/storage.ts":{"content":"import { \n  Admin, InsertAdmin, admins,\n  Token, InsertToken, tokens,\n  Reseller, InsertReseller, resellers,\n  Key, InsertKey, keys, \n  Device, InsertDevice, devices,\n  Game, keyStatusEnum, KeyStatus,\n  OnlineUpdate, InsertOnlineUpdate, UpdateOnlineUpdate\n} from \"@shared/schema\";\nimport { nanoid } from \"nanoid\";\nimport * as fs from 'fs';\nimport * as path from 'path';\n\nexport interface IStorage {\n  // Admin methods\n  getAdmin(id: number): Promise<Admin | undefined>;\n  getAdminByUsername(username: string): Promise<Admin | undefined>;\n  createAdmin(admin: InsertAdmin): Promise<Admin>;\n  \n  // OTP methods\n  createOTP(adminId: number, otp: string): Promise<{ id: number; adminId: number; otp: string; expiresAt: Date; isUsed: boolean }>;\n  getOTP(adminId: number, otp: string): Promise<{ id: number; adminId: number; otp: string; expiresAt: Date; isUsed: boolean } | undefined>;\n  markOTPAsUsed(id: number): Promise<boolean>;\n  cleanupExpiredOTPs(): Promise<void>;\n  \n  // Token methods\n  createToken(credits?: number): Promise<Token>;\n  getAllTokens(): Promise<Token[]>;\n  getToken(token: string): Promise<Token | undefined>;\n  useToken(token: string, username: string): Promise<Token | undefined>;\n  \n  // Reseller methods\n  getReseller(id: number): Promise<Reseller | undefined>;\n  getResellerByUsername(username: string): Promise<Reseller | undefined>;\n  createReseller(reseller: InsertReseller & { credits?: number }): Promise<Reseller>;\n  getAllResellers(): Promise<Reseller[]>;\n  updateResellerCredits(id: number, amount: number): Promise<Reseller | undefined>;\n  updateResellerStatus(id: number, isActive: boolean): Promise<Reseller | undefined>;\n  \n  // Key methods\n  createKey(key: InsertKey): Promise<Key>;\n  getKey(keyString: string): Promise<Key | undefined>;\n  getKeysByResellerId(resellerId: number): Promise<Key[]>;\n  getAllKeys(): Promise<Key[]>;\n  revokeKey(keyId: number): Promise<Key | undefined>;\n  \n  // Device methods\n  addDevice(device: InsertDevice): Promise<Device>;\n  getDevicesByKeyId(keyId: number): Promise<Device[]>;\n  removeDevice(deviceId: string, keyId: number): Promise<boolean>;\n  \n  // Online update methods\n  createOnlineUpdate(update: InsertOnlineUpdate): Promise<OnlineUpdate>;\n  getAllOnlineUpdates(): Promise<OnlineUpdate[]>;\n  getOnlineUpdate(id: number): Promise<OnlineUpdate | undefined>;\n  updateOnlineUpdate(id: number, update: Partial<UpdateOnlineUpdate>): Promise<OnlineUpdate | undefined>;\n  deleteOnlineUpdate(id: number): Promise<boolean>;\n  getActiveOnlineUpdates(): Promise<OnlineUpdate[]>;\n  \n  // Stats\n  getStats(): Promise<{\n    totalResellers: number;\n    activeKeys: number;\n    availableTokens: number;\n  }>;\n}\n\nexport class MemStorage implements IStorage {\n  private admins: Map<number, Admin>;\n  private tokens: Map<number, Token>;\n  private resellers: Map<number, Reseller>;\n  private keys: Map<number, Key>;\n  private devices: Map<number, Device>;\n  private onlineUpdates: Map<number, OnlineUpdate>;\n  \n  private adminId: number = 1;\n  private tokenId: number = 1;\n  private resellerId: number = 1;\n  private keyId: number = 1;\n  private deviceId: number = 1;\n  private onlineUpdateId: number = 1;\n\n  constructor() {\n    this.admins = new Map();\n    this.tokens = new Map();\n    this.resellers = new Map();\n    this.keys = new Map();\n    this.devices = new Map();\n    this.onlineUpdates = new Map();\n    \n    // Create default admin\n    this.createAdmin({\n      username: \"admin\",\n      password: \"admin123\"\n    });\n    \n    // Load online updates from file if it exists\n    this.loadOnlineUpdatesFromFile();\n  }\n\n  // Load online updates from JSON file on startup\n  private loadOnlineUpdatesFromFile(): void {\n    try {\n      const filePath = path.join('.', 'data', 'online_updates.json');\n      if (fs.existsSync(filePath)) {\n        const fileContent = fs.readFileSync(filePath, 'utf8');\n        const updates = JSON.parse(fileContent);\n        \n        if (Array.isArray(updates)) {\n          updates.forEach((update: any) => {\n            // Convert date strings back to Date objects\n            const onlineUpdate: OnlineUpdate = {\n              ...update,\n              createdAt: new Date(update.createdAt),\n              updatedAt: new Date(update.updatedAt)\n            };\n            \n            this.onlineUpdates.set(onlineUpdate.id, onlineUpdate);\n            \n            // Update the ID counter to prevent conflicts\n            if (onlineUpdate.id >= this.onlineUpdateId) {\n              this.onlineUpdateId = onlineUpdate.id + 1;\n            }\n          });\n          \n          console.log(`Loaded ${updates.length} online updates from file`);\n        }\n      } else {\n        console.log('No online updates file found, starting with empty updates');\n      }\n    } catch (error: any) {\n      console.error(`Error loading online updates from file: ${error.message}`);\n      // Continue with empty updates if loading fails\n    }\n  }\n\n  // Admin methods\n  async getAdmin(id: number): Promise<Admin | undefined> {\n    return this.admins.get(id);\n  }\n\n  async getAdminByUsername(username: string): Promise<Admin | undefined> {\n    return Array.from(this.admins.values()).find(\n      (admin) => admin.username === username\n    );\n  }\n\n  async createAdmin(insertAdmin: InsertAdmin): Promise<Admin> {\n    const id = this.adminId++;\n    const admin: Admin = { ...insertAdmin, id };\n    this.admins.set(id, admin);\n    return admin;\n  }\n\n  // Token methods\n  async createToken(credits: number = 0): Promise<Token> {\n    const id = this.tokenId++;\n    const tokenString = `REF-${nanoid(10).toUpperCase()}`;\n    const token: Token = {\n      id,\n      token: tokenString,\n      createdAt: new Date(),\n      usedBy: null,\n      isUsed: false,\n      credits\n    };\n    this.tokens.set(id, token);\n    return token;\n  }\n\n  async getAllTokens(): Promise<Token[]> {\n    return Array.from(this.tokens.values());\n  }\n\n  async getToken(tokenString: string): Promise<Token | undefined> {\n    return Array.from(this.tokens.values()).find(\n      (token) => token.token === tokenString\n    );\n  }\n\n  async useToken(tokenString: string, username: string): Promise<Token | undefined> {\n    const token = await this.getToken(tokenString);\n    if (token && !token.isUsed) {\n      const updatedToken: Token = {\n        ...token,\n        isUsed: true,\n        usedBy: username\n      };\n      this.tokens.set(token.id, updatedToken);\n      return updatedToken;\n    }\n    return undefined;\n  }\n\n  // Reseller methods\n  async getReseller(id: number): Promise<Reseller | undefined> {\n    return this.resellers.get(id);\n  }\n\n  async getResellerByUsername(username: string): Promise<Reseller | undefined> {\n    return Array.from(this.resellers.values()).find(\n      (reseller) => reseller.username === username\n    );\n  }\n\n  async createReseller(insertReseller: InsertReseller & { credits?: number }): Promise<Reseller> {\n    const id = this.resellerId++;\n    const reseller: Reseller = {\n      ...insertReseller,\n      id,\n      credits: insertReseller.credits || 0,\n      registrationDate: new Date(),\n      isActive: true\n    };\n    this.resellers.set(id, reseller);\n    \n    // Create a personal JSON file for the reseller's keys\n    try {\n      // Check if a directory for storing reseller files exists, if not create it\n      const resellerDirPath = path.join('.', 'data');\n      if (!fs.existsSync(resellerDirPath)) {\n        fs.mkdirSync(resellerDirPath, { recursive: true });\n      }\n      \n      // Create a personal JSON file for the reseller with their username\n      const filePath = path.join(resellerDirPath, `${reseller.username}.json`);\n      const initialData = {\n        resellerId: reseller.id,\n        username: reseller.username,\n        keys: []\n      };\n      fs.writeFileSync(filePath, JSON.stringify(initialData, null, 2));\n      console.log(`Created key file for reseller: ${reseller.username}`);\n    } catch (error: any) {\n      console.error(`Error creating reseller file: ${error.message}`);\n    }\n    \n    return reseller;\n  }\n\n  async getAllResellers(): Promise<Reseller[]> {\n    return Array.from(this.resellers.values());\n  }\n\n  async updateResellerCredits(id: number, amount: number): Promise<Reseller | undefined> {\n    const reseller = await this.getReseller(id);\n    if (reseller) {\n      const updatedReseller: Reseller = {\n        ...reseller,\n        credits: reseller.credits + amount\n      };\n      this.resellers.set(id, updatedReseller);\n      return updatedReseller;\n    }\n    return undefined;\n  }\n\n  async updateResellerStatus(id: number, isActive: boolean): Promise<Reseller | undefined> {\n    const reseller = await this.getReseller(id);\n    if (reseller) {\n      const updatedReseller: Reseller = {\n        ...reseller,\n        isActive\n      };\n      this.resellers.set(id, updatedReseller);\n      return updatedReseller;\n    }\n    return undefined;\n  }\n\n  // Key methods\n  async createKey(insertKey: InsertKey): Promise<Key> {\n    const id = this.keyId++;\n    const key: Key = {\n      ...insertKey,\n      id,\n      createdAt: new Date(),\n      isRevoked: false\n    };\n    this.keys.set(id, key);\n    \n    // Also save the key to the reseller's JSON file\n    try {\n      // Get the reseller to find their username\n      const reseller = await this.getReseller(insertKey.resellerId);\n      if (reseller) {\n        const resellerDirPath = path.join('.', 'data');\n        const filePath = path.join(resellerDirPath, `${reseller.username}.json`);\n        \n        // Read the current data\n        if (fs.existsSync(filePath)) {\n          const data = JSON.parse(fs.readFileSync(filePath, 'utf8'));\n          \n          // Add the new key to the keys array\n          data.keys.push({\n            ...key,\n            createdAt: key.createdAt.toISOString(),\n            expiryDate: key.expiryDate.toISOString()\n          });\n          \n          // Write the updated data back to the file\n          fs.writeFileSync(filePath, JSON.stringify(data, null, 2));\n          console.log(`Added key to ${reseller.username}'s file: ${key.keyString}`);\n        }\n      }\n    } catch (error: any) {\n      console.error(`Error adding key to reseller file: ${error.message}`);\n    }\n    \n    return key;\n  }\n\n  async getKey(keyString: string): Promise<Key | undefined> {\n    return Array.from(this.keys.values()).find(\n      (key) => key.keyString === keyString\n    );\n  }\n\n  async getKeysByResellerId(resellerId: number): Promise<Key[]> {\n    return Array.from(this.keys.values()).filter(\n      (key) => key.resellerId === resellerId\n    );\n  }\n\n  async getAllKeys(): Promise<Key[]> {\n    return Array.from(this.keys.values());\n  }\n\n  async revokeKey(keyId: number): Promise<Key | undefined> {\n    const key = this.keys.get(keyId);\n    if (key) {\n      const updatedKey: Key = {\n        ...key,\n        isRevoked: true\n      };\n      this.keys.set(keyId, updatedKey);\n      return updatedKey;\n    }\n    return undefined;\n  }\n\n  // Device methods\n  async addDevice(insertDevice: InsertDevice): Promise<Device> {\n    const id = this.deviceId++;\n    const device: Device = {\n      ...insertDevice,\n      id,\n      firstConnected: new Date()\n    };\n    this.devices.set(id, device);\n    return device;\n  }\n\n  async getDevicesByKeyId(keyId: number): Promise<Device[]> {\n    return Array.from(this.devices.values()).filter(\n      (device) => device.keyId === keyId\n    );\n  }\n\n  async removeDevice(deviceId: string, keyId: number): Promise<boolean> {\n    const device = Array.from(this.devices.values()).find(\n      (d) => d.deviceId === deviceId && d.keyId === keyId\n    );\n    \n    if (device) {\n      this.devices.delete(device.id);\n      return true;\n    }\n    \n    return false;\n  }\n\n  // Online Update methods\n  async createOnlineUpdate(insertUpdate: InsertOnlineUpdate): Promise<OnlineUpdate> {\n    const id = this.onlineUpdateId++;\n    const now = new Date();\n    const update: OnlineUpdate = {\n      ...insertUpdate,\n      id,\n      createdAt: now,\n      updatedAt: now,\n      buttonText: insertUpdate.buttonText ?? null,\n      linkUrl: insertUpdate.linkUrl ?? null\n    };\n    this.onlineUpdates.set(id, update);\n    \n    // Save to JSON file for persistence\n    await this.saveOnlineUpdatesToFile();\n    \n    return update;\n  }\n\n  async getAllOnlineUpdates(): Promise<OnlineUpdate[]> {\n    return Array.from(this.onlineUpdates.values()).sort((a, b) => \n      new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime()\n    );\n  }\n\n  async getOnlineUpdate(id: number): Promise<OnlineUpdate | undefined> {\n    return this.onlineUpdates.get(id);\n  }\n\n  async updateOnlineUpdate(id: number, updateData: Partial<UpdateOnlineUpdate>): Promise<OnlineUpdate | undefined> {\n    const existingUpdate = this.onlineUpdates.get(id);\n    if (existingUpdate) {\n      const updatedUpdate: OnlineUpdate = {\n        ...existingUpdate,\n        ...updateData,\n        id: existingUpdate.id, // Ensure id doesn't change\n        createdAt: existingUpdate.createdAt, // Preserve creation date\n        updatedAt: new Date()\n      };\n      this.onlineUpdates.set(id, updatedUpdate);\n      \n      // Save to JSON file for persistence\n      await this.saveOnlineUpdatesToFile();\n      \n      return updatedUpdate;\n    }\n    return undefined;\n  }\n\n  async deleteOnlineUpdate(id: number): Promise<boolean> {\n    const deleted = this.onlineUpdates.delete(id);\n    if (deleted) {\n      // Save to JSON file for persistence\n      await this.saveOnlineUpdatesToFile();\n    }\n    return deleted;\n  }\n\n  async getActiveOnlineUpdates(): Promise<OnlineUpdate[]> {\n    return Array.from(this.onlineUpdates.values())\n      .filter(update => update.isActive)\n      .sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime());\n  }\n\n  private async saveOnlineUpdatesToFile(): Promise<void> {\n    try {\n      const dataDir = path.join('.', 'data');\n      if (!fs.existsSync(dataDir)) {\n        fs.mkdirSync(dataDir, { recursive: true });\n      }\n      \n      const filePath = path.join(dataDir, 'online_updates.json');\n      const updates = Array.from(this.onlineUpdates.values()).map(update => ({\n        ...update,\n        createdAt: update.createdAt.toISOString(),\n        updatedAt: update.updatedAt.toISOString()\n      }));\n      \n      fs.writeFileSync(filePath, JSON.stringify(updates, null, 2));\n      console.log('Saved online updates to file');\n    } catch (error: any) {\n      console.error(`Error saving online updates to file: ${error.message}`);\n    }\n  }\n\n  // Stats methods\n  async getStats(): Promise<{ totalResellers: number; activeKeys: number; availableTokens: number; }> {\n    const totalResellers = this.resellers.size;\n    \n    const now = new Date();\n    const activeKeys = Array.from(this.keys.values()).filter(\n      (key) => !key.isRevoked && new Date(key.expiryDate) > now\n    ).length;\n    \n    const availableTokens = Array.from(this.tokens.values()).filter(\n      (token) => !token.isUsed\n    ).length;\n    \n    return {\n      totalResellers,\n      activeKeys,\n      availableTokens\n    };\n  }\n\n  // OTP methods (placeholder implementations - not used in MemStorage)\n  async createOTP(adminId: number, otp: string): Promise<{ id: number; adminId: number; otp: string; expiresAt: Date; isUsed: boolean }> {\n    throw new Error('OTP functionality not implemented in MemStorage');\n  }\n\n  async getOTP(adminId: number, otp: string): Promise<{ id: number; adminId: number; otp: string; expiresAt: Date; isUsed: boolean } | undefined> {\n    throw new Error('OTP functionality not implemented in MemStorage');\n  }\n\n  async markOTPAsUsed(id: number): Promise<boolean> {\n    throw new Error('OTP functionality not implemented in MemStorage');\n  }\n\n  async cleanupExpiredOTPs(): Promise<void> {\n    throw new Error('OTP functionality not implemented in MemStorage');\n  }\n}\n\nexport const storage = new MemStorage();\n","size_bytes":15810},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger, type ServerOptions } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions: ServerOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","size_bytes":2289},"shared/schema.ts":{"content":"import { pgTable, text, serial, integer, boolean, timestamp } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\n// Admin table\nexport const admins = pgTable(\"admins\", {\n  id: serial(\"id\").primaryKey(),\n  username: text(\"username\").notNull().unique(),\n  password: text(\"password\").notNull(),\n  email: text(\"email\").notNull().unique(),\n});\n\nexport const insertAdminSchema = createInsertSchema(admins).pick({\n  username: true,\n  password: true,\n  email: true,\n});\n\n// Referral token table\nexport const tokens = pgTable(\"tokens\", {\n  id: serial(\"id\").primaryKey(),\n  token: text(\"token\").notNull().unique(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  usedBy: text(\"used_by\"),\n  isUsed: boolean(\"is_used\").default(false).notNull(),\n  credits: integer(\"credits\").default(0).notNull(),\n});\n\nexport const insertTokenSchema = createInsertSchema(tokens).pick({\n  token: true,\n  credits: true,\n});\n\n// Reseller table\nexport const resellers = pgTable(\"resellers\", {\n  id: serial(\"id\").primaryKey(),\n  username: text(\"username\").notNull().unique(),\n  password: text(\"password\").notNull(),\n  credits: integer(\"credits\").default(0).notNull(),\n  registrationDate: timestamp(\"registration_date\").defaultNow().notNull(),\n  isActive: boolean(\"is_active\").default(true).notNull(),\n  referralToken: text(\"referral_token\").notNull(),\n});\n\nexport const insertResellerSchema = createInsertSchema(resellers).pick({\n  username: true,\n  password: true,\n  referralToken: true,\n});\n\n// Game enum\nexport const gameEnum = z.enum([\"PUBG MOBILE\", \"LAST ISLAND OF SURVIVAL\", \"STANDOFF2\"]);\nexport type Game = z.infer<typeof gameEnum>;\n\n// Key table\nexport const keys = pgTable(\"keys\", {\n  id: serial(\"id\").primaryKey(),\n  keyString: text(\"key_string\").notNull().unique(),\n  game: text(\"game\").notNull(),\n  resellerId: integer(\"reseller_id\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  expiryDate: timestamp(\"expiry_date\").notNull(),\n  deviceLimit: integer(\"device_limit\").notNull(),\n  isRevoked: boolean(\"is_revoked\").default(false).notNull(),\n});\n\n// Add transformations for proper type conversion\nexport const insertKeySchema = createInsertSchema(keys)\n  .pick({\n    keyString: true,\n    game: true,\n    resellerId: true,\n    expiryDate: true,\n    deviceLimit: true,\n  })\n  .extend({\n    // Add days as an optional parameter\n    days: z.number().positive().optional(),\n  })\n  .transform((data) => {\n    // Convert deviceLimit to number if it's a string\n    const deviceLimit = typeof data.deviceLimit === 'string' \n      ? parseInt(data.deviceLimit) \n      : data.deviceLimit;\n    \n    // Make sure expiryDate is a Date object\n    let expiryDate = data.expiryDate;\n    \n    // If days is provided and expiryDate is not, calculate expiry date based on days\n    if (data.days && !data.expiryDate) {\n      expiryDate = new Date();\n      expiryDate.setDate(expiryDate.getDate() + data.days);\n    } else if (data.expiryDate) {\n      // Otherwise ensure expiryDate is a Date object\n      expiryDate = data.expiryDate instanceof Date \n        ? data.expiryDate \n        : new Date(data.expiryDate);\n    } else {\n      // Default to 30 days if neither is provided\n      expiryDate = new Date();\n      expiryDate.setDate(expiryDate.getDate() + 30);\n    }\n    \n    // Remove days from final object\n    const { days, ...restData } = data;\n    \n    return {\n      ...restData,\n      deviceLimit,\n      expiryDate,\n    };\n  });\n\n// Device table\nexport const devices = pgTable(\"devices\", {\n  id: serial(\"id\").primaryKey(),\n  keyId: integer(\"key_id\").notNull(),\n  deviceId: text(\"device_id\").notNull(),\n  firstConnected: timestamp(\"first_connected\").defaultNow().notNull(),\n});\n\nexport const insertDeviceSchema = createInsertSchema(devices).pick({\n  keyId: true,\n  deviceId: true,\n});\n\n// Key status enum\nexport const keyStatusEnum = z.enum([\"ACTIVE\", \"EXPIRED\", \"REVOKED\"]);\nexport type KeyStatus = z.infer<typeof keyStatusEnum>;\n\n// Export types\nexport type Admin = typeof admins.$inferSelect;\nexport type InsertAdmin = z.infer<typeof insertAdminSchema>;\n\nexport type Token = typeof tokens.$inferSelect;\nexport type InsertToken = z.infer<typeof insertTokenSchema>;\n\nexport type Reseller = typeof resellers.$inferSelect;\nexport type InsertReseller = z.infer<typeof insertResellerSchema>;\n\nexport type Key = typeof keys.$inferSelect;\nexport type InsertKey = z.infer<typeof insertKeySchema>;\n\nexport type Device = typeof devices.$inferSelect;\nexport type InsertDevice = z.infer<typeof insertDeviceSchema>;\n\n// Schema for API verification\nexport const keyVerificationSchema = z.object({\n  key: z.string().min(1, \"License key is required\"),\n  deviceId: z.string().min(1, \"Device ID is required\"),\n  game: gameEnum,\n});\n\nexport type KeyVerification = z.infer<typeof keyVerificationSchema>;\n\n// Schema for adding credits\nexport const addCreditsSchema = z.object({\n  resellerId: z.number().positive(),\n  amount: z.number().positive(),\n});\n\nexport type AddCredits = z.infer<typeof addCreditsSchema>;\n\n// Online update table\nexport const onlineUpdates = pgTable(\"online_updates\", {\n  id: serial(\"id\").primaryKey(),\n  title: text(\"title\").notNull(),\n  message: text(\"message\").notNull(),\n  buttonText: text(\"button_text\"),\n  linkUrl: text(\"link_url\"),\n  isActive: boolean(\"is_active\").default(true).notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\n// Base schema without refinement for partial operations\nconst baseOnlineUpdateSchema = z.object({\n  title: z.string().min(1, \"Title is required\").max(100, \"Title must be less than 100 characters\"),\n  message: z.string().min(1, \"Message is required\").max(500, \"Message must be less than 500 characters\"),\n  buttonText: z.string().max(50, \"Button text must be less than 50 characters\").optional(),\n  linkUrl: z.string().url(\"Must be a valid URL\").optional(),\n  isActive: z.boolean().default(true),\n});\n\nexport const insertOnlineUpdateSchema = baseOnlineUpdateSchema.refine(data => {\n  // If buttonText is provided, linkUrl should also be provided\n  if (data.buttonText && !data.linkUrl) {\n    return false;\n  }\n  return true;\n}, {\n  message: \"Link URL is required when button text is provided\",\n  path: [\"linkUrl\"]\n});\n\nexport const updateOnlineUpdateSchema = baseOnlineUpdateSchema.partial().extend({\n  id: z.number().positive(),\n}).refine(data => {\n  // If buttonText is provided, linkUrl should also be provided (only when both are present)\n  if (data.buttonText && !data.linkUrl) {\n    return false;\n  }\n  return true;\n}, {\n  message: \"Link URL is required when button text is provided\",\n  path: [\"linkUrl\"]\n});\n\nexport type OnlineUpdate = typeof onlineUpdates.$inferSelect;\nexport type InsertOnlineUpdate = z.infer<typeof insertOnlineUpdateSchema>;\nexport type UpdateOnlineUpdate = z.infer<typeof updateOnlineUpdateSchema>;\n","size_bytes":6913},"client/src/App.tsx":{"content":"import { Switch, Route } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { ProtectedRoute } from \"@/lib/protected-route\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { ThemeProvider } from \"next-themes\";\nimport NotFound from \"@/pages/not-found\";\nimport Login from \"@/pages/login\";\nimport Register from \"@/pages/register\";\nimport AdminDashboard from \"@/pages/admin/dashboard\";\nimport AdminResellers from \"@/pages/admin/resellers\";\nimport AdminResellerKeys from \"@/pages/admin/reseller-keys\";\nimport AdminTokens from \"@/pages/admin/tokens\";\nimport AdminOnlineUpdate from \"@/pages/admin/online-update\";\nimport AdminApi from \"@/pages/admin/api\";\nimport DatabaseBackup from \"@/pages/admin/database-backup\";\nimport ResellerDashboard from \"@/pages/reseller/dashboard\";\nimport ResellerGenerate from \"@/pages/reseller/generate\";\nimport ResellerKeys from \"@/pages/reseller/keys\";\nimport ResellerApi from \"@/pages/reseller/api\";\nimport { AuthProvider } from \"@/hooks/use-auth\";\nimport { useEffect } from \"react\";\n\nfunction Router() {\n  return (\n    <Switch>\n      {/* Auth pages */}\n      <Route path=\"/\" component={Login} />\n      <Route path=\"/register\" component={Register} />\n      \n      {/* Admin pages */}\n      <ProtectedRoute path=\"/admin\" component={AdminDashboard} role=\"admin\" />\n      <ProtectedRoute path=\"/admin/resellers\" component={AdminResellers} role=\"admin\" />\n      <ProtectedRoute path=\"/admin/resellers/:id/keys\" component={AdminResellerKeys} role=\"admin\" />\n      <ProtectedRoute path=\"/admin/online-updates\" component={AdminOnlineUpdate} role=\"admin\" />\n      <ProtectedRoute path=\"/admin/tokens\" component={AdminTokens} role=\"admin\" />\n      <ProtectedRoute path=\"/admin/database-backup\" component={DatabaseBackup} role=\"admin\" />\n      <ProtectedRoute path=\"/admin/api\" component={AdminApi} role=\"admin\" />\n      \n      {/* Reseller pages */}\n      <ProtectedRoute path=\"/reseller\" component={ResellerDashboard} role=\"reseller\" />\n      <ProtectedRoute path=\"/reseller/generate\" component={ResellerGenerate} role=\"reseller\" />\n      <ProtectedRoute path=\"/reseller/keys\" component={ResellerKeys} role=\"reseller\" />\n      <ProtectedRoute path=\"/reseller/api\" component={ResellerApi} role=\"reseller\" />\n      \n      {/* Fallback to 404 */}\n      <Route path=\"*\" component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction App() {\n  // Set dark mode on component mount\n  useEffect(() => {\n    // Apply dark mode forcefully\n    document.documentElement.classList.add('dark');\n    document.body.classList.add('dark');\n    document.documentElement.style.colorScheme = 'dark';\n    \n    // Ensure dark mode persists\n    const observer = new MutationObserver(() => {\n      if (!document.documentElement.classList.contains('dark')) {\n        document.documentElement.classList.add('dark');\n      }\n      if (!document.body.classList.contains('dark')) {\n        document.body.classList.add('dark');\n      }\n    });\n    \n    observer.observe(document.documentElement, { attributes: true, attributeFilter: ['class'] });\n    observer.observe(document.body, { attributes: true, attributeFilter: ['class'] });\n    \n    return () => observer.disconnect();\n  }, []);\n\n  return (\n    <QueryClientProvider client={queryClient}>\n      <ThemeProvider defaultTheme=\"dark\" attribute=\"class\" forcedTheme=\"dark\">\n        <TooltipProvider>\n          <AuthProvider>\n            <Toaster />\n            <Router />\n          </AuthProvider>\n        </TooltipProvider>\n      </ThemeProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n","size_bytes":3684},"client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* Force dark mode for all browsers */\nhtml {\n  color-scheme: dark !important;\n}\n\n:root {\n  /* Light theme colors (not used as we're enforcing dark mode) */\n  --background: 0 0% 100%;\n  --foreground: 20 14.3% 4.1%;\n  --muted: 60 4.8% 95.9%;\n  --muted-foreground: 25 5.3% 44.7%;\n  --popover: 0 0% 100%;\n  --popover-foreground: 20 14.3% 4.1%;\n  --card: 0 0% 100%;\n  --card-foreground: 20 14.3% 4.1%;\n  --border: 20 5.9% 90%;\n  --input: 20 5.9% 90%;\n  --primary: 270 70% 54%; /* Purple primary */\n  --primary-foreground: 0 0% 100%;\n  --secondary: 280 70% 40%; /* Darker purple secondary */\n  --secondary-foreground: 0 0% 100%;\n  --accent: 285 100% 60%; /* Brighter purple accent */\n  --accent-foreground: 0 0% 100%;\n  --destructive: 0 84.2% 60.2%;\n  --destructive-foreground: 60 9.1% 97.8%;\n  --ring: 270 70% 54%;\n  --radius: 0.5rem;\n}\n\n/* Apply dark theme by default without .dark class */\n:root {\n  /* Dark theme with black and purple */\n  --background: 240 10% 3.9%; /* Near black */\n  --foreground: 0 0% 98%;\n  --muted: 240 5% 9%; /* Very dark gray */\n  --muted-foreground: 240 5% 70%;\n  --popover: 240 10% 5%;\n  --popover-foreground: 0 0% 98%;\n  --card: 240 10% 6%;\n  --card-foreground: 0 0% 98%;\n  --border: 240 5% 12%;\n  --input: 240 5% 12%;\n  --primary: 270 70% 54%; /* Purple primary */\n  --primary-foreground: 0 0% 100%;\n  --secondary: 280 70% 40%; /* Darker purple secondary */\n  --secondary-foreground: 0 0% 100%;\n  --accent: 285 100% 60%; /* Bright violet accent */\n  --accent-foreground: 0 0% 100%;\n  --destructive: 0 62.8% 30.6%;\n  --destructive-foreground: 0 0% 98%;\n  --ring: 270 70% 54%;\n  --radius: 0.5rem;\n}\n\n/* Apply styles to all elements to support the dark theme scheme */\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n  \n  /* Force background colors for all key components */\n  .card,\n  .popover,\n  .sheet,\n  .dialog,\n  .dropdown-menu,\n  .select,\n  .button,\n  .input {\n    @apply bg-background border-border text-foreground !important;\n  }\n  \n  /* Add purple glow to buttons and interactive elements */\n  .button:hover,\n  .link:hover,\n  .card:hover {\n    box-shadow: 0 0 8px 2px rgba(149, 76, 233, 0.2);\n  }\n  \n  /* Make text in cards more visible */\n  .card-title {\n    @apply text-foreground font-semibold;\n  }\n  \n  /* Add gradient text effect to headings */\n  h1, h2, h3 {\n    @apply bg-gradient-to-r from-purple-400 to-indigo-500 bg-clip-text text-transparent;\n  }\n}\n\n/* Custom scrollbar styles for code blocks */\n.scrollbar-thin {\n  scrollbar-width: thin;\n  scrollbar-color: hsl(var(--border)) transparent;\n}\n\n.scrollbar-thin::-webkit-scrollbar {\n  height: 6px;\n  width: 6px;\n}\n\n.scrollbar-thin::-webkit-scrollbar-track {\n  background: transparent;\n}\n\n.scrollbar-thin::-webkit-scrollbar-thumb {\n  background-color: hsl(var(--border));\n  border-radius: 3px;\n}\n\n.scrollbar-thin::-webkit-scrollbar-thumb:hover {\n  background-color: hsl(var(--muted-foreground));\n}\n\n.scrollbar-track-transparent::-webkit-scrollbar-track {\n  background: transparent;\n}\n\n.scrollbar-thumb-border::-webkit-scrollbar-thumb {\n  background-color: hsl(var(--border));\n}\n\n/* Mobile responsiveness enhancements */\n@media (max-width: 768px) {\n  .grid {\n    @apply grid-cols-1 gap-4;\n  }\n  \n  .flex {\n    @apply flex-wrap;\n  }\n  \n  .card {\n    @apply w-full;\n  }\n  \n  h1, h2 {\n    @apply text-xl;\n  }\n  \n  .p-6 {\n    @apply p-3;\n  }\n}\n\n/* Gradient background for special elements */\n.bg-gradient {\n  background: linear-gradient(135deg, rgba(76, 29, 149, 0.2) 0%, rgba(91, 33, 182, 0.1) 100%);\n}\n\n/* Glow effect for important UI elements */\n.glow {\n  box-shadow: 0 0 15px 2px rgba(149, 76, 233, 0.3);\n  transition: all 0.3s ease;\n  animation: glow-pulse 4s infinite alternate;\n}\n\n.glow:hover {\n  box-shadow: 0 0 20px 5px rgba(149, 76, 233, 0.5);\n  animation: glow-pulse-fast 2s infinite alternate;\n}\n\n@keyframes glow-pulse {\n  0% {\n    box-shadow: 0 0 15px 2px rgba(149, 76, 233, 0.3);\n  }\n  50% {\n    box-shadow: 0 0 20px 4px rgba(149, 76, 233, 0.5);\n  }\n  100% {\n    box-shadow: 0 0 25px 6px rgba(149, 76, 233, 0.4);\n  }\n}\n\n@keyframes glow-pulse-fast {\n  0% {\n    box-shadow: 0 0 20px 3px rgba(149, 76, 233, 0.4);\n  }\n  50% {\n    box-shadow: 0 0 25px 6px rgba(149, 76, 233, 0.6);\n  }\n  100% {\n    box-shadow: 0 0 30px 8px rgba(149, 76, 233, 0.5);\n  }\n}\n\n/* Text glow effect */\n.glow-text {\n  text-shadow: 0 0 10px rgba(168, 85, 247, 0.4);\n  animation: text-glow-pulse 4s infinite alternate;\n}\n\n@keyframes text-glow-pulse {\n  0% {\n    text-shadow: 0 0 10px rgba(168, 85, 247, 0.4);\n  }\n  50% {\n    text-shadow: 0 0 15px rgba(168, 85, 247, 0.6), 0 0 20px rgba(168, 85, 247, 0.3);\n  }\n  100% {\n    text-shadow: 0 0 10px rgba(168, 85, 247, 0.4);\n  }\n}\n\n/* Shining/pulsing animation for elements */\n@keyframes shine {\n  0% {\n    box-shadow: 0 0 5px 0px rgba(168, 85, 247, 0.3);\n  }\n  50% {\n    box-shadow: 0 0 15px 5px rgba(168, 85, 247, 0.5);\n  }\n  100% {\n    box-shadow: 0 0 5px 0px rgba(168, 85, 247, 0.3);\n  }\n}\n\n.shine {\n  animation: shine 3s infinite;\n}\n\n/* Custom scrollbar */\n::-webkit-scrollbar {\n  width: 8px;\n}\n\n::-webkit-scrollbar-track {\n  background: #0f0f0f;\n}\n\n::-webkit-scrollbar-thumb {\n  background: rgba(139, 92, 246, 0.3);\n  border-radius: 4px;\n}\n\n::-webkit-scrollbar-thumb:hover {\n  background: rgba(139, 92, 246, 0.5);\n}\n\n/* Moving glow elements */\n.moving-glow {\n  position: relative;\n  overflow: hidden;\n}\n\n.moving-glow::before,\n.moving-glow::after {\n  content: \"\";\n  position: absolute;\n  width: 150%;\n  height: 150%;\n  top: -25%;\n  left: -25%;\n  z-index: -1;\n  background: \n    radial-gradient(\n      circle at center,\n      rgba(168, 85, 247, 0.3) 0%,\n      rgba(168, 85, 247, 0.1) 30%,\n      transparent 70%\n    );\n  border-radius: 50%;\n  opacity: 0.5;\n  animation: move-glow 10s linear infinite;\n}\n\n.moving-glow::after {\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0;\n  background: \n    radial-gradient(\n      circle at center,\n      rgba(139, 92, 246, 0.3) 0%,\n      rgba(139, 92, 246, 0.1) 20%,\n      transparent 60%\n    );\n  animation: move-glow 15s linear infinite reverse;\n}\n\n/* Login form with moving border glow */\n.form-border-glow {\n  position: relative;\n  z-index: 0;\n  overflow: visible;\n  box-shadow: 0 0 15px rgba(168, 85, 247, 0.3);\n}\n\n.form-border-glow::before {\n  content: \"\";\n  position: absolute;\n  top: -2px;\n  left: -2px;\n  right: -2px;\n  bottom: -2px;\n  z-index: -1;\n  border: 3px solid #a855f7;\n  border-radius: inherit;\n  filter: drop-shadow(0 0 6px rgba(168, 85, 247, 0.7));\n  animation: border-rotate 8s linear infinite;\n}\n\n/* Add a pseudo-element for the moving border effect */\n.form-border-glow::after {\n  content: \"\";\n  position: absolute;\n  inset: -2px;\n  z-index: -2;\n  border: 3px solid transparent;\n  border-radius: inherit;\n  box-shadow: 0 0 15px rgba(168, 85, 247, 0.7);\n}\n\n@keyframes border-rotate {\n  0% {\n    clip-path: inset(0 0 calc(100% - 3px) 0);\n  }\n  12.5% {\n    clip-path: inset(0 0 0 calc(100% - 3px));\n  }\n  25% {\n    clip-path: inset(0 0 0 calc(100% - 3px));\n  }\n  37.5% {\n    clip-path: inset(calc(100% - 3px) 0 0 0);\n  }\n  50% {\n    clip-path: inset(calc(100% - 3px) 0 0 0);\n  }\n  62.5% {\n    clip-path: inset(0 calc(100% - 3px) 0 0);\n  }\n  75% {\n    clip-path: inset(0 calc(100% - 3px) 0 0);\n  }\n  87.5% {\n    clip-path: inset(0 0 calc(100% - 3px) 0);\n  }\n  100% {\n    clip-path: inset(0 0 calc(100% - 3px) 0);\n  }\n}\n\n@keyframes move-glow {\n  0% {\n    transform: translate(-30%, -30%) rotate(0deg);\n  }\n  25% {\n    transform: translate(30%, -30%) rotate(90deg);\n  }\n  50% {\n    transform: translate(30%, 30%) rotate(180deg);\n  }\n  75% {\n    transform: translate(-30%, 30%) rotate(270deg);\n  }\n  100% {\n    transform: translate(-30%, -30%) rotate(360deg);\n  }\n}\n\n/* Animated border glow */\n.border-glow {\n  position: relative;\n  z-index: 0;\n  overflow: visible;\n}\n\n.border-glow::before {\n  content: \"\";\n  position: absolute;\n  top: -2px;\n  left: -2px;\n  right: -2px;\n  bottom: -2px;\n  z-index: -1;\n  background: linear-gradient(45deg, \n    rgba(123, 31, 162, 0.7),\n    rgba(103, 58, 183, 0),\n    rgba(79, 98, 208, 0.7),\n    rgba(129, 18, 183, 0),\n    rgba(123, 31, 162, 0.7)\n  );\n  background-size: 400% 400%;\n  border-radius: inherit;\n  animation: border-glow-animation 15s ease infinite;\n  filter: blur(5px);\n}\n\n@keyframes border-glow-animation {\n  0% {\n    background-position: 0% 50%;\n  }\n  50% {\n    background-position: 100% 50%;\n  }\n  100% {\n    background-position: 0% 50%;\n  }\n}\n\n/* Floating animation */\n@keyframes float {\n  0% {\n    transform: translateY(0px);\n  }\n  50% {\n    transform: translateY(-10px);\n  }\n  100% {\n    transform: translateY(0px);\n  }\n}\n\n.float {\n  animation: float 6s ease-in-out infinite;\n}\n\n/* Hamburger menu animation */\n@keyframes fadeInLeft {\n  0% {\n    opacity: 0;\n    transform: translateX(-20px);\n  }\n  100% {\n    opacity: 1;\n    transform: translateX(0);\n  }\n}\n\n.hamburger-fade-in {\n  animation: fadeInLeft 0.3s ease-out forwards;\n}\n\n/* Input box with moving border */\n.input-border-glow {\n  position: relative;\n  z-index: 0;\n}\n\n.input-border-glow::before {\n  content: \"\";\n  position: absolute;\n  top: -1px;\n  left: -1px;\n  right: -1px;\n  bottom: -1px;\n  border-radius: inherit;\n  padding: 1px;\n  background: linear-gradient(90deg, \n    #a855f7, \n    #8b5cf6, \n    #6366f1, \n    #8b5cf6, \n    #a855f7\n  );\n  background-size: 300% 100%;\n  -webkit-mask: \n    linear-gradient(#fff 0 0) content-box, \n    linear-gradient(#fff 0 0);\n  -webkit-mask-composite: xor;\n  mask-composite: exclude;\n  animation: none;\n  /* We'll re-enable this animation in the fix below */\n}\n\n@keyframes input-border-animation {\n  0% { background-position: 0% 0%; }\n  100% { background-position: 300% 0%; }\n}\n\n/* Complete fix for moving text */\nbody {\n  overflow-x: hidden;\n}\n\n/* Stabilize all text elements */\nh1, h2, h3, h4, h5, h6, p, span, div, button, a, label, input, \n.card-title, .card-description, .text-xs, .text-sm, .text-lg, \n.text-xl, .text-2xl, .text-3xl, .text-4xl {\n  transform: translateZ(0) !important;\n  backface-visibility: hidden !important;\n  -webkit-font-smoothing: antialiased !important;\n  -moz-osx-font-smoothing: grayscale !important;\n  text-rendering: geometricPrecision !important;\n  letter-spacing: normal !important;\n  will-change: auto !important;\n  animation: none !important;\n  transition: none !important;\n}\n\n/* Only allow animations on specific elements */\n.input-border-glow::before {\n  animation: input-border-animation 6s linear infinite !important;\n}\n\n.form-border-glow::before {\n  animation: border-rotate 8s linear infinite !important;\n}\n\n.hamburger-fade-in {\n  animation: fadeInLeft 0.3s ease-out forwards !important;\n}\n\n.animate-spin {\n  animation: spin 1s linear infinite !important;\n}\n\n.animate-pulse {\n  animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite !important;\n}\n\n.glow-text {\n  animation: glow 1.5s ease-in-out infinite alternate !important;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n@keyframes pulse {\n  0%, 100% {\n    opacity: 1;\n  }\n  50% {\n    opacity: 0.5;\n  }\n}\n\n@keyframes glow {\n  from {\n    text-shadow: 0 0 5px rgba(168, 85, 247, 0.5), 0 0 10px rgba(168, 85, 247, 0.3);\n  }\n  to {\n    text-shadow: 0 0 10px rgba(168, 85, 247, 0.8), 0 0 20px rgba(168, 85, 247, 0.5);\n  }\n}\n\n/* ============================================ */\n/* CRITICAL MOBILE FIXES FOR ALL COMPONENTS */\n/* ============================================ */\n\n/* Force consistent dropdown positioning on mobile */\n@media (max-width: 768px) {\n  /* All dropdown/popover content positioning */\n  [data-radix-popper-content-wrapper] {\n    position: fixed !important;\n    top: auto !important;\n    left: 0 !important;\n    bottom: 0 !important;\n    right: 0 !important;\n    transform: none !important;\n    z-index: 99999 !important;\n    max-width: 100vw !important;\n    max-height: 80vh !important;\n    overflow-y: auto !important;\n    box-shadow: 0 -5px 20px -5px rgba(0, 0, 0, 0.5) !important;\n  }\n  \n  .dropdown-menu-content {\n    width: 100% !important;\n    max-width: 100vw !important;\n    border-top-left-radius: 16px !important;\n    border-top-right-radius: 16px !important;\n    border-bottom-left-radius: 0 !important;\n    border-bottom-right-radius: 0 !important;\n    border-width: 1px !important;\n    border-color: rgba(124, 58, 237, 0.2) !important;\n    background: hsl(var(--background)) !important;\n    animation: slideUp 0.2s ease-out !important;\n    padding-top: 4px !important;\n    padding-bottom: calc(4px + env(safe-area-inset-bottom)) !important;\n  }\n  \n  @keyframes slideUp {\n    from {\n      transform: translateY(100%);\n    }\n    to {\n      transform: translateY(0);\n    }\n  }\n  \n  /* Select dropdown specific positioning and styling */\n  [data-radix-select-content] {\n    position: fixed !important;\n    top: auto !important;\n    left: 0 !important;\n    bottom: 0 !important;\n    right: 0 !important;\n    transform: none !important;\n    width: 100% !important;\n    max-width: 100% !important;\n    z-index: 99999 !important;\n    max-height: 60vh !important;\n    border-top-left-radius: 16px !important;\n    border-top-right-radius: 16px !important;\n    border-bottom-left-radius: 0 !important;\n    border-bottom-right-radius: 0 !important;\n    border-width: 1px !important;\n    border-color: rgba(168, 85, 247, 0.3) !important;\n    background: hsl(var(--background)) !important;\n    animation: slideUp 0.2s ease-out !important;\n    padding-top: 4px !important;\n    padding-bottom: calc(4px + env(safe-area-inset-bottom)) !important;\n  }\n  \n  /* Context menu specific positioning */\n  [data-radix-context-menu-content] {\n    position: fixed !important;\n    top: auto !important;\n    left: 0 !important;\n    bottom: 0 !important;\n    right: 0 !important;\n    transform: none !important;\n    width: 100% !important;\n    max-width: 100% !important;\n    z-index: 99999 !important;\n    border-top-left-radius: 16px !important;\n    border-top-right-radius: 16px !important;\n    border-bottom-left-radius: 0 !important;\n    border-bottom-right-radius: 0 !important;\n    border-width: 1px !important;\n    border-color: rgba(168, 85, 247, 0.3) !important;\n    background: hsl(var(--background)) !important;\n    animation: slideUp 0.2s ease-out !important;\n    max-height: 70vh !important;\n    overflow-y: auto !important;\n  }\n  \n  /* Increase touch targets for all interactive elements */\n  [data-radix-select-item],\n  [role=\"menuitem\"],\n  [role=\"option\"],\n  .mobile-touch-target {\n    min-height: 48px !important;\n    display: flex !important;\n    align-items: center !important;\n    padding: 12px 10px 12px 30px !important;\n    touch-action: manipulation !important;\n  }\n  \n  /* Ensure text truncation for dropdown items */\n  [data-radix-select-item-text],\n  [role=\"menuitem\"] span {\n    white-space: nowrap !important;\n    overflow: hidden !important;\n    text-overflow: ellipsis !important;\n    max-width: 85vw !important;\n  }\n  \n  /* Improve dialog/modal mobile styling */\n  [role=\"dialog\"] {\n    max-width: 98vw !important;\n    width: 98vw !important;\n    margin: 0 auto !important;\n  }\n  \n  /* Mobile-friendly form elements */\n  input, select, textarea, button {\n    font-size: 16px !important; /* Prevents iOS zoom on focus */\n    min-height: 44px !important;\n    touch-action: manipulation !important;\n  }\n  \n  /* Improve mobile table layouts */\n  table {\n    display: block !important;\n    max-width: 100vw !important;\n    overflow-x: auto !important;\n    -webkit-overflow-scrolling: touch !important;\n  }\n  \n  /* Card improvements for mobile */\n  .card {\n    max-width: 100% !important;\n    width: 100% !important;\n  }\n}\n\n/* Dialog/modal component fixes for all screen sizes */\n[data-state=\"open\"][role=\"dialog\"],\n[data-state=\"open\"][role=\"alertdialog\"] {\n  position: fixed !important;\n  z-index: 99999 !important;\n  max-height: 95vh !important;\n  overflow-y: auto !important;\n  overscroll-behavior: contain !important;\n}\n\n/* Dialog overlay z-index fix */\n[role=\"dialog\"] > [data-state=\"open\"] {\n  z-index: 99998 !important;\n}\n\n/* Make dialogs scrollable on mobile with proper padding */\n[role=\"dialog\"] > [data-state=\"open\"] > div {\n  padding: 16px !important;\n  max-height: 90vh !important;\n  overflow-y: auto !important;\n  -webkit-overflow-scrolling: touch !important;\n}\n\n/* Fix for keyboard focus causing unintended scrolling */\nhtml, body {\n  overscroll-behavior-y: none !important;\n  position: relative !important;\n  height: 100% !important;\n}\n\n/* Fix for key details dialog specifically */\n.key-details-dialog {\n  width: 100vw !important;\n  max-width: 450px !important;\n  margin: 0 auto !important;\n}\n\n/* Mobile dialog improvements */\n.mobile-dialog-content {\n  width: 100% !important;\n  max-width: 100% !important;\n  max-height: 85vh !important;\n  margin: 0 !important;\n  position: fixed !important;\n  bottom: 0 !important;\n  left: 0 !important;\n  right: 0 !important;\n  top: auto !important;\n  transform: none !important;\n  border-bottom-left-radius: 0 !important;\n  border-bottom-right-radius: 0 !important;\n  border-top-left-radius: 16px !important;\n  border-top-right-radius: 16px !important;\n  animation: slideUpDialog 0.3s ease-out !important;\n}\n\n.mobile-dialog-handle {\n  width: 40px !important;\n  height: 5px !important;\n  background-color: rgba(139, 92, 246, 0.4) !important;\n  border-radius: 3px !important;\n  margin: 10px auto !important;\n  position: relative !important;\n  cursor: grab !important;\n}\n\n@keyframes slideUpDialog {\n  from {\n    transform: translateY(100%) !important;\n  }\n  to {\n    transform: translateY(0) !important;\n  }\n}\n\n/* Add special styling for mobile dialogs */\n@media (max-width: 768px) {\n  /* Bottom sheet style for mobile dialogs */\n  .mobile-dialog-content {\n    position: fixed !important;\n    top: auto !important;\n    bottom: 0 !important;\n    left: 0 !important;\n    right: 0 !important;\n    width: 100% !important;\n    max-width: 100% !important;\n    transform: none !important;\n    border-bottom-left-radius: 0 !important;\n    border-bottom-right-radius: 0 !important;\n    border-top-left-radius: 16px !important;\n    border-top-right-radius: 16px !important;\n    max-height: 90vh !important;\n    background-color: hsl(var(--background)) !important;\n    border-color: rgba(139, 92, 246, 0.2) !important;\n    animation: slide-up-mobile 0.3s ease-out !important;\n    padding-bottom: env(safe-area-inset-bottom, 16px) !important;\n    box-shadow: 0 -10px 25px rgba(0, 0, 0, 0.3) !important;\n  }\n  \n  @keyframes slide-up-mobile {\n    from {\n      transform: translateY(100%);\n    }\n    to {\n      transform: translateY(0);\n    }\n  }\n  \n  /* Add handle for mobile sheet dialogs */\n  .mobile-dialog-handle {\n    width: 40px;\n    height: 5px;\n    background-color: rgba(255, 255, 255, 0.15);\n    border-radius: 3px;\n    margin: 8px auto 4px auto;\n  }\n  \n  /* Style the mobile dialog header */\n  [class*=\"MobileDialogHeader\"] {\n    padding-top: 0 !important;\n    margin-top: 0 !important;\n  }\n}\n\n","size_bytes":18987},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\nimport { ThemeProvider } from \"next-themes\";\n\ncreateRoot(document.getElementById(\"root\")!).render(\n  <ThemeProvider attribute=\"class\" defaultTheme=\"light\">\n    <App />\n  </ThemeProvider>\n);\n","size_bytes":284},"client/src/components/add-credit-modal.tsx":{"content":"import { useState } from \"react\";\nimport { useMutation, useQuery } from \"@tanstack/react-query\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useIsMobile } from \"@/hooks/use-mobile\";\n\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  MobileDialog,\n  MobileDialogContent,\n  MobileDialogHeader,\n  MobileDialogTitle,\n} from \"@/components/ui/mobile-dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Button as SelectButton } from \"@/components/ui/button\";\nimport { ChevronDown, Check } from \"lucide-react\";\nimport { Input } from \"@/components/ui/input\";\nimport { z } from \"zod\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\n\ninterface AddCreditModalProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n}\n\nconst addCreditSchema = z.object({\n  resellerId: z.string().min(1, \"Please select a reseller\"),\n  amount: z.string().min(1, \"Amount is required\"),\n});\n\ntype AddCreditValues = z.infer<typeof addCreditSchema>;\n\ninterface MobileResellerSelectProps {\n  resellers: any[];\n  onSelect: (value: string) => void;\n  selectedValue: string;\n}\n\nfunction MobileResellerSelect({ resellers, onSelect, selectedValue }: MobileResellerSelectProps) {\n  const [isOpen, setIsOpen] = useState(false);\n  \n  const selectedReseller = resellers.find(r => r.id.toString() === selectedValue);\n  \n  return (\n    <>\n      <FormControl>\n        <SelectButton\n          type=\"button\"\n          variant=\"outline\"\n          className=\"w-full justify-between\"\n          onClick={() => setIsOpen(true)}\n        >\n          {selectedReseller \n            ? `${selectedReseller.username} - Current: ${selectedReseller.credits} credits`\n            : \"Select a reseller\"\n          }\n          <ChevronDown className=\"h-4 w-4\" />\n        </SelectButton>\n      </FormControl>\n      \n      <MobileDialog open={isOpen} onOpenChange={setIsOpen}>\n        <MobileDialogContent className=\"left-4 right-4 bottom-0 top-auto max-w-none rounded-t-2xl max-h-[70vh] data-[state=open]:slide-in-from-bottom\">\n          <MobileDialogHeader>\n            <MobileDialogTitle>Select Reseller</MobileDialogTitle>\n          </MobileDialogHeader>\n          <div className=\"p-4 overflow-y-auto\">\n            <div className=\"space-y-2\">\n              {resellers.map((reseller: any) => (\n                <button\n                  key={reseller.id}\n                  type=\"button\"\n                  className={`w-full p-3 text-left rounded-md border transition-colors flex items-center justify-between ${\n                    selectedValue === reseller.id.toString()\n                      ? 'border-purple-500 bg-purple-500/10 text-purple-300'\n                      : 'border-border bg-background hover:bg-muted'\n                  }`}\n                  onClick={() => {\n                    onSelect(reseller.id.toString());\n                    setIsOpen(false);\n                  }}\n                >\n                  <div>\n                    <div className=\"font-medium\">{reseller.username}</div>\n                    <div className=\"text-sm text-muted-foreground\">\n                      Current: {reseller.credits} credits\n                    </div>\n                  </div>\n                  {selectedValue === reseller.id.toString() && (\n                    <Check className=\"h-4 w-4 text-purple-400\" />\n                  )}\n                </button>\n              ))}\n              {resellers.length === 0 && (\n                <div className=\"py-8 text-center text-muted-foreground\">\n                  No resellers available\n                </div>\n              )}\n            </div>\n          </div>\n        </MobileDialogContent>\n      </MobileDialog>\n    </>\n  );\n}\n\nexport default function AddCreditModal({\n  open,\n  onOpenChange,\n}: AddCreditModalProps) {\n  const { toast } = useToast();\n  const isMobile = useIsMobile();\n\n  // Fetch resellers\n  const { data: resellers = [] } = useQuery<any[]>({\n    queryKey: ['/api/admin/resellers'],\n    enabled: open,\n  });\n\n  const form = useForm<AddCreditValues>({\n    resolver: zodResolver(addCreditSchema),\n    defaultValues: {\n      resellerId: \"\",\n      amount: \"\",\n    },\n  });\n\n  // Add credit mutation\n  const addCreditMutation = useMutation({\n    mutationFn: async (values: AddCreditValues) => {\n      const response = await apiRequest(\"POST\", \"/api/admin/resellers/credits\", {\n        resellerId: parseInt(values.resellerId),\n        amount: parseInt(values.amount),\n      });\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/admin/resellers'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/admin/stats'] });\n      form.reset();\n      onOpenChange(false);\n      toast({\n        title: \"Success\",\n        description: \"Credits added successfully\",\n      });\n    },\n    onError: (error) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to add credits\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  function onSubmit(values: AddCreditValues) {\n    addCreditMutation.mutate(values);\n  }\n\n  const renderForm = () => (\n    <Form {...form}>\n      <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n        <FormField\n          control={form.control}\n          name=\"resellerId\"\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel>Select Reseller</FormLabel>\n              {isMobile ? (\n                <MobileResellerSelect \n                  resellers={resellers}\n                  onSelect={field.onChange}\n                  selectedValue={field.value}\n                />\n              ) : (\n                <Select\n                  onValueChange={field.onChange}\n                  defaultValue={field.value}\n                >\n                  <FormControl>\n                    <SelectTrigger>\n                      <SelectValue placeholder=\"Select a reseller\" />\n                    </SelectTrigger>\n                  </FormControl>\n                  <SelectContent>\n                    {resellers.map((reseller: any) => (\n                      <SelectItem key={reseller.id} value={reseller.id.toString()}>\n                        {reseller.username} - Current: {reseller.credits} credits\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              )}\n              <FormMessage />\n            </FormItem>\n          )}\n        />\n\n        <FormField\n          control={form.control}\n          name=\"amount\"\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel>Credit Amount</FormLabel>\n              <FormControl>\n                <Input\n                  type=\"number\"\n                  min=\"1\"\n                  placeholder=\"Enter amount to add\"\n                  {...field}\n                />\n              </FormControl>\n              <FormMessage />\n            </FormItem>\n          )}\n        />\n\n        <Button\n          type=\"submit\"\n          className=\"w-full\"\n          disabled={addCreditMutation.isPending}\n        >\n          {addCreditMutation.isPending ? \"Adding...\" : \"Add Credit\"}\n        </Button>\n      </form>\n    </Form>\n  );\n\n  if (isMobile) {\n    return (\n      <MobileDialog open={open} onOpenChange={onOpenChange}>\n        <MobileDialogContent className=\"left-4 right-4 bottom-4 top-auto max-w-none rounded-t-2xl data-[state=open]:slide-in-from-bottom\">\n          <MobileDialogHeader>\n            <MobileDialogTitle>Add Credit to Reseller</MobileDialogTitle>\n          </MobileDialogHeader>\n          <div className=\"p-4\">\n            {renderForm()}\n          </div>\n        </MobileDialogContent>\n      </MobileDialog>\n    );\n  }\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"sm:max-w-md\">\n        <DialogHeader>\n          <DialogTitle>Add Credit to Reseller</DialogTitle>\n        </DialogHeader>\n        {renderForm()}\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":8398},"client/src/components/generate-token-modal.tsx":{"content":"import { useState } from \"react\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useIsMobile } from \"@/hooks/use-mobile\";\n\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogDescription,\n} from \"@/components/ui/dialog\";\nimport {\n  MobileDialog,\n  MobileDialogContent,\n  MobileDialogHeader,\n  MobileDialogTitle,\n  MobileDialogDescription,\n} from \"@/components/ui/mobile-dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Separator } from \"@/components/ui/separator\";\n\ninterface GenerateTokenModalProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n}\n\nexport default function GenerateTokenModal({\n  open,\n  onOpenChange,\n}: GenerateTokenModalProps) {\n  const { toast } = useToast();\n  const isMobile = useIsMobile();\n  const [credits, setCredits] = useState<string>(\"\");\n\n  // Generate token mutation\n  const generateTokenMutation = useMutation({\n    mutationFn: async () => {\n      const body = credits ? { credits: parseInt(credits) } : {};\n      const response = await apiRequest(\"POST\", \"/api/admin/tokens/generate\", body);\n      return response.json();\n    },\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: ['/api/admin/tokens'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/admin/stats'] });\n      setCredits(\"\");\n      onOpenChange(false);\n      \n      // Copy the token to clipboard\n      if (data.token?.token) {\n        navigator.clipboard.writeText(data.token.token);\n        const creditsText = credits ? ` with ${credits} credits` : '';\n        toast({\n          title: \"Token Generated\",\n          description: `New token${creditsText} has been created and copied to clipboard: ${data.token.token}`,\n        });\n      } else {\n        toast({\n          title: \"Token Generated\",\n          description: \"New referral token has been created\",\n        });\n      }\n    },\n    onError: (error) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to generate token\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleGenerateToken = () => {\n    generateTokenMutation.mutate();\n  };\n\n  // Form content that's common to both dialog types\n  const formContent = (\n    <div className=\"space-y-4\">\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"credits\">Credits (Optional)</Label>\n        <Input\n          id=\"credits\"\n          type=\"number\"\n          min=\"0\"\n          placeholder=\"0\"\n          value={credits}\n          onChange={(e) => setCredits(e.target.value)}\n          data-testid=\"input-credits\"\n        />\n        <p className=\"text-xs text-muted-foreground\">\n          Leave empty to generate a normal token without credits. Add credits to give bonus credits to whoever uses this token.\n        </p>\n      </div>\n      <Separator />\n      <Button\n        className=\"w-full\"\n        onClick={handleGenerateToken}\n        disabled={generateTokenMutation.isPending}\n        data-testid=\"button-generate-token\"\n      >\n        {generateTokenMutation.isPending ? \"Generating...\" : \"Generate Token\"}\n      </Button>\n    </div>\n  );\n\n  if (isMobile) {\n    return (\n      <Dialog open={open} onOpenChange={onOpenChange}>\n        <DialogContent className=\"mobile-dialog-content\">\n          <div className=\"mobile-dialog-handle\"></div>\n          <DialogHeader>\n            <DialogTitle>Generate Referral Token</DialogTitle>\n            <DialogDescription>\n              Generate a new referral token that can be used to register a reseller account.\n              The token will be copied to your clipboard.\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"p-4\">\n            {formContent}\n          </div>\n        </DialogContent>\n      </Dialog>\n    );\n  }\n  \n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"sm:max-w-md\">\n        <DialogHeader>\n          <DialogTitle>Generate Referral Token</DialogTitle>\n          <DialogDescription>\n            Generate a new referral token that can be used to register a reseller account.\n            The token will be copied to your clipboard.\n          </DialogDescription>\n        </DialogHeader>\n        <div className=\"space-y-4\">\n          {formContent}\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":4558},"client/src/components/key-details-modal.tsx":{"content":"import { useState } from \"react\";\nimport { Copy, Trash, Check, Smartphone } from \"lucide-react\";\nimport { useMutation, useQuery } from \"@tanstack/react-query\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { formatDate, getStatusColor } from \"@/lib/utils\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Key, Device, KeyStatus } from \"@shared/schema\";\n\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Card, CardContent } from \"@/components/ui/card\";\n\ninterface KeyDetailsModalProps {\n  keyId: number | null;\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n}\n\n// Interface for key details with devices\ninterface KeyDetailsWithDevices extends Key {\n  devices: Device[];\n  status: KeyStatus;\n}\n\nexport default function KeyDetailsModal({\n  keyId,\n  open,\n  onOpenChange,\n}: KeyDetailsModalProps) {\n  const { toast } = useToast();\n  const [copied, setCopied] = useState(false);\n\n  // Fetch key details\n  const { data: keyDetails, isLoading } = useQuery<KeyDetailsWithDevices>({\n    queryKey: [`/api/reseller/keys/${keyId}`],\n    enabled: open && !!keyId,\n  });\n\n  // Remove device mutation\n  const removeDeviceMutation = useMutation({\n    mutationFn: async ({ keyId, deviceId }: { keyId: number; deviceId: string }) => {\n      const response = await apiRequest(\n        \"POST\",\n        `/api/reseller/keys/${keyId}/devices/${deviceId}/remove`,\n        {}\n      );\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [`/api/reseller/keys/${keyId}`] });\n      toast({\n        title: \"Success\",\n        description: \"Device removed successfully\",\n      });\n    },\n    onError: (error) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to remove device\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleCopyKey = () => {\n    if (keyDetails?.keyString) {\n      navigator.clipboard.writeText(keyDetails.keyString);\n      setCopied(true);\n      setTimeout(() => setCopied(false), 2000);\n      toast({\n        title: \"Copied\",\n        description: \"License key copied to clipboard\",\n      });\n    }\n  };\n\n  const handleRemoveDevice = (deviceId: string) => {\n    if (keyId) {\n      removeDeviceMutation.mutate({ keyId, deviceId });\n    }\n  };\n\n  const statusColor = keyDetails?.status \n    ? getStatusColor(keyDetails.status)\n    : { bg: \"bg-gray-100\", text: \"text-gray-800\", border: \"border-gray-200\" };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"mobile-dialog-content\">\n        <div className=\"mobile-dialog-handle\"></div>\n        <DialogHeader>\n          <DialogTitle>Key Details</DialogTitle>\n        </DialogHeader>\n\n        {isLoading ? (\n          <div className=\"py-10 flex justify-center\">\n            <div className=\"animate-spin h-8 w-8 border-t-2 border-purple-500 rounded-full\"></div>\n          </div>\n        ) : keyDetails ? (\n          <div className=\"p-4 space-y-5\">\n            {/* Key string with copy button */}\n            <Card className=\"border-purple-500/20 bg-purple-900/5\">\n              <CardContent className=\"p-4\">\n                <div className=\"flex items-center justify-between mb-2\">\n                  <h3 className=\"text-sm font-semibold text-purple-400\">License Key</h3>\n                  <Button\n                    size=\"sm\"\n                    variant=\"ghost\"\n                    onClick={handleCopyKey}\n                    className=\"h-8 w-8 p-0 rounded-full text-purple-400 hover:text-purple-300 hover:bg-purple-900/20\"\n                  >\n                    {copied ? <Check className=\"h-4 w-4\" /> : <Copy className=\"h-4 w-4\" />}\n                  </Button>\n                </div>\n                <code className=\"font-mono text-xs sm:text-sm bg-black p-3 rounded-md block w-full overflow-x-auto border border-purple-500/20 text-purple-100\">\n                  {keyDetails.keyString}\n                </code>\n              </CardContent>\n            </Card>\n            \n            {/* Key info grid */}\n            <div className=\"grid grid-cols-2 gap-3\">\n              <Card className=\"border-purple-500/20 overflow-hidden\">\n                <CardContent className=\"p-0\">\n                  <div className=\"bg-purple-900/10 px-3 py-2 border-b border-purple-500/20\">\n                    <span className=\"text-xs text-purple-300\">Game</span>\n                  </div>\n                  <div className=\"p-3\">\n                    <span className=\"text-sm font-medium\">{keyDetails.game}</span>\n                  </div>\n                </CardContent>\n              </Card>\n              \n              <Card className=\"border-purple-500/20 overflow-hidden\">\n                <CardContent className=\"p-0\">\n                  <div className=\"bg-purple-900/10 px-3 py-2 border-b border-purple-500/20\">\n                    <span className=\"text-xs text-purple-300\">Status</span>\n                  </div>\n                  <div className=\"p-3\">\n                    <Badge \n                      variant=\"outline\" \n                      className={`${statusColor.bg} ${statusColor.text} ${statusColor.border} text-xs`}\n                    >\n                      {keyDetails.status}\n                    </Badge>\n                  </div>\n                </CardContent>\n              </Card>\n              \n              <Card className=\"border-purple-500/20 overflow-hidden\">\n                <CardContent className=\"p-0\">\n                  <div className=\"bg-purple-900/10 px-3 py-2 border-b border-purple-500/20\">\n                    <span className=\"text-xs text-purple-300\">Created</span>\n                  </div>\n                  <div className=\"p-3\">\n                    <span className=\"text-sm\">{formatDate(keyDetails.createdAt)}</span>\n                  </div>\n                </CardContent>\n              </Card>\n              \n              <Card className=\"border-purple-500/20 overflow-hidden\">\n                <CardContent className=\"p-0\">\n                  <div className=\"bg-purple-900/10 px-3 py-2 border-b border-purple-500/20\">\n                    <span className=\"text-xs text-purple-300\">Expires</span>\n                  </div>\n                  <div className=\"p-3\">\n                    <span className=\"text-sm\">{formatDate(keyDetails.expiryDate)}</span>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n            \n            {/* Connected devices section */}\n            <Card className=\"border-purple-500/20 overflow-hidden\">\n              <CardContent className=\"p-0\">\n                <div className=\"bg-purple-900/10 px-4 py-3 border-b border-purple-500/20 flex items-center\">\n                  <Smartphone className=\"h-4 w-4 mr-2 text-purple-400\" /> \n                  <span className=\"text-sm font-medium text-purple-300\">Connected Devices</span>\n                </div>\n                \n                {keyDetails.devices && keyDetails.devices.length > 0 ? (\n                  <div className=\"divide-y divide-purple-500/10\">\n                    {keyDetails.devices.map((device) => (\n                      <div\n                        key={device.id}\n                        className=\"p-4 flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3\"\n                      >\n                        <div>\n                          <span className=\"text-sm font-medium block\">\n                            {device.deviceId}\n                          </span>\n                          <span className=\"text-xs text-muted-foreground block mt-1\">\n                            Connected: {formatDate(device.firstConnected)}\n                          </span>\n                        </div>\n                        {keyDetails.status === \"ACTIVE\" && (\n                          <Button\n                            size=\"sm\"\n                            variant=\"outline\"\n                            className=\"border-red-500/30 bg-red-500/5 hover:bg-red-500/10 text-red-500 text-xs w-full sm:w-auto\"\n                            onClick={() => handleRemoveDevice(device.deviceId)}\n                            disabled={removeDeviceMutation.isPending}\n                          >\n                            <Trash className=\"h-3.5 w-3.5 mr-1.5\" /> Remove Device\n                          </Button>\n                        )}\n                      </div>\n                    ))}\n                  </div>\n                ) : (\n                  <div className=\"p-4 text-center text-sm text-muted-foreground\">\n                    <p>No devices connected to this key yet</p>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n        ) : (\n          <div className=\"py-10 text-center text-muted-foreground\">\n            <p>Key details not found</p>\n          </div>\n        )}\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":9067},"client/src/components/toast-notification.tsx":{"content":"import { CheckCircle, XCircle, AlertCircle, Info } from \"lucide-react\";\nimport { Toast } from \"@/components/ui/toast\";\nimport { cn } from \"@/lib/utils\";\n\ninterface ToastNotificationProps {\n  title: string;\n  message: string;\n  type?: \"success\" | \"error\" | \"warning\" | \"info\";\n  onClose?: () => void;\n}\n\nexport function ToastNotification({\n  title,\n  message,\n  type = \"info\",\n  onClose,\n}: ToastNotificationProps) {\n  const icons = {\n    success: <CheckCircle className=\"h-5 w-5 text-green-500\" />,\n    error: <XCircle className=\"h-5 w-5 text-red-500\" />,\n    warning: <AlertCircle className=\"h-5 w-5 text-yellow-500\" />,\n    info: <Info className=\"h-5 w-5 text-blue-500\" />,\n  };\n\n  const styles = {\n    success: \"border-green-500 bg-green-50\",\n    error: \"border-red-500 bg-red-50\",\n    warning: \"border-yellow-500 bg-yellow-50\",\n    info: \"border-blue-500 bg-blue-50\",\n  };\n\n  return (\n    <Toast className={cn(\"border-l-4\", styles[type])}>\n      <div className=\"flex items-start gap-3\">\n        <div className=\"pt-0.5\">{icons[type]}</div>\n        <div className=\"flex-1\">\n          <div className=\"font-medium\">{title}</div>\n          {message && <div className=\"text-sm text-muted-foreground\">{message}</div>}\n        </div>\n        {onClose && (\n          <button\n            onClick={onClose}\n            className=\"rounded-md p-1 hover:bg-gray-100\"\n            aria-label=\"Close\"\n          >\n            <X className=\"h-4 w-4 text-gray-500\" />\n          </button>\n        )}\n      </div>\n    </Toast>\n  );\n}\n","size_bytes":1516},"client/src/hooks/use-auth.tsx":{"content":"import { createContext, useContext, useEffect, useState, ReactNode } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { queryClient } from \"@/lib/queryClient\";\n\ninterface User {\n  id: number;\n  username: string;\n  role: \"admin\" | \"reseller\";\n}\n\ninterface AuthContextType {\n  user: User | null;\n  isLoading: boolean;\n  isAuthenticated: boolean;\n  login: (role: \"admin\" | \"reseller\", username: string, password: string) => Promise<void>;\n  logout: () => Promise<void>;\n  register: (username: string, password: string, referralToken: string) => Promise<void>;\n}\n\nconst AuthContext = createContext<AuthContextType | null>(null);\n\nexport function AuthProvider({ children }: { children: ReactNode }) {\n  const [location, navigate] = useLocation();\n  \n  // Direct implementation using getQueryFn to fetch session, ensuring credentials are included\n  const { data, isLoading } = useQuery<{ isAuthenticated: boolean; user?: User }>({ \n    queryKey: ['/api/auth/session'],\n    queryFn: async () => {\n      const response = await fetch('/api/auth/session', {\n        credentials: 'include',\n        headers: {\n          'Accept': 'application/json'\n        }\n      });\n      return await response.json();\n    },\n    refetchOnWindowFocus: true,\n    staleTime: 10 * 1000, // 10 seconds\n    retry: 3\n  });\n  \n  const isAuthenticated = data?.isAuthenticated || false;\n  const user = data?.user || null;\n  \n  // Login mutation\n  const loginMutation = useMutation({\n    mutationFn: async ({ \n      role, \n      username, \n      password \n    }: { \n      role: \"admin\" | \"reseller\"; \n      username: string; \n      password: string;\n    }) => {\n      console.log(`Attempting ${role} login with credentials...`);\n      \n      // Add additional headers for auth\n      const response = await fetch(`/api/auth/${role}/login`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({ username, password }),\n        credentials: 'include'\n      });\n      \n      if (!response.ok) {\n        console.log('Response not OK, status:', response.status);\n        let errorMessage = 'Login failed';\n        \n        try {\n          const errorData = await response.json();\n          console.log('Error data from server:', errorData);\n          errorMessage = errorData.message || 'Login failed';\n        } catch (parseError) {\n          console.log('Failed to parse error response:', parseError);\n          errorMessage = 'Login failed - Invalid credentials';\n        }\n        \n        console.log('About to throw error with message:', errorMessage);\n        const error = new Error(errorMessage);\n        console.log('Created error object:', error);\n        console.log('Error message property:', error.message);\n        throw error;\n      }\n      \n      return response.json();\n    },\n    onSuccess: (data) => {\n      console.log('Login successful:', data);\n      // Force refetch session after login\n      queryClient.invalidateQueries({ queryKey: ['/api/auth/session'] });\n    },\n    onError: (error) => {\n      console.error('Login error:', error);\n      console.error('Login error message:', error.message);\n    }\n  });\n  \n  // Logout mutation\n  const logoutMutation = useMutation({\n    mutationFn: async () => {\n      console.log('Attempting logout...');\n      \n      const response = await fetch('/api/auth/logout', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        credentials: 'include'\n      });\n      \n      if (!response.ok) {\n        throw new Error('Logout failed');\n      }\n      \n      return response.json();\n    },\n    onSuccess: (data) => {\n      console.log('Logout successful:', data);\n      // Force reset session\n      queryClient.resetQueries({ queryKey: ['/api/auth/session'] });\n      queryClient.setQueryData(['/api/auth/session'], { isAuthenticated: false, user: null });\n      navigate('/');\n    },\n    onError: (error) => {\n      console.error('Logout error:', error);\n    }\n  });\n  \n  // Register mutation\n  const registerMutation = useMutation({\n    mutationFn: async ({ \n      username, \n      password, \n      referralToken \n    }: { \n      username: string; \n      password: string; \n      referralToken: string;\n    }) => {\n      console.log('Attempting registration...');\n      \n      const response = await fetch('/api/auth/reseller/register', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({ \n          username, \n          password, \n          referralToken \n        }),\n        credentials: 'include'\n      });\n      \n      if (!response.ok) {\n        console.log('Registration response not OK, status:', response.status);\n        let errorMessage = 'Registration failed';\n        \n        try {\n          const errorData = await response.json();\n          console.log('Registration error data from server:', errorData);\n          errorMessage = errorData.message || 'Registration failed';\n        } catch (parseError) {\n          console.log('Failed to parse registration error response:', parseError);\n          errorMessage = 'Registration failed - Please try again';\n        }\n        \n        console.log('About to throw registration error with message:', errorMessage);\n        const error = new Error(errorMessage);\n        console.log('Created registration error object:', error);\n        console.log('Registration error message property:', error.message);\n        throw error;\n      }\n      \n      return response.json();\n    },\n    onSuccess: (data) => {\n      console.log('Registration successful:', data);\n      navigate('/');\n    },\n    onError: (error) => {\n      console.error('Registration error:', error);\n    }\n  });\n  \n  // Redirect based on auth state\n  useEffect(() => {\n    if (isLoading) return;\n    \n    const publicPaths = ['/', '/register'];\n    const adminPaths = ['/admin', '/admin/resellers', '/admin/tokens', '/admin/api'];\n    const resellerPaths = ['/reseller', '/reseller/generate', '/reseller/keys', '/reseller/api'];\n    \n    // If authenticated, redirect from public pages to dashboard\n    if (isAuthenticated && publicPaths.includes(location)) {\n      if (user?.role === 'admin') {\n        navigate('/admin');\n      } else if (user?.role === 'reseller') {\n        navigate('/reseller');\n      }\n    }\n    \n    // If not authenticated, redirect to login\n    if (!isAuthenticated && ![...publicPaths].includes(location)) {\n      navigate('/');\n    }\n    \n    // If authenticated but wrong role, redirect to appropriate dashboard\n    if (isAuthenticated) {\n      if (user?.role === 'admin' && resellerPaths.some(path => location.startsWith(path))) {\n        navigate('/admin');\n      } else if (user?.role === 'reseller' && adminPaths.some(path => location.startsWith(path))) {\n        navigate('/reseller');\n      }\n    }\n  }, [isAuthenticated, location, isLoading, user]);\n  \n  // Auth methods\n  const login = async (role: \"admin\" | \"reseller\", username: string, password: string) => {\n    try {\n      await loginMutation.mutateAsync({ role, username, password });\n    } catch (error) {\n      console.error('Login method error:', error);\n      throw error; // Re-throw to allow components to catch it\n    }\n  };\n  \n  const logout = async () => {\n    try {\n      await logoutMutation.mutateAsync();\n    } catch (error) {\n      console.error('Logout method error:', error);\n      throw error;\n    }\n  };\n  \n  const register = async (username: string, password: string, referralToken: string) => {\n    try {\n      await registerMutation.mutateAsync({ username, password, referralToken });\n    } catch (error) {\n      console.error('Register method error:', error);\n      throw error; // Re-throw to allow components to catch it\n    }\n  };\n  \n  return (\n    <AuthContext.Provider value={{\n      user,\n      isLoading,\n      isAuthenticated,\n      login,\n      logout,\n      register\n    }}>\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error(\"useAuth must be used within an AuthProvider\");\n  }\n  return context;\n}\n","size_bytes":8306},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","size_bytes":565},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 5000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","size_bytes":3892},"client/src/layouts/admin-layout.tsx":{"content":"import { ReactNode, useState, useEffect } from \"react\";\nimport { Link, useLocation } from \"wouter\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport {\n  LayoutDashboard,\n  Users,\n  Ticket,\n  Code,\n  Menu,\n  X,\n  LogOut,\n  ChevronRight,\n  User,\n  Database,\n  MessageSquare,\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Sheet, SheetContent, SheetTrigger } from \"@/components/ui/sheet\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from \"@/components/ui/tooltip\";\nimport { useIsMobile } from \"@/hooks/use-mobile\";\n\ninterface AdminLayoutProps {\n  children: ReactNode;\n}\n\nexport default function AdminLayout({ children }: AdminLayoutProps) {\n  const { user, logout } = useAuth();\n  const [location] = useLocation();\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\n  const isMobile = useIsMobile();\n  const [isCollapsed, setIsCollapsed] = useState(false);\n\n  useEffect(() => {\n    // If window width is between 768px and 1024px, collapse the sidebar\n    const handleResize = () => {\n      const width = window.innerWidth;\n      if (width >= 768 && width < 1024) {\n        setIsCollapsed(true);\n      } else if (width >= 1024) {\n        setIsCollapsed(false);\n      }\n    };\n\n    // Initial check\n    handleResize();\n\n    // Add event listener\n    window.addEventListener('resize', handleResize);\n    \n    // Cleanup\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  const navItems = [\n    {\n      title: \"Overview\",\n      icon: <LayoutDashboard className={`${isCollapsed ? \"mx-auto\" : \"mr-3\"} h-5 w-5`} />,\n      href: \"/admin\",\n      active: location === \"/admin\",\n    },\n    {\n      title: \"Manage Resellers\",\n      icon: <Users className={`${isCollapsed ? \"mx-auto\" : \"mr-3\"} h-5 w-5`} />,\n      href: \"/admin/resellers\",\n      active: location === \"/admin/resellers\",\n    },\n    {\n      title: \"Online Updates\",\n      icon: <MessageSquare className={`${isCollapsed ? \"mx-auto\" : \"mr-3\"} h-5 w-5`} />,\n      href: \"/admin/online-updates\",\n      active: location === \"/admin/online-updates\",\n    },\n    {\n      title: \"Referral Tokens\",\n      icon: <Ticket className={`${isCollapsed ? \"mx-auto\" : \"mr-3\"} h-5 w-5`} />,\n      href: \"/admin/tokens\",\n      active: location === \"/admin/tokens\",\n    },\n    {\n      title: \"Database Backup\",\n      icon: <Database className={`${isCollapsed ? \"mx-auto\" : \"mr-3\"} h-5 w-5`} />,\n      href: \"/admin/database-backup\",\n      active: location === \"/admin/database-backup\",\n    },\n    {\n      title: \"API Documentation\",\n      icon: <Code className={`${isCollapsed ? \"mx-auto\" : \"mr-3\"} h-5 w-5`} />,\n      href: \"/admin/api\",\n      active: location === \"/admin/api\",\n    },\n  ];\n\n  const handleLogout = async () => {\n    await logout();\n  };\n\n  return (\n    <div className=\"min-h-screen flex flex-col bg-background\">\n      {/* Header */}\n      <header className=\"sticky top-0 z-40 bg-background/80 backdrop-blur-sm border-b border-border py-3 px-4 sm:px-6 flex justify-between items-center shadow-sm\">\n        <div className=\"flex items-center gap-3\">\n          {/* Mobile menu button */}\n          <div className=\"md:hidden\">\n            <Sheet open={mobileMenuOpen} onOpenChange={setMobileMenuOpen}>\n              <SheetTrigger asChild>\n                <Button variant=\"outline\" size=\"icon\" className=\"mr-1 bg-background/90 border-purple-500/20 hover:bg-purple-900/10\">\n                  <Menu className=\"h-5 w-5 text-purple-400\" />\n                </Button>\n              </SheetTrigger>\n              <SheetContent side=\"left\" className=\"w-[280px] p-0 bg-background/95 backdrop-blur-md border-r border-purple-500/20 z-[100]\">\n                <div className=\"flex flex-col h-full\">\n                  <div className=\"flex items-center py-4 px-5 border-b border-border\">\n                    <div className=\"flex items-center\">\n                      <h2 className=\"text-xl font-semibold bg-gradient-to-r from-purple-500 to-indigo-600 bg-clip-text text-transparent\">DEXX-TER</h2>\n                      <span className=\"ml-2 px-2 py-0.5 bg-purple-900/30 text-purple-400 text-xs rounded-md border border-purple-500/20\">\n                        Admin\n                      </span>\n                    </div>\n                  </div>\n                  \n                  <div className=\"py-3 px-5 border-b border-border\">\n                    <div className=\"flex items-center gap-3\">\n                      <Avatar className=\"h-9 w-9 border border-purple-500/20 bg-purple-900/20\">\n                        <AvatarFallback className=\"text-purple-400 bg-purple-900/20\">\n                          {user?.username?.charAt(0)?.toUpperCase() || 'A'}\n                        </AvatarFallback>\n                      </Avatar>\n                      <div>\n                        <p className=\"text-sm font-medium\">{user?.username}</p>\n                        <p className=\"text-xs text-muted-foreground\">Administrator</p>\n                      </div>\n                    </div>\n                  </div>\n                  \n                  <nav className=\"flex-1 py-4 px-3\">\n                    <div className=\"text-xs font-semibold text-muted-foreground px-2 pb-2\">MAIN NAVIGATION</div>\n                    <ul className=\"space-y-1\">\n                      {navItems.map((item) => (\n                        <li key={item.href}>\n                          <div\n                            className={`flex items-center px-3 py-2.5 rounded-md text-sm cursor-pointer transition-colors ${\n                              item.active\n                                ? \"bg-purple-900/30 text-purple-300 font-medium border border-purple-500/20 shadow-sm\"\n                                : \"text-foreground hover:bg-background/80 hover:text-purple-300\"\n                            }`}\n                            onClick={() => {\n                              setMobileMenuOpen(false);\n                              location !== item.href && (window.location.href = item.href);\n                            }}\n                          >\n                            {item.icon}\n                            {item.title}\n                            {item.active && <ChevronRight className=\"ml-auto h-4 w-4 text-purple-400\" />}\n                          </div>\n                        </li>\n                      ))}\n                    </ul>\n                    \n                    <div className=\"mt-6 px-3\">\n                      <Button \n                        variant=\"destructive\" \n                        size=\"sm\" \n                        className=\"w-full bg-red-950/40 text-red-400 hover:bg-red-900/30\"\n                        onClick={() => {\n                          setMobileMenuOpen(false);\n                          handleLogout();\n                        }}\n                      >\n                        <LogOut className=\"h-4 w-4 mr-2\" /> Logout\n                      </Button>\n                    </div>\n                  </nav>\n                </div>\n              </SheetContent>\n            </Sheet>\n          </div>\n          \n          <h1 className=\"text-xl sm:text-2xl font-semibold bg-gradient-to-r from-purple-500 to-indigo-600 bg-clip-text text-transparent\">DEXX-TER</h1>\n          <span className=\"px-2 py-0.5 bg-purple-900/30 text-purple-400 text-xs rounded-md border border-purple-500/20\">\n            Admin\n          </span>\n        </div>\n        \n        {/* User section */}\n        <div className=\"hidden md:flex items-center space-x-3\">\n          <div className=\"flex items-center gap-2 pr-2 rounded-full bg-purple-900/5 border border-purple-500/10\">\n            <Avatar className=\"h-8 w-8 border border-purple-500/20 bg-purple-900/20\">\n              <AvatarFallback className=\"text-purple-400 bg-purple-900/20\">\n                {user?.username?.charAt(0)?.toUpperCase() || 'A'}\n              </AvatarFallback>\n            </Avatar>\n            <span className=\"text-sm font-medium\">{user?.username}</span>\n          </div>\n          \n          <TooltipProvider>\n            <Tooltip>\n              <TooltipTrigger asChild>\n                <Button \n                  variant=\"outline\" \n                  size=\"icon\"\n                  className=\"rounded-full bg-background/80 border-red-500/20 hover:bg-red-900/10 hover:text-red-400\"\n                  onClick={handleLogout}\n                >\n                  <LogOut className=\"h-4 w-4 text-muted-foreground\" />\n                </Button>\n              </TooltipTrigger>\n              <TooltipContent side=\"bottom\">\n                <p className=\"text-xs\">Logout</p>\n              </TooltipContent>\n            </Tooltip>\n          </TooltipProvider>\n        </div>\n      </header>\n\n      <div className=\"flex flex-1\">\n        {/* Sidebar for larger screens */}\n        <aside className={`${isCollapsed ? 'w-16' : 'w-64'} bg-background/80 border-r border-border hidden md:block transition-all duration-300`}>\n          <nav className=\"h-full flex flex-col py-6\">\n            <div className=\"flex-1 px-2\">\n              <div className={`text-xs font-semibold text-muted-foreground ${isCollapsed ? 'sr-only' : 'px-3 pb-2'}`}>\n                MAIN NAVIGATION\n              </div>\n              <ul className=\"space-y-1.5\">\n                {navItems.map((item) => (\n                  <li key={item.href}>\n                    <TooltipProvider delayDuration={0}>\n                      <Tooltip>\n                        <TooltipTrigger asChild>\n                          <div\n                            className={`flex items-center px-3 py-2.5 rounded-md cursor-pointer transition-colors ${\n                              item.active\n                                ? \"bg-purple-900/30 text-purple-300 font-medium border border-purple-500/20 shadow-sm\"\n                                : \"text-foreground hover:bg-background/80 hover:text-purple-300\"\n                            } ${isCollapsed ? 'justify-center' : ''}`}\n                            onClick={() => {\n                              window.location.href = item.href;\n                            }}\n                          >\n                            {item.icon}\n                            {!isCollapsed && item.title}\n                            {!isCollapsed && item.active && <ChevronRight className=\"ml-auto h-4 w-4 text-purple-400\" />}\n                          </div>\n                        </TooltipTrigger>\n                        {isCollapsed && (\n                          <TooltipContent side=\"right\">\n                            <p>{item.title}</p>\n                          </TooltipContent>\n                        )}\n                      </Tooltip>\n                    </TooltipProvider>\n                  </li>\n                ))}\n              </ul>\n            </div>\n            \n            <div className=\"px-3 mt-2\">\n              <Button \n                variant=\"ghost\" \n                size=\"icon\"\n                className={`w-full justify-center border border-border/50 ${isCollapsed ? 'h-9 rounded-md' : 'hidden'}`}\n                onClick={() => setIsCollapsed(false)}\n              >\n                <ChevronRight className=\"h-4 w-4\" />\n              </Button>\n              \n              <Button \n                variant=\"ghost\" \n                size=\"sm\"\n                className={`w-full justify-between border border-border/50 ${isCollapsed ? 'hidden' : ''}`}\n                onClick={() => setIsCollapsed(true)}\n              >\n                <span>Collapse</span>\n                <ChevronRight className=\"h-4 w-4 rotate-180\" />\n              </Button>\n            </div>\n          </nav>\n        </aside>\n\n        {/* Main content */}\n        <main className=\"flex-1 overflow-y-auto px-4 py-6 sm:p-6\">\n          {children}\n        </main>\n      </div>\n    </div>\n  );\n}\n","size_bytes":11840},"client/src/layouts/reseller-layout.tsx":{"content":"import { ReactNode, useState } from \"react\";\nimport { Link, useLocation } from \"wouter\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useWebSocket } from \"@/hooks/use-websocket\";\nimport {\n  LayoutDashboard,\n  Key,\n  ListChecks,\n  Code,\n  Menu,\n  X,\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Sheet, SheetContent, SheetTrigger } from \"@/components/ui/sheet\";\nimport { useQuery } from \"@tanstack/react-query\";\n\ninterface ResellerLayoutProps {\n  children: ReactNode;\n}\n\nexport default function ResellerLayout({ children }: ResellerLayoutProps) {\n  const { user, logout } = useAuth();\n  const [location] = useLocation();\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\n  \n  // Initialize WebSocket connection for real-time notifications (global for all reseller pages)\n  useWebSocket();\n\n  const { data: profile } = useQuery<any>({\n    queryKey: ['/api/reseller/profile'],\n    enabled: !!user,\n  });\n\n  const navItems = [\n    {\n      title: \"Overview\",\n      icon: <LayoutDashboard className=\"mr-3 h-5 w-5\" />,\n      href: \"/reseller\",\n      active: location === \"/reseller\",\n    },\n    {\n      title: \"Generate Keys\",\n      icon: <Key className=\"mr-3 h-5 w-5\" />,\n      href: \"/reseller/generate\",\n      active: location === \"/reseller/generate\",\n    },\n    {\n      title: \"Manage Keys\",\n      icon: <ListChecks className=\"mr-3 h-5 w-5\" />,\n      href: \"/reseller/keys\",\n      active: location === \"/reseller/keys\",\n    },\n    // API Reference hidden as requested\n    // {\n    //   title: \"API Reference\",\n    //   icon: <Code className=\"mr-3 h-5 w-5\" />,\n    //   href: \"/reseller/api\",\n    //   active: location === \"/reseller/api\",\n    // },\n  ];\n\n  const handleLogout = async () => {\n    await logout();\n  };\n\n  return (\n    <div className=\"min-h-screen flex flex-col bg-gradient-to-b from-black to-black/95\">\n      {/* Header */}\n      <header className=\"bg-black/60 backdrop-blur-sm border-b border-purple-900/30 py-4 px-6 flex justify-between items-center sticky top-0 z-50 shadow-lg shadow-purple-500/5\">\n        <div className=\"flex items-center\">\n          {/* Hamburger Menu for Mobile */}\n          <div className=\"sm:hidden mr-3 hamburger-fade-in\">\n            <Sheet open={mobileMenuOpen} onOpenChange={setMobileMenuOpen}>\n              <SheetTrigger asChild>\n                <Button \n                  variant=\"ghost\" \n                  size=\"icon\" \n                  className=\"border border-purple-500/30 bg-purple-900/20 shadow-lg shadow-purple-500/30 hover:bg-purple-900/30 hover:border-purple-500/50 transition-all hover:shadow-xl hover:shadow-purple-500/40\"\n                >\n                  <Menu className=\"h-5 w-5 text-purple-300\" />\n                </Button>\n              </SheetTrigger>\n              <SheetContent side=\"left\" className=\"w-[280px] sm:w-[320px] bg-black/90 border-r border-purple-900/30 z-[100]\">\n                <div className=\"flex flex-col h-full py-6\">\n                  <div className=\"flex items-center mb-6\">\n                    <div className=\"flex items-center\">\n                      <h2 className=\"text-xl font-bold bg-gradient-to-r from-purple-500 to-indigo-600 bg-clip-text text-transparent glow-text\">DEXX-TER</h2>\n                      <span className=\"ml-2 px-2 py-0.5 bg-purple-900/30 text-purple-400 text-xs rounded-md border border-purple-500/20\">\n                        Reseller\n                      </span>\n                    </div>\n                  </div>\n                  \n                  {/* User info in mobile menu */}\n                  <div className=\"bg-purple-900/20 p-4 rounded-lg border border-purple-500/20 mb-6\">\n                    <div className=\"text-sm text-foreground mb-2\">Logged in as <span className=\"font-medium text-white\">{user?.username}</span></div>\n                    <div className=\"text-sm text-purple-400 font-medium\">\n                      Available Credits: <span className=\"text-white\">{profile?.credits || 0}</span>\n                    </div>\n                  </div>\n                  \n                  <nav className=\"flex-1\">\n                    <ul className=\"space-y-2\">\n                      {navItems.map((item) => (\n                        <li key={item.href}>\n                          <div \n                            className={`flex items-center px-4 py-3 rounded-md text-sm cursor-pointer transition-colors ${\n                              item.active\n                                ? \"bg-purple-900/30 text-purple-300 font-medium border border-purple-500/20\"\n                                : \"text-foreground hover:bg-purple-900/20 hover:text-purple-300\"\n                            }`}\n                            onClick={() => {\n                              setMobileMenuOpen(false);\n                              location !== item.href && (window.location.href = item.href);\n                            }}\n                          >\n                            {item.icon}\n                            {item.title}\n                          </div>\n                        </li>\n                      ))}\n                    </ul>\n                  </nav>\n                  \n                  <Button \n                    variant=\"ghost\" \n                    className=\"mt-6 text-red-400 hover:text-red-300 hover:bg-red-900/20 border border-red-500/20 w-full\" \n                    onClick={() => {\n                      handleLogout();\n                      setMobileMenuOpen(false);\n                    }}\n                  >\n                    Logout\n                  </Button>\n                </div>\n              </SheetContent>\n            </Sheet>\n          </div>\n          \n          <h1 className=\"text-2xl font-bold bg-gradient-to-r from-purple-500 to-indigo-600 bg-clip-text text-transparent glow-text\">DEXX-TER</h1>\n          <span className=\"ml-2 px-2 py-1 bg-purple-900/30 text-purple-400 text-xs rounded-md border border-purple-500/20\">\n            Reseller\n          </span>\n        </div>\n        \n        <div className=\"flex items-center space-x-3\">\n          <div className=\"hidden sm:flex items-center space-x-3\">\n            <span className=\"text-sm text-foreground\">{user?.username}</span>\n            <span className=\"text-sm text-purple-400 font-medium bg-purple-900/20 px-3 py-1 rounded-md border border-purple-500/20\">\n              Credits: <span className=\"text-white\">{profile?.credits || 0}</span>\n            </span>\n            <Button \n              variant=\"ghost\" \n              size=\"sm\" \n              className=\"text-red-400 hover:text-red-300 hover:bg-red-900/20 border border-red-500/10\" \n              onClick={handleLogout}\n            >\n              Logout\n            </Button>\n          </div>\n        </div>\n      </header>\n\n      <div className=\"flex flex-1 relative\">\n\n        {/* Sidebar for desktop */}\n        <aside className=\"w-64 bg-black/50 border-r border-purple-900/30 hidden sm:block\">\n          <div className=\"bg-purple-900/20 mx-4 mt-6 p-4 rounded-lg border border-purple-500/20\">\n            <div className=\"text-sm text-foreground mb-1\">Available Credits</div>\n            <div className=\"text-2xl font-bold text-white\">{profile?.credits || 0}</div>\n          </div>\n          \n          <nav className=\"mt-6 px-4\">\n            <ul className=\"space-y-2\">\n              {navItems.map((item) => (\n                <li key={item.href}>\n                  <Link href={item.href}>\n                    <div\n                      className={`flex items-center px-4 py-3 rounded-md cursor-pointer transition-colors ${\n                        item.active\n                          ? \"bg-purple-900/30 text-purple-300 font-medium border border-purple-500/20\"\n                          : \"text-foreground hover:bg-purple-900/20 hover:text-purple-300\"\n                      }`}\n                    >\n                      {item.icon}\n                      {item.title}\n                    </div>\n                  </Link>\n                </li>\n              ))}\n            </ul>\n          </nav>\n        </aside>\n\n        {/* Main content */}\n        <main className=\"flex-1 overflow-y-auto p-4 sm:p-6\">\n          {children}\n        </main>\n      </div>\n    </div>\n  );\n}\n","size_bytes":8213},"client/src/lib/protected-route.tsx":{"content":"import { ReactNode } from \"react\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { Redirect, Route } from \"wouter\";\nimport { Loader2 } from \"lucide-react\";\n\ninterface ProtectedRouteProps {\n  path: string;\n  component: React.ComponentType;\n  role?: \"admin\" | \"reseller\";\n}\n\nexport function ProtectedRoute({ path, component: Component, role }: ProtectedRouteProps) {\n  const { user, isLoading, isAuthenticated } = useAuth();\n\n  if (isLoading) {\n    return (\n      <Route path={path}>\n        <div className=\"flex items-center justify-center min-h-screen bg-gradient-to-b from-black to-black/95\">\n          <div className=\"flex flex-col items-center p-8 rounded-lg bg-black/40 border border-purple-500/20 shadow-lg shadow-purple-500/10\">\n            <Loader2 className=\"h-12 w-12 animate-spin text-purple-500 mb-4\" />\n            <p className=\"text-purple-300\">Loading...</p>\n          </div>\n        </div>\n      </Route>\n    );\n  }\n\n  // If not authenticated, redirect to login\n  if (!isAuthenticated) {\n    return (\n      <Route path={path}>\n        <Redirect to=\"/\" />\n      </Route>\n    );\n  }\n\n  // If role is specified, check if user has the required role\n  if (role && user?.role !== role) {\n    return (\n      <Route path={path}>\n        <Redirect to={user?.role === \"admin\" ? \"/admin\" : \"/reseller\"} />\n      </Route>\n    );\n  }\n\n  // If authentication and role checks pass, render the component\n  return (\n    <Route path={path}>\n      <Component />\n    </Route>\n  );\n}","size_bytes":1482},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey[0] as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","size_bytes":1376},"client/src/lib/utils.ts":{"content":"import { type ClassValue, clsx } from \"clsx\";\nimport { twMerge } from \"tailwind-merge\";\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs));\n}\n\nexport function formatDate(date: Date | string): string {\n  return new Date(date).toLocaleDateString('en-US', {\n    year: 'numeric',\n    month: '2-digit',\n    day: '2-digit'\n  });\n}\n\nexport function generateRandomKey(game: string): string {\n  let prefix = \"\";\n  \n  if (game === \"PUBG MOBILE\") {\n    prefix = \"PBGM\";\n  } else if (game === \"LAST ISLAND OF SURVIVAL\") {\n    prefix = \"LIOS\";\n  } else if (game === \"STANDOFF2\") {\n    prefix = \"STDF\";\n  }\n  \n  // Generate random alphanumeric strings\n  const segment1 = Math.random().toString(36).substring(2, 7).toUpperCase();\n  const segment2 = Math.random().toString(36).substring(2, 7).toUpperCase();\n  const segment3 = Math.random().toString(36).substring(2, 7).toUpperCase();\n  \n  return `${prefix}-${segment1}-${segment2}-${segment3}`;\n}\n\nexport function getKeyStatus(key: any): string {\n  if (key.isRevoked) return \"REVOKED\";\n  \n  const now = new Date();\n  const expiryDate = new Date(key.expiryDate);\n  \n  return expiryDate <= now ? \"EXPIRED\" : \"ACTIVE\";\n}\n\nexport function getStatusColor(status: string): { bg: string, text: string, border: string } {\n  switch (status) {\n    case \"ACTIVE\":\n      return { bg: \"bg-green-500/10\", text: \"text-green-500\", border: \"border-green-500\" };\n    case \"EXPIRED\":\n      return { bg: \"bg-red-500/10\", text: \"text-red-500\", border: \"border-red-500\" };\n    case \"REVOKED\":\n      return { bg: \"bg-gray-500/10\", text: \"text-gray-500\", border: \"border-gray-500\" };\n    default:\n      return { bg: \"bg-blue-500/10\", text: \"text-blue-500\", border: \"border-blue-500\" };\n  }\n}\n","size_bytes":1730},"client/src/pages/auth-page.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { Redirect } from \"wouter\";\nimport { \n  Tabs, \n  TabsContent, \n  TabsList, \n  TabsTrigger \n} from \"@/components/ui/tabs\";\nimport { \n  Card, \n  CardContent, \n  CardDescription, \n  CardFooter, \n  CardHeader, \n  CardTitle \n} from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { useForm } from \"react-hook-form\";\nimport { z } from \"zod\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { \n  Lock, \n  UserCheck, \n  User, \n  MailCheck, \n  ShieldCheck,\n  LogIn,\n  UserPlus\n} from \"lucide-react\";\n\n// Login form schema\nconst loginSchema = z.object({\n  username: z.string().min(3, \"Username must be at least 3 characters\"),\n  password: z.string().min(4, \"Password must be at least 4 characters\"),\n  role: z.enum([\"admin\", \"reseller\"]).default(\"reseller\")\n});\n\n// Registration form schema\nconst registerSchema = z.object({\n  username: z.string().min(3, \"Username must be at least 3 characters\"),\n  password: z.string().min(4, \"Password must be at least 4 characters\"),\n  referralToken: z.string().min(4, \"Referral token is required\")\n});\n\ntype LoginValues = z.infer<typeof loginSchema>;\ntype RegisterValues = z.infer<typeof registerSchema>;\n\nexport default function AuthPage() {\n  const { user, isAuthenticated, login, register } = useAuth();\n  const { toast } = useToast();\n  const [activeTab, setActiveTab] = useState<string>(\"login\");\n\n  // If user is already logged in, redirect to appropriate dashboard\n  if (isAuthenticated && user) {\n    return <Redirect to={user.role === \"admin\" ? \"/admin\" : \"/reseller\"} />;\n  }\n\n  const loginForm = useForm<LoginValues>({\n    resolver: zodResolver(loginSchema),\n    defaultValues: {\n      username: \"\",\n      password: \"\",\n      role: \"reseller\"\n    }\n  });\n\n  const registerForm = useForm<RegisterValues>({\n    resolver: zodResolver(registerSchema),\n    defaultValues: {\n      username: \"\",\n      password: \"\",\n      referralToken: \"\"\n    }\n  });\n\n  const onLoginSubmit = async (values: LoginValues) => {\n    try {\n      await login(values.role, values.username, values.password);\n    } catch (error: any) {\n      toast({\n        title: \"Login Failed\",\n        description: error.message || \"Could not login. Please check your credentials.\",\n        variant: \"destructive\"\n      });\n    }\n  };\n\n  const onRegisterSubmit = async (values: RegisterValues) => {\n    try {\n      await register(values.username, values.password, values.referralToken);\n    } catch (error: any) {\n      toast({\n        title: \"Registration Failed\",\n        description: error.message || \"Could not register. Please check your information.\",\n        variant: \"destructive\"\n      });\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-[url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5NiIgaGVpZ2h0PSI5NiI+CjxyZWN0IHdpZHRoPSI5NiIgaGVpZ2h0PSI5NiIgZmlsbD0iIzAwMDAwMCI+PC9yZWN0Pgo8cmVjdCB3aWR0aD0iMSIgaGVpZ2h0PSIxIiBmaWxsPSIjNGEyNDgwIiBmaWxsLW9wYWNpdHk9IjAuMDIiPjwvcmVjdD4KPC9zdmc+')] bg-black before:fixed before:inset-0 before:bg-gradient-to-b before:from-black/5 before:via-purple-900/5 before:to-black/5 before:z-[-1] flex items-center justify-center p-4\">\n      <div className=\"absolute inset-0 overflow-hidden pointer-events-none\">\n        <div className=\"absolute w-[500px] h-[500px] -top-[100px] -left-[100px] bg-purple-500/5 rounded-full blur-3xl\"></div>\n        <div className=\"absolute w-[500px] h-[500px] top-[10%] right-[10%] bg-indigo-500/5 rounded-full blur-3xl\"></div>\n        <div className=\"absolute w-[500px] h-[500px] bottom-0 left-[30%] bg-purple-600/5 rounded-full blur-3xl\"></div>\n      </div>\n\n      <div className=\"w-full max-w-6xl grid grid-cols-1 lg:grid-cols-2 gap-6 relative z-10 border-glow rounded-xl overflow-hidden shadow-2xl shadow-purple-900/30\">\n        {/* Left Column - Form */}\n        <div className=\"bg-black/80 backdrop-blur-md p-8 rounded-l-xl border border-purple-500/20\">\n          <div className=\"flex items-center mb-10 justify-center sm:justify-start\">\n            <h1 className=\"text-4xl font-bold bg-gradient-to-r from-purple-400 via-purple-500 to-indigo-500 bg-clip-text text-transparent glow-text stable-text\">DEXX-TER</h1>\n            <span className=\"ml-3 px-3 py-1 bg-purple-900/30 text-purple-300 text-xs rounded-md border border-purple-500/30 stable-text\">\n              License System\n            </span>\n          </div>\n\n          <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\n            <TabsList className=\"grid grid-cols-2 mb-6 bg-black/30 border border-purple-500/20 p-1 rounded-lg\">\n              <TabsTrigger value=\"login\" className=\"data-[state=active]:bg-purple-900/40 data-[state=active]:text-white data-[state=active]:shadow-md data-[state=active]:border-purple-500/30 data-[state=active]:border rounded-md transition-all\">\n                <LogIn className=\"h-4 w-4 mr-2\" /> Login\n              </TabsTrigger>\n              <TabsTrigger value=\"register\" className=\"data-[state=active]:bg-purple-900/40 data-[state=active]:text-white data-[state=active]:shadow-md data-[state=active]:border-purple-500/30 data-[state=active]:border rounded-md transition-all\">\n                <UserPlus className=\"h-4 w-4 mr-2\" /> Register\n              </TabsTrigger>\n            </TabsList>\n\n            {/* Login Content */}\n            <TabsContent value=\"login\">\n              <Card className=\"border-2 border-purple-500/70 bg-black/60 shadow-xl shadow-purple-900/20 form-border-glow rounded-lg\">\n                <CardHeader className=\"space-y-1\">\n                  <CardTitle className=\"text-2xl font-bold text-white stable-text\">Welcome Back</CardTitle>\n                  <CardDescription className=\"text-gray-400 stable-text\">Login to manage your license keys</CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <Form {...loginForm}>\n                    <form onSubmit={loginForm.handleSubmit(onLoginSubmit)} className=\"space-y-5\">\n                      <FormField\n                        control={loginForm.control}\n                        name=\"role\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel className=\"text-gray-300\">Login As</FormLabel>\n                            <div className=\"grid grid-cols-2 gap-2\">\n                              <Button \n                                type=\"button\" \n                                variant={field.value === \"admin\" ? \"default\" : \"outline\"}\n                                className={field.value === \"admin\" \n                                  ? \"bg-gradient-to-r from-purple-600 to-indigo-600 hover:shadow-lg hover:shadow-purple-500/30 border-0 transition-all\"\n                                  : \"hover:bg-purple-900/30 border-purple-500/30 hover:text-white transition-all\"\n                                } \n                                onClick={() => loginForm.setValue(\"role\", \"admin\")}\n                              >\n                                <ShieldCheck className=\"h-4 w-4 mr-2\" /> Admin\n                              </Button>\n                              <Button \n                                type=\"button\" \n                                variant={field.value === \"reseller\" ? \"default\" : \"outline\"}\n                                className={field.value === \"reseller\" \n                                  ? \"bg-gradient-to-r from-purple-600 to-indigo-600 hover:shadow-lg hover:shadow-purple-500/30 border-0 transition-all\"\n                                  : \"hover:bg-purple-900/30 border-purple-500/30 hover:text-white transition-all\"\n                                } \n                                onClick={() => loginForm.setValue(\"role\", \"reseller\")}\n                              >\n                                <User className=\"h-4 w-4 mr-2\" /> Reseller\n                              </Button>\n                            </div>\n                          </FormItem>\n                        )}\n                      />\n\n                      <FormField\n                        control={loginForm.control}\n                        name=\"username\"\n                        render={({ field }) => (\n                          <FormItem className=\"space-y-1\">\n                            <FormLabel className=\"text-gray-300\">Username</FormLabel>\n                            <FormControl>\n                              <div className=\"relative input-border-glow rounded-md\">\n                                <UserCheck className=\"absolute left-3 top-2.5 h-5 w-5 text-purple-400 z-10\" />\n                                <Input \n                                  placeholder=\"Enter your username\" \n                                  className=\"pl-10 bg-black/90 border-transparent focus-visible:border-transparent focus-visible:ring-0 shadow-inner transition-all rounded-md\" \n                                  {...field} \n                                />\n                              </div>\n                            </FormControl>\n                            <FormMessage className=\"text-red-400 text-xs\" />\n                          </FormItem>\n                        )}\n                      />\n\n                      <FormField\n                        control={loginForm.control}\n                        name=\"password\"\n                        render={({ field }) => (\n                          <FormItem className=\"space-y-1\">\n                            <FormLabel className=\"text-gray-300\">Password</FormLabel>\n                            <FormControl>\n                              <div className=\"relative input-border-glow rounded-md\">\n                                <Lock className=\"absolute left-3 top-2.5 h-5 w-5 text-purple-400 z-10\" />\n                                <Input \n                                  type=\"password\" \n                                  placeholder=\"Enter your password\" \n                                  className=\"pl-10 bg-black/90 border-transparent focus-visible:border-transparent focus-visible:ring-0 shadow-inner transition-all rounded-md\" \n                                  {...field} \n                                />\n                              </div>\n                            </FormControl>\n                            <FormMessage className=\"text-red-400 text-xs\" />\n                          </FormItem>\n                        )}\n                      />\n\n                      <Button \n                        type=\"submit\" \n                        className=\"w-full bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-lg py-6 mt-4 border-0 shadow-lg shadow-purple-500/20 hover:shadow-purple-500/40 transition-all\"\n                        disabled={loginForm.formState.isSubmitting}\n                      >\n                        {loginForm.formState.isSubmitting ? (\n                          <div className=\"flex items-center\">\n                            <div className=\"animate-spin h-4 w-4 mr-2 border-2 border-white border-t-transparent rounded-full\"></div>\n                            Logging in...\n                          </div>\n                        ) : (\n                          <div className=\"flex items-center justify-center\">\n                            <LogIn className=\"h-5 w-5 mr-2\" /> Login\n                          </div>\n                        )}\n                      </Button>\n                    </form>\n                  </Form>\n                </CardContent>\n                <CardFooter className=\"flex justify-center border-t border-purple-500/10 pt-4\">\n                  <p className=\"text-sm text-gray-400\">\n                    Don't have an account?{\" \"}\n                    <button \n                      onClick={() => setActiveTab(\"register\")} \n                      className=\"text-purple-400 hover:text-purple-300 hover:underline font-medium\"\n                    >\n                      Register here\n                    </button>\n                  </p>\n                </CardFooter>\n              </Card>\n            </TabsContent>\n\n            {/* Register Content */}\n            <TabsContent value=\"register\">\n              <Card className=\"border-2 border-purple-500/70 bg-black/60 shadow-xl shadow-purple-900/20 form-border-glow rounded-lg\">\n                <CardHeader className=\"space-y-1\">\n                  <CardTitle className=\"text-2xl font-bold text-white stable-text\">Create Account</CardTitle>\n                  <CardDescription className=\"text-gray-400 stable-text\">Register as a reseller using your referral token</CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <Form {...registerForm}>\n                    <form onSubmit={registerForm.handleSubmit(onRegisterSubmit)} className=\"space-y-5\">\n                      <FormField\n                        control={registerForm.control}\n                        name=\"username\"\n                        render={({ field }) => (\n                          <FormItem className=\"space-y-1\">\n                            <FormLabel className=\"text-gray-300\">Username</FormLabel>\n                            <FormControl>\n                              <div className=\"relative input-border-glow rounded-md\">\n                                <User className=\"absolute left-3 top-2.5 h-5 w-5 text-purple-400 z-10\" />\n                                <Input \n                                  placeholder=\"Choose a username\" \n                                  className=\"pl-10 bg-black/90 border-transparent focus-visible:border-transparent focus-visible:ring-0 shadow-inner transition-all rounded-md\"\n                                  {...field} \n                                />\n                              </div>\n                            </FormControl>\n                            <FormMessage className=\"text-red-400 text-xs\" />\n                          </FormItem>\n                        )}\n                      />\n\n                      <FormField\n                        control={registerForm.control}\n                        name=\"password\"\n                        render={({ field }) => (\n                          <FormItem className=\"space-y-1\">\n                            <FormLabel className=\"text-gray-300\">Password</FormLabel>\n                            <FormControl>\n                              <div className=\"relative input-border-glow rounded-md\">\n                                <Lock className=\"absolute left-3 top-2.5 h-5 w-5 text-purple-400 z-10\" />\n                                <Input \n                                  type=\"password\" \n                                  placeholder=\"Create a password\" \n                                  className=\"pl-10 bg-black/90 border-transparent focus-visible:border-transparent focus-visible:ring-0 shadow-inner transition-all rounded-md\"\n                                  {...field} \n                                />\n                              </div>\n                            </FormControl>\n                            <FormMessage className=\"text-red-400 text-xs\" />\n                          </FormItem>\n                        )}\n                      />\n\n                      <FormField\n                        control={registerForm.control}\n                        name=\"referralToken\"\n                        render={({ field }) => (\n                          <FormItem className=\"space-y-1\">\n                            <FormLabel className=\"text-gray-300\">Referral Token</FormLabel>\n                            <FormControl>\n                              <div className=\"relative input-border-glow rounded-md\">\n                                <MailCheck className=\"absolute left-3 top-2.5 h-5 w-5 text-purple-400 z-10\" />\n                                <Input \n                                  placeholder=\"Enter your referral token\" \n                                  className=\"pl-10 bg-black/90 border-transparent focus-visible:border-transparent focus-visible:ring-0 shadow-inner transition-all rounded-md\"\n                                  {...field} \n                                />\n                              </div>\n                            </FormControl>\n                            <FormMessage className=\"text-red-400 text-xs\" />\n                          </FormItem>\n                        )}\n                      />\n\n                      <Button \n                        type=\"submit\" \n                        className=\"w-full bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-lg py-6 mt-4 border-0 shadow-lg shadow-purple-500/20 hover:shadow-purple-500/40 transition-all\"\n                        disabled={registerForm.formState.isSubmitting}\n                      >\n                        {registerForm.formState.isSubmitting ? (\n                          <div className=\"flex items-center\">\n                            <div className=\"animate-spin h-4 w-4 mr-2 border-2 border-white border-t-transparent rounded-full\"></div>\n                            Registering...\n                          </div>\n                        ) : (\n                          <div className=\"flex items-center justify-center\">\n                            <UserPlus className=\"h-5 w-5 mr-2\" /> Register\n                          </div>\n                        )}\n                      </Button>\n                    </form>\n                  </Form>\n                </CardContent>\n                <CardFooter className=\"flex justify-center border-t border-purple-500/10 pt-4\">\n                  <p className=\"text-sm text-gray-400\">\n                    Already have an account?{\" \"}\n                    <button \n                      onClick={() => setActiveTab(\"login\")} \n                      className=\"text-purple-400 hover:text-purple-300 hover:underline font-medium\"\n                    >\n                      Login here\n                    </button>\n                  </p>\n                </CardFooter>\n              </Card>\n            </TabsContent>\n          </Tabs>\n        </div>\n\n        {/* Right Column - Hero */}\n        <div className=\"hidden lg:block bg-gradient-to-br from-purple-900/40 via-indigo-900/20 to-black relative overflow-hidden rounded-r-xl border border-purple-500/20\">\n          <div className=\"absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxkZWZzPjxwYXR0ZXJuIGlkPSJncmlkIiB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHBhdHRlcm5Vbml0cz0idXNlclNwYWNlT25Vc2UiPjxwYXRoIGQ9Ik0gNDAgMCBMIDAgMCAwIDQwIiBmaWxsPSJub25lIiBzdHJva2U9InJnYmEoMTI4LCA5MCwgMjEzLCAwLjEpIiBzdHJva2Utd2lkdGg9IjEiLz48L3BhdHRlcm4+PC9kZWZzPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9InVybCgjZ3JpZCkiLz48L3N2Zz4=')]\"></div>\n          \n          {/* Animated background effects */}\n          <div className=\"absolute inset-0 overflow-hidden\">\n            <div className=\"absolute w-[300px] h-[300px] top-[-10%] right-[-10%] bg-purple-500/10 rounded-full blur-3xl animate-pulse\"></div>\n            <div className=\"absolute w-[250px] h-[250px] bottom-[-10%] left-[-10%] bg-indigo-500/10 rounded-full blur-3xl animate-pulse\" style={{ animationDelay: '1s' }}></div>\n          </div>\n          \n          {/* Content */}\n          <div className=\"relative z-10 p-8 h-full flex flex-col justify-center\">\n            <div className=\"max-w-md mx-auto text-center\">\n              <div className=\"bg-black/30 backdrop-blur-sm p-6 rounded-2xl border border-purple-500/30 shadow-2xl shadow-purple-500/20\">\n                <div className=\"inline-block p-3 rounded-full bg-purple-900/40 border border-purple-500/30 mb-6 shadow-lg shadow-purple-500/20\">\n                  <div className=\"bg-gradient-to-br from-purple-500 to-indigo-600 text-white w-12 h-12 rounded-full flex items-center justify-center\">\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className=\"w-6 h-6\">\n                      <rect x=\"3\" y=\"11\" width=\"18\" height=\"11\" rx=\"2\" ry=\"2\"></rect>\n                      <path d=\"M7 11V7a5 5 0 0 1 10 0v4\"></path>\n                    </svg>\n                  </div>\n                </div>\n                <h2 className=\"text-2xl font-bold bg-gradient-to-r from-purple-400 to-indigo-500 bg-clip-text text-transparent mb-4\">Advanced License Management System</h2>\n                <p className=\"text-gray-400 mb-6\">Generate, track, and manage game license keys with a powerful admin interface and reseller functionality.</p>\n                \n                <div className=\"space-y-3\">\n                  <div className=\"flex items-center text-sm text-gray-300\">\n                    <div className=\"w-5 h-5 rounded-full bg-purple-500/20 flex items-center justify-center mr-3 border border-purple-500/40\">\n                      <svg width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                        <path d=\"M20 6L9 17L4 12\" stroke=\"#a855f7\" strokeWidth=\"3\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                      </svg>\n                    </div>\n                    Multiple games supported\n                  </div>\n                  <div className=\"flex items-center text-sm text-gray-300\">\n                    <div className=\"w-5 h-5 rounded-full bg-purple-500/20 flex items-center justify-center mr-3 border border-purple-500/40\">\n                      <svg width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                        <path d=\"M20 6L9 17L4 12\" stroke=\"#a855f7\" strokeWidth=\"3\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                      </svg>\n                    </div>\n                    Device tracking and management\n                  </div>\n                  <div className=\"flex items-center text-sm text-gray-300\">\n                    <div className=\"w-5 h-5 rounded-full bg-purple-500/20 flex items-center justify-center mr-3 border border-purple-500/40\">\n                      <svg width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                        <path d=\"M20 6L9 17L4 12\" stroke=\"#a855f7\" strokeWidth=\"3\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                      </svg>\n                    </div>\n                    Reseller credit system\n                  </div>\n                  <div className=\"flex items-center text-sm text-gray-300\">\n                    <div className=\"w-5 h-5 rounded-full bg-purple-500/20 flex items-center justify-center mr-3 border border-purple-500/40\">\n                      <svg width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                        <path d=\"M20 6L9 17L4 12\" stroke=\"#a855f7\" strokeWidth=\"3\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                      </svg>\n                    </div>\n                    Complete license tracking\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":23519},"client/src/pages/login.tsx":{"content":"import { useState } from \"react\";\nimport { Link } from \"wouter\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useForm } from \"react-hook-form\";\nimport { z } from \"zod\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport { InputOTP, InputOTPGroup, InputOTPSlot } from \"@/components/ui/input-otp\";\nimport { Lock, UserCheck, Mail, Shield } from \"lucide-react\";\n\n// Audio utility function for login errors\nconst playLoginErrorSound = () => {\n  try {\n    const audio = new Audio('/sounds/login-error.mp3');\n    audio.volume = 0.7;\n    audio.play().catch(error => console.log('Audio play failed:', error));\n  } catch (error) {\n    console.log('Audio creation failed:', error);\n  }\n};\n\nconst loginSchema = z.object({\n  username: z.string().min(1, \"Username is required\"),\n  password: z.string().min(1, \"Password is required\"),\n});\n\nconst otpSchema = z.object({\n  otp: z.string().min(6, \"OTP must be 6 digits\").max(6, \"OTP must be 6 digits\"),\n});\n\ntype LoginValues = z.infer<typeof loginSchema>;\ntype OTPValues = z.infer<typeof otpSchema>;\n\nexport default function Login() {\n  const [activeTab, setActiveTab] = useState<\"admin\" | \"reseller\">(\"admin\");\n  const [showOTP, setShowOTP] = useState(false);\n  const [maskedEmail, setMaskedEmail] = useState(\"\");\n  const [isOTPLoading, setIsOTPLoading] = useState(false);\n  const { login, isLoading } = useAuth();\n  const { toast } = useToast();\n\n  const adminForm = useForm<LoginValues>({\n    resolver: zodResolver(loginSchema),\n    defaultValues: {\n      username: \"\",\n      password: \"\",\n    },\n  });\n\n  const resellerForm = useForm<LoginValues>({\n    resolver: zodResolver(loginSchema),\n    defaultValues: {\n      username: \"\",\n      password: \"\",\n    },\n  });\n\n  const otpForm = useForm<OTPValues>({\n    resolver: zodResolver(otpSchema),\n    defaultValues: {\n      otp: \"\",\n    },\n  });\n\n  // Step 1: Verify admin credentials and send OTP\n  async function onAdminSubmit(values: LoginValues) {\n    try {\n      console.log('Starting admin login step 1...');\n      \n      const response = await fetch('/api/auth/admin/login', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(values),\n        credentials: 'include'\n      });\n      \n      const data = await response.json();\n      \n      if (!response.ok) {\n        throw new Error(data.message || 'Login failed');\n      }\n      \n      if (data.requiresOTP) {\n        // Credentials verified, OTP sent\n        setMaskedEmail(data.email);\n        setShowOTP(true);\n        \n        toast({\n          title: \"Verification Code Sent\",\n          description: `Please check your email (${data.email}) for the 6-digit verification code`,\n          duration: 5000,\n        });\n        \n        console.log('✅ OTP step initiated successfully');\n      } else {\n        // This shouldn't happen with new flow, but handle it just in case\n        toast({\n          title: \"Success\",\n          description: \"Logged in as admin successfully\",\n        });\n      }\n    } catch (error: any) {\n      console.log('Caught error in onAdminSubmit:', error);\n      \n      // Play login error sound\n      playLoginErrorSound();\n      \n      toast({\n        title: \"Login Failed\",\n        description: error.message || \"Failed to login\",\n        variant: \"destructive\",\n        duration: 10000,\n      });\n    }\n  }\n  \n  // Step 2: Verify OTP and complete login\n  async function onOTPSubmit(values: OTPValues) {\n    try {\n      setIsOTPLoading(true);\n      console.log('Starting OTP verification...');\n      \n      const response = await fetch('/api/auth/admin/verify-otp', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(values),\n        credentials: 'include'\n      });\n      \n      const data = await response.json();\n      \n      if (!response.ok) {\n        throw new Error(data.message || 'OTP verification failed');\n      }\n      \n      // OTP verified successfully, user should be logged in\n      toast({\n        title: \"Success\",\n        description: \"Logged in as admin successfully\",\n      });\n      \n      console.log('✅ Admin login completed successfully');\n      \n      // Reset forms and state\n      adminForm.reset();\n      otpForm.reset();\n      setShowOTP(false);\n      setMaskedEmail(\"\");\n      \n      // Force refresh auth state\n      window.location.reload();\n      \n    } catch (error: any) {\n      console.log('Caught error in onOTPSubmit:', error);\n      \n      // Play login error sound\n      playLoginErrorSound();\n      \n      toast({\n        title: \"Verification Failed\",\n        description: error.message || \"Invalid verification code\",\n        variant: \"destructive\",\n        duration: 10000,\n      });\n      \n      // Reset OTP field on error\n      otpForm.reset();\n    } finally {\n      setIsOTPLoading(false);\n    }\n  }\n\n  async function onResellerSubmit(values: LoginValues) {\n    try {\n      await login(\"reseller\", values.username, values.password);\n      toast({\n        title: \"Success\",\n        description: \"Logged in as reseller successfully\",\n      });\n    } catch (error: any) {\n      console.log('Caught error in onResellerSubmit:', error);\n      console.log('Error message for toast:', error.message);\n      \n      // Play login error sound\n      playLoginErrorSound();\n      \n      // Add alert as backup to test visibility\n      alert(\"LOGIN ERROR: \" + (error.message || \"Failed to login\"));\n      \n      toast({\n        title: \"Login Failed\", \n        description: error.message || \"Failed to login\",\n        variant: \"destructive\",\n        duration: 10000, // Show for 10 seconds\n      });\n      console.log('Toast function called with description:', error.message || \"Failed to login\");\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-background px-4 bg-gradient-to-br from-background via-background to-purple-950/20 moving-glow\">\n      <Card className=\"max-w-md w-full border border-purple-500/30 shadow-xl shadow-purple-500/10 backdrop-blur-sm bg-background/80 form-border-glow relative z-10\">\n        <CardContent className=\"pt-6\">\n          <div className=\"text-center mb-8 float\">\n            <h1 className=\"text-4xl font-bold text-primary bg-gradient-to-r from-purple-500 to-indigo-600 bg-clip-text text-transparent pb-1 glow-text shine-effect\">DEXX-TER</h1>\n            <p className=\"text-muted-foreground mt-2\">Professional License Management</p>\n          </div>\n\n          <Tabs defaultValue=\"admin\" onValueChange={(value) => setActiveTab(value as \"admin\" | \"reseller\")}>\n            <div className=\"flex justify-center mb-4\">\n              <TabsList className=\"inline-flex h-9 items-center justify-center rounded-lg bg-background/80 p-1 border border-purple-500/20\">\n                <TabsTrigger \n                  value=\"admin\" \n                  className=\"data-[state=active]:bg-purple-900/30 data-[state=active]:text-purple-300 data-[state=active]:shadow-none px-4 py-1.5 text-sm font-medium\"\n                >\n                  Admin\n                </TabsTrigger>\n                <TabsTrigger \n                  value=\"reseller\" \n                  className=\"data-[state=active]:bg-purple-900/30 data-[state=active]:text-purple-300 data-[state=active]:shadow-none px-4 py-1.5 text-sm font-medium\"\n                >\n                  Reseller\n                </TabsTrigger>\n              </TabsList>\n            </div>\n\n            <TabsContent value=\"admin\">\n              {!showOTP ? (\n                // Step 1: Credential verification\n                <Form {...adminForm}>\n                  <form onSubmit={adminForm.handleSubmit(onAdminSubmit)} className=\"space-y-4\">\n                    <FormField\n                      control={adminForm.control}\n                      name=\"username\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>Username</FormLabel>\n                          <FormControl>\n                            <div className=\"relative\">\n                              <UserCheck className=\"absolute left-3 top-2.5 h-5 w-5 text-purple-400 z-10\" aria-hidden=\"true\" />\n                              <Input \n                                placeholder=\"Enter admin username\" \n                                className=\"pl-10\" \n                                {...field} \n                                data-testid=\"input-admin-username\"\n                              />\n                            </div>\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                    \n                    <FormField\n                      control={adminForm.control}\n                      name=\"password\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>Password</FormLabel>\n                          <FormControl>\n                            <div className=\"relative\">\n                              <Lock className=\"absolute left-3 top-2.5 h-5 w-5 text-purple-400 z-10\" aria-hidden=\"true\" />\n                              <Input \n                                type=\"password\" \n                                placeholder=\"Enter admin password\" \n                                className=\"pl-10\" \n                                {...field} \n                                data-testid=\"input-admin-password\"\n                              />\n                            </div>\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                    \n                    <Button \n                      type=\"submit\" \n                      className=\"w-full bg-gradient-to-r from-purple-700 to-indigo-600 hover:from-purple-600 hover:to-indigo-500 relative\" \n                      disabled={isLoading}\n                      data-testid=\"button-admin-login\"\n                    >\n                      {isLoading ? \"Verifying...\" : \"Verify Credentials\"}\n                    </Button>\n                  </form>\n                </Form>\n              ) : (\n                // Step 2: OTP verification\n                <div className=\"space-y-6\">\n                  <div className=\"text-center space-y-2\">\n                    <div className=\"flex items-center justify-center w-16 h-16 mx-auto bg-purple-100 dark:bg-purple-900/20 rounded-full\">\n                      <Shield className=\"w-8 h-8 text-purple-600 dark:text-purple-400\" />\n                    </div>\n                    <h3 className=\"text-lg font-semibold text-foreground\">Email Verification</h3>\n                    <p className=\"text-sm text-muted-foreground\">\n                      A 6-digit verification code has been sent to\n                    </p>\n                    <div className=\"flex items-center justify-center gap-2 text-sm\">\n                      <Mail className=\"w-4 h-4 text-purple-400\" />\n                      <span className=\"font-medium text-purple-400\">{maskedEmail}</span>\n                    </div>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Code expires in 1 minute\n                    </p>\n                  </div>\n                  \n                  <Form {...otpForm}>\n                    <form onSubmit={otpForm.handleSubmit(onOTPSubmit)} className=\"space-y-4\">\n                      <FormField\n                        control={otpForm.control}\n                        name=\"otp\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel className=\"text-center block\">Verification Code</FormLabel>\n                            <FormControl>\n                              <div className=\"flex justify-center\">\n                                <InputOTP\n                                  maxLength={6}\n                                  value={field.value}\n                                  onChange={field.onChange}\n                                  data-testid=\"input-admin-otp\"\n                                >\n                                  <InputOTPGroup>\n                                    <InputOTPSlot index={0} />\n                                    <InputOTPSlot index={1} />\n                                    <InputOTPSlot index={2} />\n                                    <InputOTPSlot index={3} />\n                                    <InputOTPSlot index={4} />\n                                    <InputOTPSlot index={5} />\n                                  </InputOTPGroup>\n                                </InputOTP>\n                              </div>\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n                      \n                      <div className=\"flex gap-3\">\n                        <Button\n                          type=\"button\"\n                          variant=\"outline\"\n                          onClick={() => {\n                            setShowOTP(false);\n                            setMaskedEmail(\"\");\n                            otpForm.reset();\n                          }}\n                          className=\"flex-1\"\n                          data-testid=\"button-admin-back\"\n                        >\n                          Back\n                        </Button>\n                        <Button \n                          type=\"submit\" \n                          className=\"flex-1 bg-gradient-to-r from-purple-700 to-indigo-600 hover:from-purple-600 hover:to-indigo-500\" \n                          disabled={isOTPLoading}\n                          data-testid=\"button-admin-verify-otp\"\n                        >\n                          {isOTPLoading ? \"Verifying...\" : \"Verify & Login\"}\n                        </Button>\n                      </div>\n                    </form>\n                  </Form>\n                </div>\n              )}\n            </TabsContent>\n\n            <TabsContent value=\"reseller\">\n              <Form {...resellerForm}>\n                <form onSubmit={resellerForm.handleSubmit(onResellerSubmit)} className=\"space-y-4\">\n                  <FormField\n                    control={resellerForm.control}\n                    name=\"username\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Username</FormLabel>\n                        <FormControl>\n                          <div className=\"relative\">\n                            <UserCheck className=\"absolute left-3 top-2.5 h-5 w-5 text-purple-400 z-10\" aria-hidden=\"true\" />\n                            <Input \n                              placeholder=\"Enter reseller username\" \n                              className=\"pl-10\" \n                              {...field} \n                            />\n                          </div>\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                  \n                  <FormField\n                    control={resellerForm.control}\n                    name=\"password\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Password</FormLabel>\n                        <FormControl>\n                          <div className=\"relative\">\n                            <Lock className=\"absolute left-3 top-2.5 h-5 w-5 text-purple-400 z-10\" aria-hidden=\"true\" />\n                            <Input \n                              type=\"password\" \n                              placeholder=\"Enter reseller password\" \n                              className=\"pl-10\" \n                              {...field} \n                            />\n                          </div>\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                  \n                  <Button \n                    type=\"submit\" \n                    className=\"w-full bg-gradient-to-r from-purple-700 to-indigo-600 hover:from-purple-600 hover:to-indigo-500 relative\" \n                    disabled={isLoading}\n                  >\n                    {isLoading ? \"Logging in...\" : \"Login as Reseller\"}\n                  </Button>\n                </form>\n              </Form>\n\n              <div className=\"text-center mt-4 pt-4 border-t border-border\">\n                <p className=\"text-sm text-muted-foreground\">Don't have an account?</p>\n                <Button \n                  variant=\"link\" \n                  className=\"mt-1 text-purple-400 hover:text-purple-300 glow-text\"\n                  onClick={() => window.location.href = \"/register\"}\n                >\n                  Register with Referral Token\n                </Button>\n              </div>\n            </TabsContent>\n          </Tabs>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":17593},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":711},"client/src/pages/register.tsx":{"content":"import { Link } from \"wouter\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useForm } from \"react-hook-form\";\nimport { z } from \"zod\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport { UserCheck, Lock, MailCheck } from \"lucide-react\";\n\n// Audio utility function for registration errors\nconst playRegistrationErrorSound = () => {\n  try {\n    const audio = new Audio('/sounds/registration-error.mp3');\n    audio.volume = 0.7;\n    audio.play().catch(error => console.log('Audio play failed:', error));\n  } catch (error) {\n    console.log('Audio creation failed:', error);\n  }\n};\n\nconst registerSchema = z.object({\n  username: z.string().min(3, \"Username must be at least 3 characters\"),\n  password: z.string().min(6, \"Password must be at least 6 characters\"),\n  referralToken: z.string().min(1, \"Referral token is required\"),\n});\n\ntype RegisterValues = z.infer<typeof registerSchema>;\n\nexport default function Register() {\n  const { register, isLoading } = useAuth();\n  const { toast } = useToast();\n\n  const form = useForm<RegisterValues>({\n    resolver: zodResolver(registerSchema),\n    defaultValues: {\n      username: \"\",\n      password: \"\",\n      referralToken: \"\",\n    },\n  });\n\n  async function onSubmit(values: RegisterValues) {\n    try {\n      await register(values.username, values.password, values.referralToken);\n      toast({\n        title: \"Success\",\n        description: \"Account registered successfully\",\n      });\n    } catch (error: any) {\n      console.log('Caught error in registration:', error);\n      console.log('Error message for registration:', error.message);\n      \n      // Play registration error sound\n      playRegistrationErrorSound();\n      \n      // Show browser popup for invalid referral token\n      alert(\"REGISTRATION ERROR: \" + (error.message || \"Failed to register\"));\n      \n      toast({\n        title: \"Registration Failed\",\n        description: error.message || \"Failed to register\",\n        variant: \"destructive\",\n        duration: 10000, // Show for 10 seconds\n      });\n      console.log('Registration toast called with description:', error.message || \"Failed to register\");\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-background px-4 bg-gradient-to-br from-background via-background to-purple-950/20 moving-glow\">\n      <Card className=\"max-w-md w-full border border-purple-500/30 shadow-xl shadow-purple-500/10 backdrop-blur-sm bg-background/80 form-border-glow relative z-10\">\n        <CardContent className=\"pt-6\">\n          <div className=\"text-center mb-8 float\">\n            <h1 className=\"text-4xl font-bold text-primary bg-gradient-to-r from-purple-500 to-indigo-600 bg-clip-text text-transparent pb-1 glow-text shine-effect\">DEXX-TER</h1>\n            <p className=\"text-muted-foreground mt-2\">Reseller Registration</p>\n          </div>\n\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n              <FormField\n                control={form.control}\n                name=\"username\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Username</FormLabel>\n                    <FormControl>\n                      <div className=\"relative\">\n                        <UserCheck className=\"absolute left-3 top-2.5 h-5 w-5 text-purple-400 z-10\" aria-hidden=\"true\" />\n                        <Input \n                          placeholder=\"Choose a username\" \n                          className=\"pl-10\" \n                          {...field} \n                        />\n                      </div>\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              \n              <FormField\n                control={form.control}\n                name=\"password\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Password</FormLabel>\n                    <FormControl>\n                      <div className=\"relative\">\n                        <Lock className=\"absolute left-3 top-2.5 h-5 w-5 text-purple-400 z-10\" aria-hidden=\"true\" />\n                        <Input \n                          type=\"password\" \n                          placeholder=\"Choose a password\" \n                          className=\"pl-10\" \n                          {...field} \n                        />\n                      </div>\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              \n              <FormField\n                control={form.control}\n                name=\"referralToken\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Referral Token</FormLabel>\n                    <FormControl>\n                      <div className=\"relative\">\n                        <MailCheck className=\"absolute left-3 top-2.5 h-5 w-5 text-purple-400 z-10\" aria-hidden=\"true\" />\n                        <Input \n                          placeholder=\"Enter your referral token\" \n                          className=\"pl-10\" \n                          {...field} \n                        />\n                      </div>\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              \n              <Button type=\"submit\" className=\"w-full bg-gradient-to-r from-purple-700 to-indigo-600 hover:from-purple-600 hover:to-indigo-500 relative\" disabled={isLoading}>\n                {isLoading ? \"Registering...\" : \"Register Account\"}\n              </Button>\n\n              <div className=\"text-center mt-4\">\n                <Button \n                  variant=\"link\" \n                  className=\"text-purple-400 hover:text-purple-300 glow-text\"\n                  onClick={() => window.location.href = \"/\"}\n                >\n                  Back to Login\n                </Button>\n              </div>\n            </form>\n          </Form>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":6448},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","size_bytes":1977},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","size_bytes":4420},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","size_bytes":1584},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","size_bytes":140},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","size_bytes":1419},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n","size_bytes":1128},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","size_bytes":2712},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-md px-3\",\n        lg: \"h-11 rounded-md px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","size_bytes":1901},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","size_bytes":2695},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n","size_bytes":1858},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","size_bytes":6210},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","size_bytes":10481},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","size_bytes":1056},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","size_bytes":329},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","size_bytes":4885},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","size_bytes":7428},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => {\n  // Check if we're on a mobile device\n  const [isMobile, setIsMobile] = React.useState(\n    typeof window !== 'undefined' ? window.innerWidth < 768 : false\n  );\n\n  React.useEffect(() => {\n    if (typeof window === 'undefined') return;\n\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 768);\n    };\n\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  return (\n    <DialogPortal>\n      <DialogOverlay className=\"bg-black/80\" />\n      <DialogPrimitive.Content\n        ref={ref}\n        className={cn(\n          \"fixed left-[50%] top-[50%] z-[9999] grid w-full translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%]\",\n          isMobile \n            ? \"max-w-[94vw] p-4 rounded-lg max-h-[90vh] overflow-y-auto key-details-dialog\" \n            : \"max-w-lg p-6 sm:rounded-lg\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n        <DialogPrimitive.Close className=\"absolute right-3 top-3 rounded-full h-6 w-6 flex items-center justify-center bg-background/10 backdrop-blur-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 hover:bg-background/20 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n          <X className=\"h-4 w-4\" />\n          <span className=\"sr-only\">Close</span>\n        </DialogPrimitive.Close>\n      </DialogPrimitive.Content>\n    </DialogPortal>\n  );\n})\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","size_bytes":4598},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","size_bytes":3021},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      align=\"start\"\n      collisionPadding={10}\n      avoidCollisions={true}\n      className={cn(\n        \"z-[9999] max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin] dropdown-menu-content\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-3 py-2.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 touch-manipulation\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","size_bytes":7731},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","size_bytes":4120},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","size_bytes":1251},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","size_bytes":2154},"client/src/components/ui/input-with-border.tsx":{"content":"import { InputHTMLAttributes, forwardRef } from 'react';\nimport { cn } from '@/lib/utils';\n\nexport interface InputWithBorderProps extends InputHTMLAttributes<HTMLInputElement> {}\n\nconst InputWithBorder = forwardRef<HTMLInputElement, InputWithBorderProps>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <div className=\"relative input-border-glow rounded-md overflow-hidden\">\n        <input\n          type={type}\n          className={cn(\n            \"flex h-10 w-full rounded-md bg-black/70 backdrop-blur-sm border border-purple-500/30 px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-purple-500/40 focus-visible:border-purple-500 disabled:cursor-not-allowed disabled:opacity-50 shadow-inner transition-all\",\n            className\n          )}\n          ref={ref}\n          {...props}\n        />\n      </div>\n    );\n  }\n);\n\nInputWithBorder.displayName = \"InputWithBorder\";\n\nexport { InputWithBorder };","size_bytes":988},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","size_bytes":791},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","size_bytes":710},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","size_bytes":8605},"client/src/components/ui/mobile-dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst MobileDialog = DialogPrimitive.Root\n\nconst MobileDialogTrigger = DialogPrimitive.Trigger\n\nconst MobileDialogPortal = DialogPrimitive.Portal\n\nconst MobileDialogClose = DialogPrimitive.Close\n\nconst MobileDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-[999] bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nMobileDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst MobileDialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <MobileDialogPortal>\n    <MobileDialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed z-[1000] grid gap-3 bg-background p-0 shadow-lg duration-150 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 border-purple-500/20 border overflow-hidden mobile-dialog-content\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mobile-dialog-handle\"></div>\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-3 top-3 z-[1001] rounded-full h-6 w-6 flex items-center justify-center bg-background/10 backdrop-blur-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 hover:bg-background/20 focus:outline-none disabled:pointer-events-none\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </MobileDialogPortal>\n))\nMobileDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst MobileDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col p-4 border-b border-purple-500/20 bg-purple-900/10\",\n      className\n    )}\n    {...props}\n  />\n)\nMobileDialogHeader.displayName = \"MobileDialogHeader\"\n\nconst MobileDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse gap-2 p-4 border-t border-purple-500/20 bg-purple-900/5\",\n      className\n    )}\n    {...props}\n  />\n)\nMobileDialogFooter.displayName = \"MobileDialogFooter\"\n\nconst MobileDialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold text-purple-300\",\n      className\n    )}\n    {...props}\n  />\n))\nMobileDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst MobileDialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nMobileDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  MobileDialog,\n  MobileDialogPortal,\n  MobileDialogOverlay,\n  MobileDialogClose,\n  MobileDialogTrigger,\n  MobileDialogContent,\n  MobileDialogHeader,\n  MobileDialogFooter,\n  MobileDialogTitle,\n  MobileDialogDescription,\n}","size_bytes":3842},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","size_bytes":5128},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","size_bytes":2751},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","size_bytes":1280},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","size_bytes":791},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","size_bytes":1467},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","size_bytes":1723},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","size_bytes":1642},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1 touch-manipulation\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50 flex-shrink-0 ml-1\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => {\n  // Get viewport width to adapt to mobile\n  const [viewportWidth, setViewportWidth] = React.useState(typeof window !== 'undefined' ? window.innerWidth : 1200);\n  \n  React.useEffect(() => {\n    if (typeof window === 'undefined') return;\n    \n    const handleResize = () => {\n      setViewportWidth(window.innerWidth);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n  \n  const isMobile = viewportWidth < 768;\n  \n  return (\n    <SelectPrimitive.Portal>\n      <SelectPrimitive.Content\n        ref={ref}\n        className={cn(\n          \"fixed z-[9999] max-h-[250px] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n          isMobile \n            ? \"w-[94vw] !left-[3vw] !right-[3vw] !top-[30%] transform-none\"\n            : \"origin-[--radix-select-content-transform-origin] data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n          className\n        )}\n        position={isMobile ? \"item-aligned\" : position}\n        sideOffset={8}\n        align={isMobile ? \"center\" : \"start\"}\n        alignOffset={isMobile ? 0 : undefined}\n        avoidCollisions={!isMobile}\n        collisionPadding={isMobile ? 20 : 10}\n        {...props}\n      >\n        <SelectScrollUpButton />\n        <SelectPrimitive.Viewport\n          className={cn(\n            \"p-1\",\n            position === \"popper\" &&\n              \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n          )}\n        >\n          {children}\n        </SelectPrimitive.Viewport>\n        <SelectScrollDownButton />\n      </SelectPrimitive.Content>\n    </SelectPrimitive.Portal>\n  );\n})\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-2.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 touch-manipulation\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText className=\"truncate\">{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","size_bytes":6650},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","size_bytes":756},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","size_bytes":4281},"client/src/components/ui/sidebar.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { VariantProps, cva } from \"class-variance-authority\"\nimport { PanelLeft } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nconst SidebarProvider = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    defaultOpen?: boolean\n    open?: boolean\n    onOpenChange?: (open: boolean) => void\n  }\n>(\n  (\n    {\n      defaultOpen = true,\n      open: openProp,\n      onOpenChange: setOpenProp,\n      className,\n      style,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const isMobile = useIsMobile()\n    const [openMobile, setOpenMobile] = React.useState(false)\n\n    // This is the internal state of the sidebar.\n    // We use openProp and setOpenProp for control from outside the component.\n    const [_open, _setOpen] = React.useState(defaultOpen)\n    const open = openProp ?? _open\n    const setOpen = React.useCallback(\n      (value: boolean | ((value: boolean) => boolean)) => {\n        const openState = typeof value === \"function\" ? value(open) : value\n        if (setOpenProp) {\n          setOpenProp(openState)\n        } else {\n          _setOpen(openState)\n        }\n\n        // This sets the cookie to keep the sidebar state.\n        document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n      },\n      [setOpenProp, open]\n    )\n\n    // Helper to toggle the sidebar.\n    const toggleSidebar = React.useCallback(() => {\n      return isMobile\n        ? setOpenMobile((open) => !open)\n        : setOpen((open) => !open)\n    }, [isMobile, setOpen, setOpenMobile])\n\n    // Adds a keyboard shortcut to toggle the sidebar.\n    React.useEffect(() => {\n      const handleKeyDown = (event: KeyboardEvent) => {\n        if (\n          event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n          (event.metaKey || event.ctrlKey)\n        ) {\n          event.preventDefault()\n          toggleSidebar()\n        }\n      }\n\n      window.addEventListener(\"keydown\", handleKeyDown)\n      return () => window.removeEventListener(\"keydown\", handleKeyDown)\n    }, [toggleSidebar])\n\n    // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n    // This makes it easier to style the sidebar with Tailwind classes.\n    const state = open ? \"expanded\" : \"collapsed\"\n\n    const contextValue = React.useMemo<SidebarContextProps>(\n      () => ({\n        state,\n        open,\n        setOpen,\n        isMobile,\n        openMobile,\n        setOpenMobile,\n        toggleSidebar,\n      }),\n      [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n    )\n\n    return (\n      <SidebarContext.Provider value={contextValue}>\n        <TooltipProvider delayDuration={0}>\n          <div\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH,\n                \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n                ...style,\n              } as React.CSSProperties\n            }\n            className={cn(\n              \"group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar\",\n              className\n            )}\n            ref={ref}\n            {...props}\n          >\n            {children}\n          </div>\n        </TooltipProvider>\n      </SidebarContext.Provider>\n    )\n  }\n)\nSidebarProvider.displayName = \"SidebarProvider\"\n\nconst Sidebar = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    side?: \"left\" | \"right\"\n    variant?: \"sidebar\" | \"floating\" | \"inset\"\n    collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n  }\n>(\n  (\n    {\n      side = \"left\",\n      variant = \"sidebar\",\n      collapsible = \"offcanvas\",\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n    if (collapsible === \"none\") {\n      return (\n        <div\n          className={cn(\n            \"flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground\",\n            className\n          )}\n          ref={ref}\n          {...props}\n        >\n          {children}\n        </div>\n      )\n    }\n\n    if (isMobile) {\n      return (\n        <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n          <SheetContent\n            data-sidebar=\"sidebar\"\n            data-mobile=\"true\"\n            className=\"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden\"\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n              } as React.CSSProperties\n            }\n            side={side}\n          >\n            <SheetHeader className=\"sr-only\">\n              <SheetTitle>Sidebar</SheetTitle>\n              <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n            </SheetHeader>\n            <div className=\"flex h-full w-full flex-col\">{children}</div>\n          </SheetContent>\n        </Sheet>\n      )\n    }\n\n    return (\n      <div\n        ref={ref}\n        className=\"group peer hidden text-sidebar-foreground md:block\"\n        data-state={state}\n        data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n        data-variant={variant}\n        data-side={side}\n      >\n        {/* This is what handles the sidebar gap on desktop */}\n        <div\n          className={cn(\n            \"relative w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear\",\n            \"group-data-[collapsible=offcanvas]:w-0\",\n            \"group-data-[side=right]:rotate-180\",\n            variant === \"floating\" || variant === \"inset\"\n              ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon]\"\n          )}\n        />\n        <div\n          className={cn(\n            \"fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex\",\n            side === \"left\"\n              ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n              : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n            // Adjust the padding for floating and inset variants.\n            variant === \"floating\" || variant === \"inset\"\n              ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n            className\n          )}\n          {...props}\n        >\n          <div\n            data-sidebar=\"sidebar\"\n            className=\"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow\"\n          >\n            {children}\n          </div>\n        </div>\n      </div>\n    )\n  }\n)\nSidebar.displayName = \"Sidebar\"\n\nconst SidebarTrigger = React.forwardRef<\n  React.ElementRef<typeof Button>,\n  React.ComponentProps<typeof Button>\n>(({ className, onClick, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      ref={ref}\n      data-sidebar=\"trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeft />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n})\nSidebarTrigger.displayName = \"SidebarTrigger\"\n\nconst SidebarRail = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\">\n>(({ className, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <button\n      ref={ref}\n      data-sidebar=\"rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex\",\n        \"[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarRail.displayName = \"SidebarRail\"\n\nconst SidebarInset = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"main\">\n>(({ className, ...props }, ref) => {\n  return (\n    <main\n      ref={ref}\n      className={cn(\n        \"relative flex w-full flex-1 flex-col bg-background\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInset.displayName = \"SidebarInset\"\n\nconst SidebarInput = React.forwardRef<\n  React.ElementRef<typeof Input>,\n  React.ComponentProps<typeof Input>\n>(({ className, ...props }, ref) => {\n  return (\n    <Input\n      ref={ref}\n      data-sidebar=\"input\"\n      className={cn(\n        \"h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInput.displayName = \"SidebarInput\"\n\nconst SidebarHeader = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarHeader.displayName = \"SidebarHeader\"\n\nconst SidebarFooter = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarFooter.displayName = \"SidebarFooter\"\n\nconst SidebarSeparator = React.forwardRef<\n  React.ElementRef<typeof Separator>,\n  React.ComponentProps<typeof Separator>\n>(({ className, ...props }, ref) => {\n  return (\n    <Separator\n      ref={ref}\n      data-sidebar=\"separator\"\n      className={cn(\"mx-2 w-auto bg-sidebar-border\", className)}\n      {...props}\n    />\n  )\n})\nSidebarSeparator.displayName = \"SidebarSeparator\"\n\nconst SidebarContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarContent.displayName = \"SidebarContent\"\n\nconst SidebarGroup = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarGroup.displayName = \"SidebarGroup\"\n\nconst SidebarGroupLabel = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupLabel.displayName = \"SidebarGroupLabel\"\n\nconst SidebarGroupAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupAction.displayName = \"SidebarGroupAction\"\n\nconst SidebarGroupContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"group-content\"\n    className={cn(\"w-full text-sm\", className)}\n    {...props}\n  />\n))\nSidebarGroupContent.displayName = \"SidebarGroupContent\"\n\nconst SidebarMenu = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu\"\n    className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n    {...props}\n  />\n))\nSidebarMenu.displayName = \"SidebarMenu\"\n\nconst SidebarMenuItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    data-sidebar=\"menu-item\"\n    className={cn(\"group/menu-item relative\", className)}\n    {...props}\n  />\n))\nSidebarMenuItem.displayName = \"SidebarMenuItem\"\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:!p-0\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst SidebarMenuButton = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    isActive?: boolean\n    tooltip?: string | React.ComponentProps<typeof TooltipContent>\n  } & VariantProps<typeof sidebarMenuButtonVariants>\n>(\n  (\n    {\n      asChild = false,\n      isActive = false,\n      variant = \"default\",\n      size = \"default\",\n      tooltip,\n      className,\n      ...props\n    },\n    ref\n  ) => {\n    const Comp = asChild ? Slot : \"button\"\n    const { isMobile, state } = useSidebar()\n\n    const button = (\n      <Comp\n        ref={ref}\n        data-sidebar=\"menu-button\"\n        data-size={size}\n        data-active={isActive}\n        className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n        {...props}\n      />\n    )\n\n    if (!tooltip) {\n      return button\n    }\n\n    if (typeof tooltip === \"string\") {\n      tooltip = {\n        children: tooltip,\n      }\n    }\n\n    return (\n      <Tooltip>\n        <TooltipTrigger asChild>{button}</TooltipTrigger>\n        <TooltipContent\n          side=\"right\"\n          align=\"center\"\n          hidden={state !== \"collapsed\" || isMobile}\n          {...tooltip}\n        />\n      </Tooltip>\n    )\n  }\n)\nSidebarMenuButton.displayName = \"SidebarMenuButton\"\n\nconst SidebarMenuAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    showOnHover?: boolean\n  }\n>(({ className, asChild = false, showOnHover = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuAction.displayName = \"SidebarMenuAction\"\n\nconst SidebarMenuBadge = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"menu-badge\"\n    className={cn(\n      \"pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground\",\n      \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n      \"peer-data-[size=sm]/menu-button:top-1\",\n      \"peer-data-[size=default]/menu-button:top-1.5\",\n      \"peer-data-[size=lg]/menu-button:top-2.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuBadge.displayName = \"SidebarMenuBadge\"\n\nconst SidebarMenuSkeleton = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    showIcon?: boolean\n  }\n>(({ className, showIcon = false, ...props }, ref) => {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[--skeleton-width] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n})\nSidebarMenuSkeleton.displayName = \"SidebarMenuSkeleton\"\n\nconst SidebarMenuSub = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu-sub\"\n    className={cn(\n      \"mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuSub.displayName = \"SidebarMenuSub\"\n\nconst SidebarMenuSubItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ ...props }, ref) => <li ref={ref} {...props} />)\nSidebarMenuSubItem.displayName = \"SidebarMenuSubItem\"\n\nconst SidebarMenuSubButton = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentProps<\"a\"> & {\n    asChild?: boolean\n    size?: \"sm\" | \"md\"\n    isActive?: boolean\n  }\n>(({ asChild = false, size = \"md\", isActive, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuSubButton.displayName = \"SidebarMenuSubButton\"\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","size_bytes":23567},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","size_bytes":261},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","size_bytes":1077},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","size_bytes":1139},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","size_bytes":2765},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","size_bytes":1883},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","size_bytes":689},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","size_bytes":4845},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","size_bytes":772},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","size_bytes":1753},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","size_bytes":1527},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","size_bytes":1209},"client/src/pages/admin/api.tsx":{"content":"import AdminLayout from \"@/layouts/admin-layout\";\nimport {\n  Card,\n  CardContent,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/card\";\nimport { Copy, Check, Code, Webhook } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { useState } from \"react\";\n\ninterface CodeSnippetProps {\n  title: string;\n  code: string;\n  language?: string;\n}\n\nfunction CodeSnippet({ title, code }: CodeSnippetProps) {\n  const [copied, setCopied] = useState(false);\n  \n  const copyToClipboard = () => {\n    navigator.clipboard.writeText(code).then(() => {\n      setCopied(true);\n      setTimeout(() => setCopied(false), 2000);\n    });\n  };\n\n  return (\n    <div className=\"bg-muted/30 rounded-md border border-border overflow-hidden w-full\">\n      <div className=\"flex items-center justify-between px-3 py-2 bg-muted/50 border-b border-border\">\n        <span className=\"text-xs font-medium text-muted-foreground truncate\">{title}</span>\n        <Button\n          variant=\"ghost\"\n          size=\"sm\"\n          className=\"h-6 px-2 text-xs flex-shrink-0 ml-2\"\n          onClick={copyToClipboard}\n        >\n          {copied ? (\n            <>\n              <Check className=\"h-3 w-3 mr-1 text-green-500\" />\n              <span className=\"hidden sm:inline\">Copied</span>\n            </>\n          ) : (\n            <>\n              <Copy className=\"h-3 w-3 mr-1\" />\n              <span className=\"hidden sm:inline\">Copy</span>\n            </>\n          )}\n        </Button>\n      </div>\n      <div className=\"p-3 overflow-x-auto\">\n        <pre className=\"text-xs font-mono text-foreground whitespace-pre-wrap break-all sm:break-normal sm:whitespace-pre\">\n          <code>{code}</code>\n        </pre>\n      </div>\n    </div>\n  );\n}\n\ninterface ParameterItemProps {\n  name: string;\n  description: string;\n}\n\nfunction ParameterItem({ name, description }: ParameterItemProps) {\n  return (\n    <div className=\"p-3 bg-purple-900/5 rounded-md border border-purple-500/20\">\n      <div className=\"mb-2\">\n        <span className=\"inline-block font-mono text-xs bg-purple-900/30 text-purple-300 px-2 py-1 rounded font-medium break-all\">\n          {name}\n        </span>\n      </div>\n      <p className=\"text-xs text-muted-foreground leading-relaxed\">\n        {description}\n      </p>\n    </div>\n  );\n}\n\ninterface TabSectionProps {\n  title: string;\n  active: boolean;\n  onClick: () => void;\n}\n\nfunction TabButton({ title, active, onClick }: TabSectionProps) {\n  return (\n    <button\n      className={`flex-1 py-3 px-3 text-sm font-medium rounded-md border transition-all duration-200 ${\n        active \n          ? 'bg-purple-500/20 border-purple-500/50 text-purple-300 shadow-sm' \n          : 'bg-muted/30 border-border text-muted-foreground hover:bg-muted/50'\n      }`}\n      onClick={onClick}\n    >\n      {title}\n    </button>\n  );\n}\n\ninterface EndpointSectionProps {\n  title: string;\n  method: string;\n  endpoint: string;\n  requestCode: string;\n  responseCode: string;\n  requestParams: ParameterItemProps[];\n  responseParams: ParameterItemProps[];\n  note?: string;\n}\n\nfunction EndpointSection({ \n  title, \n  method, \n  endpoint, \n  requestCode, \n  responseCode, \n  requestParams, \n  responseParams,\n  note \n}: EndpointSectionProps) {\n  const [activeTab, setActiveTab] = useState<'request' | 'response'>('request');\n\n  return (\n    <Card className=\"overflow-hidden border border-purple-500/20\">\n      <CardHeader className=\"p-4 bg-gradient-to-r from-purple-900/20 to-indigo-900/20 border-b border-border\">\n        <CardTitle className=\"text-base font-semibold bg-gradient-to-r from-purple-400 to-indigo-400 bg-clip-text text-transparent flex items-start\">\n          <Webhook className=\"h-4 w-4 mr-2 text-purple-400 flex-shrink-0 mt-0.5\" />\n          <span className=\"break-words\">{title}</span>\n        </CardTitle>\n        <div className=\"flex flex-col sm:flex-row sm:items-center gap-2 mt-2\">\n          <span className={`px-2 py-1 text-xs font-mono rounded font-bold flex-shrink-0 ${\n            method === 'POST' ? 'bg-green-900/30 text-green-400' : 'bg-blue-900/30 text-blue-400'\n          }`}>\n            {method}\n          </span>\n          <code className=\"text-xs bg-muted/60 px-2 py-1 rounded font-mono text-muted-foreground break-all\">\n            {endpoint}\n          </code>\n        </div>\n      </CardHeader>\n      \n      <CardContent className=\"p-0\">\n        {/* Mobile-friendly tabs */}\n        <div className=\"flex gap-2 p-4 bg-muted/10\">\n          <TabButton \n            title=\"Request\" \n            active={activeTab === 'request'} \n            onClick={() => setActiveTab('request')} \n          />\n          <TabButton \n            title=\"Response\" \n            active={activeTab === 'response'} \n            onClick={() => setActiveTab('response')} \n          />\n        </div>\n\n        <div className=\"p-4\">\n          {activeTab === 'request' && (\n            <div className=\"space-y-4\">\n              <CodeSnippet \n                title=\"Request Example\"\n                code={requestCode}\n              />\n              \n              <div>\n                <h4 className=\"text-sm font-semibold text-purple-400 mb-3\">Parameters</h4>\n                <div className=\"space-y-3\">\n                  {requestParams.map((param, index) => (\n                    <ParameterItem key={index} {...param} />\n                  ))}\n                </div>\n              </div>\n              \n              {note && (\n                <div className=\"bg-green-900/10 border border-green-500/20 rounded-md p-3\">\n                  <h5 className=\"text-xs font-semibold text-green-400 mb-1\">Note</h5>\n                  <p className=\"text-xs text-muted-foreground\">{note}</p>\n                </div>\n              )}\n            </div>\n          )}\n\n          {activeTab === 'response' && (\n            <div className=\"space-y-4\">\n              <CodeSnippet \n                title=\"Response Example\"\n                code={responseCode}\n              />\n              \n              <div>\n                <h4 className=\"text-sm font-semibold text-purple-400 mb-3\">Response Fields</h4>\n                <div className=\"space-y-3\">\n                  {responseParams.map((param, index) => (\n                    <ParameterItem key={index} {...param} />\n                  ))}\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\nexport default function AdminApi() {\n  const [mainTab, setMainTab] = useState<'post' | 'get' | 'updates'>('post');\n\n  const postEndpoint = {\n    title: \"Key Verification Endpoint\",\n    method: \"POST\",\n    endpoint: \"/api/verify\",\n    requestCode: `POST /api/verify\nContent-Type: application/json\n\n{\n  \"key\": \"YOUR_LICENSE_KEY\",\n  \"deviceId\": \"UNIQUE_DEVICE_ID\", \n  \"game\": \"GAME_NAME\"\n}`,\n    responseCode: `{\n  \"valid\": true,\n  \"expiry\": \"2025-12-31\",\n  \"deviceLimit\": 2,\n  \"currentDevices\": 1,\n  \"message\": \"License valid\"\n}`,\n    requestParams: [\n      { name: \"key\", description: \"Your license key string\" },\n      { name: \"deviceId\", description: \"Unique device identifier (HWID or fingerprint)\" },\n      { name: \"game\", description: \"Game name (PUBG MOBILE, LAST ISLAND, STANDOFF2)\" }\n    ],\n    responseParams: [\n      { name: \"valid\", description: \"Boolean - if the license is valid and active\" },\n      { name: \"expiry\", description: \"License expiration date in ISO format\" },\n      { name: \"deviceLimit\", description: \"Maximum devices allowed for this key\" },\n      { name: \"currentDevices\", description: \"Current registered devices for this key\" },\n      { name: \"message\", description: \"Human-readable status message\" }\n    ]\n  };\n\n  const getEndpoint = {\n    title: \"GET Key Verification Endpoint\",\n    method: \"GET\",\n    endpoint: \"/api/verify/:key/:game/:deviceId\",\n    requestCode: `GET /api/verify/YOUR_LICENSE_KEY/GAME_NAME/UNIQUE_DEVICE_ID`,\n    responseCode: `{\n  \"valid\": true,\n  \"expiry\": \"2025-12-31\", \n  \"deviceLimit\": 2,\n  \"currentDevices\": 1,\n  \"canRegister\": true,\n  \"message\": \"License valid\"\n}`,\n    requestParams: [\n      { name: \"key\", description: \"Your license key string\" },\n      { name: \"game\", description: \"Game name (PUBG MOBILE, LAST ISLAND, STANDOFF2)\" },\n      { name: \"deviceId\", description: \"Unique device identifier (HWID or fingerprint)\" }\n    ],\n    responseParams: [\n      { name: \"valid\", description: \"Boolean - if the license is valid and active\" },\n      { name: \"expiry\", description: \"License expiration date in ISO format\" },\n      { name: \"deviceLimit\", description: \"Maximum devices allowed for this key\" },\n      { name: \"currentDevices\", description: \"Current registered devices for this key\" },\n      { name: \"canRegister\", description: \"Boolean - if new device can be registered (GET only)\" },\n      { name: \"message\", description: \"Human-readable status message\" }\n    ],\n    note: \"GET endpoint only checks validity but doesn't register device. Use POST to register.\"\n  };\n\n  const onlineUpdatesEndpoint = {\n    title: \"Online Updates API\",\n    method: \"GET\",\n    endpoint: \"/api/updates\",\n    requestCode: `GET /api/updates`,\n    responseCode: `[\n  {\n    \"id\": 1,\n    \"title\": \"App Update Available\",\n    \"message\": \"A new version of the app is available with bug fixes and improvements.\",\n    \"buttonText\": \"Update Now\",\n    \"linkUrl\": \"https://yourapp.com/download\",\n    \"isActive\": true,\n    \"createdAt\": \"2025-09-14T06:00:00.000Z\",\n    \"updatedAt\": \"2025-09-14T06:00:00.000Z\"\n  }\n]`,\n    requestParams: [],\n    responseParams: [\n      { name: \"id\", description: \"Unique identifier for the update\" },\n      { name: \"title\", description: \"Update title/headline\" },\n      { name: \"message\", description: \"Update message content\" },\n      { name: \"buttonText\", description: \"Text for action button (optional)\" },\n      { name: \"linkUrl\", description: \"URL to open when button is clicked (optional)\" },\n      { name: \"isActive\", description: \"Boolean - if the update should be shown to users\" },\n      { name: \"createdAt\", description: \"ISO timestamp when update was created\" },\n      { name: \"updatedAt\", description: \"ISO timestamp when update was last modified\" }\n    ],\n    note: \"This endpoint returns all currently active updates that should be displayed to app users.\"\n  };\n\n  const implementationExamples = {\n    post: `// POST - Verifies and Registers Device\nasync function verifyKey(key, deviceId, game) {\n  const response = await fetch('/api/verify', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ key, deviceId, game })\n  });\n  \n  const data = await response.json();\n  \n  if (data.valid) {\n    console.log('Valid until:', data.expiry);\n    return true;\n  } else {\n    console.error('Error:', data.message);\n    return false;\n  }\n}`,\n    get: `// GET - Only Checks, No Registration\nasync function checkKey(key, deviceId, game) {\n  const url = \\`/api/verify/\\${key}/\\${game}/\\${deviceId}\\`;\n  const response = await fetch(url);\n  const data = await response.json();\n  \n  if (data.valid) {\n    console.log('Valid until:', data.expiry);\n    console.log('Can register:', data.canRegister);\n    return data;\n  } else {\n    console.error('Check failed:', data.message);\n    return { isValid: false };\n  }\n}`,\n    updates: `// Fetch Online Updates\nasync function getOnlineUpdates() {\n  const response = await fetch('/api/updates');\n  const updates = await response.json();\n  \n  updates.forEach(update => {\n    if (update.isActive) {\n      console.log('Update:', update.title);\n      console.log('Message:', update.message);\n      \n      if (update.buttonText && update.linkUrl) {\n        console.log('Action:', update.buttonText, '→', update.linkUrl);\n        // You can create UI elements with the button and link\n      }\n    }\n  });\n  \n  return updates;\n}`\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"min-h-screen w-full\">\n        <div className=\"space-y-4 mb-6\">\n          <h2 className=\"text-lg sm:text-xl font-bold bg-gradient-to-r from-purple-500 to-indigo-600 bg-clip-text text-transparent\">\n            API Documentation\n          </h2>\n          <p className=\"text-sm text-muted-foreground\">\n            Integration guide for verifying license keys\n          </p>\n        </div>\n\n        {/* Main method selector - Full width on mobile */}\n        <div className=\"mb-6\">\n          <div className=\"flex gap-2\">\n            <TabButton \n              title=\"POST Method\" \n              active={mainTab === 'post'} \n              onClick={() => setMainTab('post')} \n            />\n            <TabButton \n              title=\"GET Method\" \n              active={mainTab === 'get'} \n              onClick={() => setMainTab('get')} \n            />\n            <TabButton \n              title=\"Online Updates\" \n              active={mainTab === 'updates'} \n              onClick={() => setMainTab('updates')} \n            />\n          </div>\n        </div>\n\n        <div className=\"space-y-4\">\n          {mainTab === 'post' && (\n            <>\n              <EndpointSection {...postEndpoint} />\n              \n              <Card className=\"border border-purple-500/20\">\n                <CardHeader className=\"p-4 bg-gradient-to-r from-purple-900/20 to-indigo-900/20 border-b border-border\">\n                  <CardTitle className=\"text-base font-semibold bg-gradient-to-r from-purple-400 to-indigo-400 bg-clip-text text-transparent flex items-center\">\n                    <Code className=\"h-4 w-4 mr-2 text-purple-400 flex-shrink-0\" />\n                    Implementation Example\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"p-4\">\n                  <CodeSnippet \n                    title=\"JavaScript Implementation\"\n                    code={implementationExamples.post}\n                  />\n                </CardContent>\n              </Card>\n            </>\n          )}\n\n          {mainTab === 'get' && (\n            <>\n              <EndpointSection {...getEndpoint} />\n              \n              <Card className=\"border border-purple-500/20\">\n                <CardHeader className=\"p-4 bg-gradient-to-r from-purple-900/20 to-indigo-900/20 border-b border-border\">\n                  <CardTitle className=\"text-base font-semibold bg-gradient-to-r from-purple-400 to-indigo-400 bg-clip-text text-transparent flex items-center\">\n                    <Code className=\"h-4 w-4 mr-2 text-purple-400 flex-shrink-0\" />\n                    Implementation Example\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"p-4\">\n                  <CodeSnippet \n                    title=\"JavaScript Implementation\"\n                    code={implementationExamples.get}\n                  />\n                </CardContent>\n              </Card>\n            </>\n          )}\n\n          {mainTab === 'updates' && (\n            <>\n              <EndpointSection {...onlineUpdatesEndpoint} />\n              \n              <Card className=\"border border-purple-500/20\">\n                <CardHeader className=\"p-4 bg-gradient-to-r from-purple-900/20 to-indigo-900/20 border-b border-border\">\n                  <CardTitle className=\"text-base font-semibold bg-gradient-to-r from-purple-400 to-indigo-400 bg-clip-text text-transparent flex items-center\">\n                    <Code className=\"h-4 w-4 mr-2 text-purple-400 flex-shrink-0\" />\n                    Implementation Example\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"p-4\">\n                  <CodeSnippet \n                    title=\"JavaScript Implementation\"\n                    code={implementationExamples.updates}\n                  />\n                </CardContent>\n              </Card>\n            </>\n          )}\n\n          {/* Important note - Mobile optimized */}\n          <div className=\"bg-amber-900/10 border border-amber-500/20 rounded-md p-4\">\n            <div className=\"flex items-start gap-3\">\n              <div className=\"rounded-full bg-amber-900/20 p-1 mt-0.5 flex-shrink-0\">\n                <svg className=\"h-4 w-4 text-amber-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />\n                </svg>\n              </div>\n              <div className=\"flex-1\">\n                <h4 className=\"text-sm font-semibold text-amber-400 mb-1\">Important Note</h4>\n                <p className=\"text-xs text-muted-foreground\">\n                  Replace <code className=\"bg-amber-900/20 px-1 py-0.5 rounded text-amber-400 text-xs break-all\">yourdomain.com</code> with your actual API endpoint. Make sure to implement proper error handling and retry logic in production apps.\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </AdminLayout>\n  );\n}","size_bytes":16991},"client/src/pages/admin/dashboard.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport AdminLayout from \"@/layouts/admin-layout\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { formatDate } from \"@/lib/utils\";\nimport { \n  Users, \n  Key, \n  Ticket,\n  UserPlus,\n  CreditCard\n} from \"lucide-react\";\n\nexport default function AdminDashboard() {\n  // Fetch dashboard statistics\n  const { data: stats, isLoading: isLoadingStats } = useQuery({\n    queryKey: ['/api/admin/stats'],\n  });\n\n  // Fetch resellers for activity list\n  const { data: resellers, isLoading: isLoadingResellers } = useQuery({\n    queryKey: ['/api/admin/resellers'],\n  });\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-2\">\n        <h2 className=\"text-2xl font-bold bg-gradient-to-r from-purple-500 to-indigo-600 bg-clip-text text-transparent\">Dashboard Overview</h2>\n        <p className=\"text-muted-foreground text-sm pb-4\">Monitor your license system activity</p>\n      </div>\n      \n      <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-8\">\n        {/* Stats Cards */}\n        <Card className=\"border border-purple-500/20 shadow-lg shadow-purple-500/5 overflow-hidden\">\n          <CardContent className=\"p-0\">\n            <div className=\"flex items-center p-4\">\n              <div className=\"bg-purple-900/30 p-3 rounded-full border border-purple-500/20 mr-4\">\n                <Users className=\"text-purple-400 h-5 w-5\" />\n              </div>\n              <div>\n                <p className=\"text-sm text-muted-foreground font-medium\">Total Resellers</p>\n                <h3 className=\"text-2xl font-bold bg-gradient-to-r from-purple-500 to-indigo-600 bg-clip-text text-transparent\">\n                  {isLoadingStats ? \"...\" : stats?.totalResellers || 0}\n                </h3>\n              </div>\n            </div>\n            <div className=\"bg-purple-900/10 h-1 w-full\"></div>\n          </CardContent>\n        </Card>\n        \n        <Card className=\"border border-purple-500/20 shadow-lg shadow-purple-500/5 overflow-hidden\">\n          <CardContent className=\"p-0\">\n            <div className=\"flex items-center p-4\">\n              <div className=\"bg-green-900/30 p-3 rounded-full border border-green-500/20 mr-4\">\n                <Key className=\"text-green-400 h-5 w-5\" />\n              </div>\n              <div>\n                <p className=\"text-sm text-muted-foreground font-medium\">Active Keys</p>\n                <h3 className=\"text-2xl font-bold bg-gradient-to-r from-green-400 to-emerald-500 bg-clip-text text-transparent\">\n                  {isLoadingStats ? \"...\" : stats?.activeKeys || 0}\n                </h3>\n              </div>\n            </div>\n            <div className=\"bg-green-900/10 h-1 w-full\"></div>\n          </CardContent>\n        </Card>\n        \n        <Card className=\"border border-purple-500/20 shadow-lg shadow-purple-500/5 overflow-hidden\">\n          <CardContent className=\"p-0\">\n            <div className=\"flex items-center p-4\">\n              <div className=\"bg-blue-900/30 p-3 rounded-full border border-blue-500/20 mr-4\">\n                <Ticket className=\"text-blue-400 h-5 w-5\" />\n              </div>\n              <div>\n                <p className=\"text-sm text-muted-foreground font-medium\">Available Tokens</p>\n                <h3 className=\"text-2xl font-bold bg-gradient-to-r from-blue-400 to-indigo-500 bg-clip-text text-transparent\">\n                  {isLoadingStats ? \"...\" : stats?.availableTokens || 0}\n                </h3>\n              </div>\n            </div>\n            <div className=\"bg-blue-900/10 h-1 w-full\"></div>\n          </CardContent>\n        </Card>\n      </div>\n      \n      <Card className=\"overflow-hidden border border-purple-500/20 shadow-lg shadow-purple-500/5\">\n        <CardHeader className=\"px-6 py-4 border-b border-border bg-gradient-to-r from-purple-900/20 to-indigo-900/20\">\n          <CardTitle className=\"text-base font-medium bg-gradient-to-r from-purple-500 to-indigo-600 bg-clip-text text-transparent\">Recent Activity</CardTitle>\n        </CardHeader>\n        <CardContent className=\"p-0\">\n          {isLoadingResellers ? (\n            <div className=\"p-6 text-center text-muted-foreground flex items-center justify-center\">\n              <div className=\"animate-pulse flex flex-col items-center\">\n                <div className=\"h-8 w-8 bg-purple-900/30 rounded-full mb-2\"></div>\n                <div className=\"h-2.5 bg-purple-900/30 rounded-full w-24 mb-1.5\"></div>\n                <div className=\"h-2 bg-purple-900/20 rounded-full w-16\"></div>\n              </div>\n            </div>\n          ) : resellers && resellers.length > 0 ? (\n            <div className=\"divide-y divide-border\">\n              {resellers.slice(0, 5).map((reseller, index) => (\n                <div key={reseller.id || index} className=\"py-3 px-6 hover:bg-purple-900/5 transition-colors\">\n                  <div className=\"flex items-center\">\n                    <div className=\"bg-purple-900/30 p-2 rounded-full mr-3 border border-purple-500/20\">\n                      <UserPlus className=\"text-purple-400 h-4 w-4\" />\n                    </div>\n                    <div>\n                      <p className=\"text-sm\">\n                        Reseller registered: <span className=\"font-medium text-purple-400\">{reseller.username}</span>\n                      </p>\n                      <p className=\"text-xs text-muted-foreground mt-1\">\n                        {formatDate(reseller.registrationDate || new Date())}\n                      </p>\n                    </div>\n                  </div>\n                </div>\n              ))}\n            </div>\n          ) : (\n            <div className=\"p-6 text-center text-muted-foreground\">\n              <div className=\"mb-2 flex justify-center\">\n                <div className=\"bg-purple-900/30 p-3 rounded-full border border-purple-500/20\">\n                  <UserPlus className=\"text-purple-400 h-5 w-5\" />\n                </div>\n              </div>\n              <p>No resellers registered yet</p>\n              <p className=\"text-xs mt-1\">Generate tokens to invite resellers</p>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </AdminLayout>\n  );\n}\n","size_bytes":6225},"client/src/pages/admin/database-backup.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport AdminLayout from \"@/layouts/admin-layout\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { \n  Download, \n  Database, \n  FileText, \n  Archive,\n  Clock,\n  HardDrive,\n  RefreshCw,\n  AlertCircle \n} from \"lucide-react\";\nimport { format } from \"date-fns\";\n\ninterface BackupCollection {\n  name: string;\n  collectionName: string;\n  size: number;\n  count: number;\n  modified: string;\n  downloadUrl: string;\n}\n\nexport default function DatabaseBackup() {\n  const [collections, setCollections] = useState<BackupCollection[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [downloadingAll, setDownloadingAll] = useState(false);\n  const [downloadingFile, setDownloadingFile] = useState<string | null>(null);\n  const { toast } = useToast();\n\n  const fetchCollections = async () => {\n    try {\n      setLoading(true);\n      const response = await fetch('/api/admin/backup/collections');\n      if (!response.ok) {\n        throw new Error('Failed to fetch MongoDB collections');\n      }\n      const data = await response.json();\n      setCollections(data);\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to load MongoDB collections\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchCollections();\n  }, []);\n\n  const downloadFile = async (filename: string) => {\n    try {\n      setDownloadingFile(filename);\n      const response = await fetch(`/api/admin/backup/download/${encodeURIComponent(filename)}`);\n      if (!response.ok) {\n        throw new Error('Failed to download file');\n      }\n      \n      const blob = await response.blob();\n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.style.display = 'none';\n      a.href = url;\n      a.download = filename;\n      document.body.appendChild(a);\n      a.click();\n      window.URL.revokeObjectURL(url);\n      document.body.removeChild(a);\n      \n      toast({\n        title: \"Success\",\n        description: `${filename} downloaded successfully`,\n      });\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to download file\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setDownloadingFile(null);\n    }\n  };\n\n  const downloadAll = async () => {\n    try {\n      setDownloadingAll(true);\n      const response = await fetch('/api/admin/backup/download-all');\n      if (!response.ok) {\n        throw new Error('Failed to download backup archive');\n      }\n      \n      const blob = await response.blob();\n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.style.display = 'none';\n      a.href = url;\n      \n      // Get filename from response headers or create one\n      const contentDisposition = response.headers.get('content-disposition');\n      const filename = contentDisposition \n        ? contentDisposition.split('filename=')[1]?.replace(/\"/g, '')\n        : `dexter-backup-${new Date().toISOString().replace(/[:.]/g, '-')}.json`;\n      \n      a.download = filename;\n      document.body.appendChild(a);\n      a.click();\n      window.URL.revokeObjectURL(url);\n      document.body.removeChild(a);\n      \n      toast({\n        title: \"Success\",\n        description: \"Complete backup archive downloaded successfully\",\n      });\n    } catch (error: any) {\n      toast({\n        title: \"Error\", \n        description: error.message || \"Failed to download backup archive\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setDownloadingAll(false);\n    }\n  };\n\n  const formatFileSize = (bytes: number) => {\n    if (bytes === 0) return '0 Bytes';\n    const k = 1024;\n    const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];\n  };\n\n  const getFileType = (filename: string) => {\n    if (filename.includes('admin')) return { type: 'Admin', color: 'bg-red-500/10 text-red-400 border-red-500/20' };\n    if (filename.includes('token')) return { type: 'Tokens', color: 'bg-blue-500/10 text-blue-400 border-blue-500/20' };\n    if (filename.includes('device')) return { type: 'Devices', color: 'bg-green-500/10 text-green-400 border-green-500/20' };\n    if (filename.includes('keys')) return { type: 'Keys', color: 'bg-yellow-500/10 text-yellow-400 border-yellow-500/20' };\n    if (filename.includes('reseller')) return { type: 'Resellers', color: 'bg-orange-500/10 text-orange-400 border-orange-500/20' };\n    return { type: 'User Data', color: 'bg-purple-500/10 text-purple-400 border-purple-500/20' };\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\n          <div>\n            <h1 className=\"text-2xl sm:text-3xl font-bold text-foreground\">Database Backup</h1>\n            <p className=\"text-muted-foreground mt-1\">Download MongoDB collections for backup and recovery</p>\n          </div>\n          <div className=\"flex flex-col sm:flex-row gap-2\">\n            <Button \n              onClick={fetchCollections} \n              variant=\"outline\"\n              disabled={loading}\n              className=\"bg-background/80 border-purple-500/20 hover:bg-purple-900/10\"\n            >\n              <RefreshCw className={`h-4 w-4 mr-2 ${loading ? 'animate-spin' : ''}`} />\n              Refresh\n            </Button>\n            <Button \n              onClick={downloadAll}\n              disabled={downloadingAll || collections.length === 0}\n              className=\"bg-purple-600 hover:bg-purple-700 text-white border-purple-500/20\"\n            >\n              <Archive className=\"h-4 w-4 mr-2\" />\n              {downloadingAll ? 'Downloading...' : 'Download All'}\n            </Button>\n          </div>\n        </div>\n\n      {/* Stats Cards */}\n      <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4\">\n        <Card className=\"bg-background/50 border-purple-500/20\">\n          <CardContent className=\"p-4\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"p-2 bg-purple-900/20 rounded-lg\">\n                <Database className=\"h-5 w-5 text-purple-400\" />\n              </div>\n              <div>\n                <p className=\"text-sm text-muted-foreground\">Collections</p>\n                <p className=\"text-2xl font-bold text-foreground\">{collections.length}</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n        \n        <Card className=\"bg-background/50 border-blue-500/20\">\n          <CardContent className=\"p-4\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"p-2 bg-blue-900/20 rounded-lg\">\n                <HardDrive className=\"h-5 w-5 text-blue-400\" />\n              </div>\n              <div>\n                <p className=\"text-sm text-muted-foreground\">Total Records</p>\n                <p className=\"text-2xl font-bold text-foreground\">\n                  {collections.reduce((acc, collection) => acc + collection.count, 0)}\n                </p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n        \n        <Card className=\"bg-background/50 border-green-500/20 sm:col-span-2 lg:col-span-1\">\n          <CardContent className=\"p-4\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"p-2 bg-green-900/20 rounded-lg\">\n                <Clock className=\"h-5 w-5 text-green-400\" />\n              </div>\n              <div>\n                <p className=\"text-sm text-muted-foreground\">Last Updated</p>\n                <p className=\"text-sm font-medium text-foreground\">\n                  {collections.length > 0 \n                    ? format(new Date(Math.max(...collections.map(c => new Date(c.modified).getTime()))), 'MMM dd, HH:mm')\n                    : 'N/A'\n                  }\n                </p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Files List */}\n      <Card className=\"bg-background/50 border-border\">\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Database className=\"h-5 w-5\" />\n            MongoDB Collections\n          </CardTitle>\n          <CardDescription>\n            Individual MongoDB collections available for download as JSON\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"p-0\">\n          {loading ? (\n            <div className=\"flex items-center justify-center py-12\">\n              <RefreshCw className=\"h-8 w-8 animate-spin text-purple-400\" />\n              <span className=\"ml-2 text-muted-foreground\">Loading files...</span>\n            </div>\n          ) : collections.length === 0 ? (\n            <div className=\"flex flex-col items-center justify-center py-12 text-center\">\n              <AlertCircle className=\"h-12 w-12 text-muted-foreground mb-4\" />\n              <h3 className=\"text-lg font-medium text-foreground mb-2\">No Collections Found</h3>\n              <p className=\"text-sm text-muted-foreground max-w-md\">\n                There are no MongoDB collections available for backup. This might indicate an issue with the database connection.\n              </p>\n            </div>\n          ) : (\n            <div className=\"space-y-1\">\n              {collections.map((collection, index) => {\n                const fileInfo = getFileType(collection.name);\n                return (\n                  <div\n                    key={collection.name}\n                    className={`flex flex-col sm:flex-row sm:items-center justify-between p-4 hover:bg-background/80 transition-colors ${\n                      index !== collections.length - 1 ? 'border-b border-border' : ''\n                    }`}\n                  >\n                    <div className=\"flex items-start sm:items-center gap-3 min-w-0 flex-1\">\n                      <div className=\"p-2 bg-purple-900/10 rounded-lg flex-shrink-0\">\n                        <FileText className=\"h-4 w-4 text-purple-400\" />\n                      </div>\n                      <div className=\"min-w-0 flex-1\">\n                        <div className=\"flex items-center gap-2 mb-1\">\n                          <p className=\"font-medium text-foreground truncate\">{collection.name}</p>\n                          <Badge variant=\"outline\" className={`text-xs flex-shrink-0 ${fileInfo.color}`}>\n                            {fileInfo.type}\n                          </Badge>\n                        </div>\n                        <div className=\"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-4 text-xs text-muted-foreground\">\n                          <span>{collection.count} records</span>\n                          <span className=\"hidden sm:inline\">•</span>\n                          <span>~{formatFileSize(collection.size)}</span>\n                          <span className=\"hidden sm:inline\">•</span>\n                          <span>Modified {format(new Date(collection.modified), 'MMM dd, yyyy HH:mm')}</span>\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"mt-3 sm:mt-0 sm:ml-4\">\n                      <Button\n                        size=\"sm\"\n                        onClick={() => downloadFile(collection.name)}\n                        disabled={downloadingFile === collection.name}\n                        className=\"w-full sm:w-auto bg-background border-purple-500/20 hover:bg-purple-900/10 text-purple-400\"\n                        variant=\"outline\"\n                      >\n                        <Download className=\"h-3 w-3 mr-2\" />\n                        {downloadingFile === collection.name ? 'Downloading...' : 'Download'}\n                      </Button>\n                    </div>\n                  </div>\n                );\n              })}\n            </div>\n          )}\n        </CardContent>\n      </Card>\n      </div>\n    </AdminLayout>\n  );\n}","size_bytes":12366},"client/src/pages/admin/online-update.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport AdminLayout from \"@/layouts/admin-layout\";\nimport {\n  Card,\n  CardContent,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Label } from \"@/components/ui/label\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport {\n  Drawer,\n  DrawerContent,\n  DrawerHeader,\n  DrawerTitle,\n  DrawerTrigger,\n} from \"@/components/ui/drawer\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { \n  Plus, \n  Edit, \n  Trash2, \n  Link as LinkIcon,\n  MessageSquare,\n  Eye,\n  EyeOff,\n  Calendar,\n  Smartphone\n} from \"lucide-react\";\nimport { formatDate } from \"@/lib/utils\";\nimport { toast } from \"@/hooks/use-toast\";\nimport { useIsMobile } from \"@/hooks/use-mobile\";\n\ninterface OnlineUpdate {\n  id: number;\n  title: string;\n  message: string;\n  buttonText?: string;\n  linkUrl?: string;\n  isActive: boolean;\n  createdAt: string;\n  updatedAt: string;\n}\n\ninterface UpdateFormData {\n  title: string;\n  message: string;\n  buttonText: string;\n  linkUrl: string;\n  isActive: boolean;\n}\n\nfunction UpdateForm({ \n  initialData, \n  onSubmit, \n  onCancel, \n  isLoading \n}: {\n  initialData?: OnlineUpdate;\n  onSubmit: (data: UpdateFormData) => void;\n  onCancel: () => void;\n  isLoading: boolean;\n}) {\n  const [formData, setFormData] = useState<UpdateFormData>({\n    title: initialData?.title || \"\",\n    message: initialData?.message || \"\",\n    buttonText: initialData?.buttonText || \"\",\n    linkUrl: initialData?.linkUrl || \"\",\n    isActive: initialData?.isActive ?? true,\n  });\n\n  const [errors, setErrors] = useState<Record<string, string>>({});\n\n  const validateForm = () => {\n    const newErrors: Record<string, string> = {};\n    \n    if (!formData.title.trim()) {\n      newErrors.title = \"Title is required\";\n    } else if (formData.title.length > 100) {\n      newErrors.title = \"Title must be less than 100 characters\";\n    }\n    \n    if (!formData.message.trim()) {\n      newErrors.message = \"Message is required\";\n    } else if (formData.message.length > 500) {\n      newErrors.message = \"Message must be less than 500 characters\";\n    }\n    \n    if (formData.buttonText && !formData.linkUrl) {\n      newErrors.linkUrl = \"Link URL is required when button text is provided\";\n    }\n    \n    if (formData.linkUrl && formData.linkUrl.trim()) {\n      try {\n        new URL(formData.linkUrl);\n      } catch {\n        newErrors.linkUrl = \"Please enter a valid URL\";\n      }\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (validateForm()) {\n      onSubmit(formData);\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit} className=\"space-y-3\">\n      <div className=\"space-y-1\">\n        <Label htmlFor=\"title\" className=\"text-sm\">Title</Label>\n        <Input\n          id=\"title\"\n          value={formData.title}\n          onChange={(e) => setFormData(prev => ({ ...prev, title: e.target.value }))}\n          placeholder=\"Update title\"\n          className={`h-9 ${errors.title ? \"border-red-500\" : \"\"}`}\n          data-testid=\"input-title\"\n        />\n        {errors.title && <p className=\"text-xs text-red-500\">{errors.title}</p>}\n      </div>\n\n      <div className=\"space-y-1\">\n        <Label htmlFor=\"message\" className=\"text-sm\">Message</Label>\n        <Textarea\n          id=\"message\"\n          value={formData.message}\n          onChange={(e) => setFormData(prev => ({ ...prev, message: e.target.value }))}\n          placeholder=\"Update message content\"\n          rows={2}\n          className={`resize-none ${errors.message ? \"border-red-500\" : \"\"}`}\n          data-testid=\"input-message\"\n        />\n        <div className=\"flex justify-between text-xs text-muted-foreground\">\n          {errors.message && <span className=\"text-red-500\">{errors.message}</span>}\n          <span className=\"ml-auto\">{formData.message.length}/500</span>\n        </div>\n      </div>\n\n      <div className=\"space-y-1\">\n        <Label htmlFor=\"buttonText\" className=\"text-sm\">Button Text (Optional)</Label>\n        <Input\n          id=\"buttonText\"\n          value={formData.buttonText}\n          onChange={(e) => setFormData(prev => ({ ...prev, buttonText: e.target.value }))}\n          placeholder=\"e.g., Download, Update Now\"\n          className=\"h-9\"\n          data-testid=\"input-button-text\"\n        />\n      </div>\n\n      <div className=\"space-y-1\">\n        <Label htmlFor=\"linkUrl\" className=\"text-sm\">Link URL {formData.buttonText && \"(Required)\"}</Label>\n        <Input\n          id=\"linkUrl\"\n          type=\"url\"\n          value={formData.linkUrl}\n          onChange={(e) => setFormData(prev => ({ ...prev, linkUrl: e.target.value }))}\n          placeholder=\"https://example.com/download\"\n          className={`h-9 ${errors.linkUrl ? \"border-red-500\" : \"\"}`}\n          data-testid=\"input-link-url\"\n        />\n        {errors.linkUrl && <p className=\"text-xs text-red-500\">{errors.linkUrl}</p>}\n      </div>\n\n      <div className=\"flex items-center space-x-2 py-1\">\n        <Switch\n          id=\"isActive\"\n          checked={formData.isActive}\n          onCheckedChange={(checked) => setFormData(prev => ({ ...prev, isActive: checked }))}\n          data-testid=\"switch-active\"\n        />\n        <Label htmlFor=\"isActive\" className=\"text-sm\">Active (visible to apps)</Label>\n      </div>\n\n      <div className=\"flex justify-end space-x-2 pt-2\">\n        <Button type=\"button\" variant=\"outline\" onClick={onCancel} className=\"h-9\" data-testid=\"button-cancel\">\n          Cancel\n        </Button>\n        <Button type=\"submit\" disabled={isLoading} className=\"h-9\" data-testid=\"button-submit\">\n          {isLoading ? \"Saving...\" : initialData ? \"Update\" : \"Create\"}\n        </Button>\n      </div>\n    </form>\n  );\n}\n\nexport default function AdminOnlineUpdate() {\n  const [isCreateModalOpen, setIsCreateModalOpen] = useState(false);\n  const [editingUpdate, setEditingUpdate] = useState<OnlineUpdate | null>(null);\n  const queryClient = useQueryClient();\n  const isMobile = useIsMobile();\n\n  // Fetch all online updates\n  const { data: updates, isLoading } = useQuery<OnlineUpdate[]>({\n    queryKey: ['/api/admin/online-updates'],\n  });\n\n  // Create update mutation\n  const createMutation = useMutation({\n    mutationFn: async (data: UpdateFormData) => {\n      const response = await fetch('/api/admin/online-updates', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        credentials: 'include',\n        body: JSON.stringify(data),\n      });\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.message || 'Failed to create update');\n      }\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/admin/online-updates'] });\n      setIsCreateModalOpen(false);\n      toast({\n        title: \"Success\",\n        description: \"Update created successfully!\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Update update mutation\n  const updateMutation = useMutation({\n    mutationFn: async ({ id, data }: { id: number; data: UpdateFormData }) => {\n      const response = await fetch(`/api/admin/online-updates/${id}`, {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        credentials: 'include',\n        body: JSON.stringify(data),\n      });\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.message || 'Failed to update');\n      }\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/admin/online-updates'] });\n      setEditingUpdate(null);\n      toast({\n        title: \"Success\",\n        description: \"Update saved successfully!\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Delete update mutation\n  const deleteMutation = useMutation({\n    mutationFn: async (id: number) => {\n      const response = await fetch(`/api/admin/online-updates/${id}`, {\n        method: 'DELETE',\n        credentials: 'include',\n      });\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.message || 'Failed to delete update');\n      }\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/admin/online-updates'] });\n      toast({\n        title: \"Success\",\n        description: \"Update deleted successfully!\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleDelete = (update: OnlineUpdate) => {\n    if (window.confirm(`Are you sure you want to delete \"${update.title}\"?`)) {\n      deleteMutation.mutate(update.id);\n    }\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex justify-between items-start\">\n          <div className=\"space-y-2\">\n            <h2 className=\"text-2xl font-bold bg-gradient-to-r from-purple-500 to-indigo-600 bg-clip-text text-transparent\">\n              Online Updates\n            </h2>\n            <p className=\"text-muted-foreground text-sm\">\n              Send real-time updates to your apps with messages, links, and buttons\n            </p>\n          </div>\n          \n          {isMobile ? (\n            <Drawer open={isCreateModalOpen} onOpenChange={setIsCreateModalOpen}>\n              <DrawerTrigger asChild>\n                <Button className=\"bg-purple-600 hover:bg-purple-700\" data-testid=\"button-create-update\">\n                  <Plus className=\"h-4 w-4 mr-2\" />\n                  Create Update\n                </Button>\n              </DrawerTrigger>\n              <DrawerContent className=\"flex flex-col max-h-[50vh] min-h-[40vh]\">\n                <DrawerHeader className=\"px-4 pb-2\">\n                  <DrawerTitle>Create New Update</DrawerTitle>\n                </DrawerHeader>\n                <div className=\"px-4 pb-4 flex-1 overflow-y-auto\">\n                  <UpdateForm\n                    onSubmit={(data) => createMutation.mutate(data)}\n                    onCancel={() => setIsCreateModalOpen(false)}\n                    isLoading={createMutation.isPending}\n                  />\n                </div>\n              </DrawerContent>\n            </Drawer>\n          ) : (\n            <Dialog open={isCreateModalOpen} onOpenChange={setIsCreateModalOpen}>\n              <DialogTrigger asChild>\n                <Button className=\"bg-purple-600 hover:bg-purple-700\" data-testid=\"button-create-update\">\n                  <Plus className=\"h-4 w-4 mr-2\" />\n                  Create Update\n                </Button>\n              </DialogTrigger>\n              <DialogContent className=\"sm:max-w-[500px]\">\n                <DialogHeader>\n                  <DialogTitle>Create New Update</DialogTitle>\n                  <DialogDescription>\n                    Create a new online update that will be sent to your apps with messages, links, and buttons.\n                  </DialogDescription>\n                </DialogHeader>\n                <UpdateForm\n                  onSubmit={(data) => createMutation.mutate(data)}\n                  onCancel={() => setIsCreateModalOpen(false)}\n                  isLoading={createMutation.isPending}\n                />\n              </DialogContent>\n            </Dialog>\n          )}\n        </div>\n\n        {/* API Information */}\n        <Card className=\"border border-blue-500/20 bg-blue-900/5\">\n          <CardHeader className=\"pb-3\">\n            <CardTitle className=\"text-sm text-blue-400 flex items-center\">\n              <Smartphone className=\"h-4 w-4 mr-2\" />\n              App Integration\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"bg-muted/50 rounded-md p-3\">\n              <p className=\"text-sm text-muted-foreground mb-2\">\n                Apps can fetch active updates using:\n              </p>\n              <code className=\"text-xs bg-background px-2 py-1 rounded font-mono\">\n                GET /api/updates\n              </code>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Updates List */}\n        <div className=\"space-y-4\">\n          {isLoading ? (\n            <div className=\"grid gap-4\">\n              {[...Array(3)].map((_, i) => (\n                <Card key={i} className=\"animate-pulse\">\n                  <CardContent className=\"p-6\">\n                    <div className=\"h-4 bg-muted rounded w-1/3 mb-2\"></div>\n                    <div className=\"h-3 bg-muted rounded w-2/3 mb-4\"></div>\n                    <div className=\"h-8 bg-muted rounded w-20\"></div>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          ) : updates && updates.length > 0 ? (\n            <div className=\"grid gap-4\">\n              {updates.map((update) => (\n                <Card \n                  key={update.id} \n                  className={`border transition-all ${\n                    update.isActive \n                      ? 'border-green-500/20 bg-green-900/5' \n                      : 'border-gray-500/20 bg-gray-900/5'\n                  }`}\n                >\n                  <CardHeader className=\"pb-3\">\n                    <div className=\"flex justify-between items-start\">\n                      <div className=\"space-y-2\">\n                        <div className=\"flex items-center gap-2\">\n                          <CardTitle className=\"text-base\">{update.title}</CardTitle>\n                          <Badge \n                            variant={update.isActive ? \"default\" : \"secondary\"}\n                            className={update.isActive ? \"bg-green-600 hover:bg-green-700\" : \"\"}\n                          >\n                            {update.isActive ? (\n                              <>\n                                <Eye className=\"h-3 w-3 mr-1\" />\n                                Active\n                              </>\n                            ) : (\n                              <>\n                                <EyeOff className=\"h-3 w-3 mr-1\" />\n                                Inactive\n                              </>\n                            )}\n                          </Badge>\n                        </div>\n                        <p className=\"text-sm text-muted-foreground flex items-start gap-2\">\n                          <MessageSquare className=\"h-4 w-4 mt-0.5 flex-shrink-0\" />\n                          {update.message}\n                        </p>\n                        {update.buttonText && update.linkUrl && (\n                          <div className=\"flex items-center gap-2 text-xs text-purple-400\">\n                            <LinkIcon className=\"h-3 w-3\" />\n                            Button: \"{update.buttonText}\" → {update.linkUrl}\n                          </div>\n                        )}\n                        <div className=\"flex items-center gap-4 text-xs text-muted-foreground\">\n                          <div className=\"flex items-center gap-1\">\n                            <Calendar className=\"h-3 w-3\" />\n                            Created {formatDate(update.createdAt)}\n                          </div>\n                          {update.updatedAt !== update.createdAt && (\n                            <div>\n                              Updated {formatDate(update.updatedAt)}\n                            </div>\n                          )}\n                        </div>\n                      </div>\n                      \n                      <div className=\"flex gap-2\">\n                        {isMobile ? (\n                          <Drawer \n                            open={editingUpdate?.id === update.id} \n                            onOpenChange={(open) => !open && setEditingUpdate(null)}\n                          >\n                            <DrawerTrigger asChild>\n                              <Button \n                                variant=\"outline\" \n                                size=\"sm\"\n                                onClick={() => setEditingUpdate(update)}\n                                data-testid={`button-edit-update-${update.id}`}\n                              >\n                                <Edit className=\"h-4 w-4\" />\n                              </Button>\n                            </DrawerTrigger>\n                            <DrawerContent className=\"flex flex-col max-h-[50vh] min-h-[40vh]\">\n                              <DrawerHeader className=\"px-4 pb-2\">\n                                <DrawerTitle>Edit Update</DrawerTitle>\n                              </DrawerHeader>\n                              <div className=\"px-4 pb-4 flex-1 overflow-y-auto\">\n                                <UpdateForm\n                                  initialData={update}\n                                  onSubmit={(data) => updateMutation.mutate({ id: update.id, data })}\n                                  onCancel={() => setEditingUpdate(null)}\n                                  isLoading={updateMutation.isPending}\n                                />\n                              </div>\n                            </DrawerContent>\n                          </Drawer>\n                        ) : (\n                          <Dialog \n                            open={editingUpdate?.id === update.id} \n                            onOpenChange={(open) => !open && setEditingUpdate(null)}\n                          >\n                            <DialogTrigger asChild>\n                              <Button \n                                variant=\"outline\" \n                                size=\"sm\"\n                                onClick={() => setEditingUpdate(update)}\n                                data-testid={`button-edit-update-${update.id}`}\n                              >\n                                <Edit className=\"h-4 w-4\" />\n                              </Button>\n                            </DialogTrigger>\n                            <DialogContent className=\"sm:max-w-[500px]\">\n                              <DialogHeader>\n                                <DialogTitle>Edit Update</DialogTitle>\n                                <DialogDescription>\n                                  Modify the existing update details including title, message, button text and link URL.\n                                </DialogDescription>\n                              </DialogHeader>\n                              <UpdateForm\n                                initialData={update}\n                                onSubmit={(data) => updateMutation.mutate({ id: update.id, data })}\n                                onCancel={() => setEditingUpdate(null)}\n                                isLoading={updateMutation.isPending}\n                              />\n                            </DialogContent>\n                          </Dialog>\n                        )}\n                        \n                        <Button \n                          variant=\"outline\" \n                          size=\"sm\"\n                          onClick={() => handleDelete(update)}\n                          disabled={deleteMutation.isPending}\n                          className=\"text-red-500 hover:text-red-400\"\n                        >\n                          <Trash2 className=\"h-4 w-4\" />\n                        </Button>\n                      </div>\n                    </div>\n                  </CardHeader>\n                </Card>\n              ))}\n            </div>\n          ) : (\n            <Card className=\"border border-purple-500/20\">\n              <CardContent className=\"py-12\">\n                <div className=\"text-center space-y-4\">\n                  <div className=\"bg-purple-900/30 w-16 h-16 rounded-full mx-auto flex items-center justify-center\">\n                    <MessageSquare className=\"h-8 w-8 text-purple-400\" />\n                  </div>\n                  <div>\n                    <h3 className=\"text-lg font-medium\">No updates yet</h3>\n                    <p className=\"text-sm text-muted-foreground mt-1\">\n                      Create your first update to send messages to your apps\n                    </p>\n                  </div>\n                  <Button \n                    onClick={() => setIsCreateModalOpen(true)}\n                    className=\"bg-purple-600 hover:bg-purple-700\"\n                  >\n                    <Plus className=\"h-4 w-4 mr-2\" />\n                    Create First Update\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          )}\n        </div>\n      </div>\n    </AdminLayout>\n  );\n}","size_bytes":21284},"client/src/pages/admin/reseller-keys.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useLocation, useRoute } from \"wouter\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport AdminLayout from \"@/layouts/admin-layout\";\nimport {\n  Card,\n  CardContent,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { formatDate, getStatusColor } from \"@/lib/utils\";\nimport {\n  ArrowLeft,\n  Trash2,\n  Shield,\n  Calendar,\n  Clock,\n  Smartphone,\n  Copy,\n  Check,\n  AlertTriangle,\n} from \"lucide-react\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\n\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\";\n\nexport default function ResellerKeys() {\n  const [match, params] = useRoute(\"/admin/resellers/:id/keys\");\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  const [deleteDialogOpen, setDeleteDialogOpen] = useState(false);\n  const [selectedKey, setSelectedKey] = useState<any>(null);\n  const [isCopied, setIsCopied] = useState(false);\n  const [reseller, setReseller] = useState<any>(null);\n\n  // Fetch reseller data\n  const { data: resellers } = useQuery({\n    queryKey: ['/api/admin/resellers'],\n  });\n\n  // Find the current reseller\n  useEffect(() => {\n    if (resellers && params?.id) {\n      const resellerId = parseInt(params.id);\n      const currentReseller = resellers.find(r => r.id === resellerId);\n      setReseller(currentReseller);\n    }\n  }, [resellers, params]);\n\n  // Fetch keys for this reseller\n  const { data: keys, isLoading, refetch } = useQuery({\n    queryKey: ['/api/admin/resellers', params?.id, 'keys'],\n    queryFn: async () => {\n      const response = await apiRequest(\"GET\", `/api/admin/resellers/${params?.id}/keys`);\n      return response.json();\n    },\n    enabled: !!params?.id\n  });\n\n  // Delete/revoke key mutation\n  const revokeKeyMutation = useMutation({\n    mutationFn: async (keyId: number) => {\n      const response = await apiRequest(\"DELETE\", `/api/admin/keys/${keyId}`);\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/admin/resellers', params?.id, 'keys'] });\n      toast({\n        title: \"Key Revoked\",\n        description: \"The key has been successfully revoked\",\n      });\n      setDeleteDialogOpen(false);\n    },\n    onError: (error) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to revoke key\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleRevokeKey = (keyId: number) => {\n    revokeKeyMutation.mutate(keyId);\n  };\n\n  const openDeleteDialog = (key: any) => {\n    setSelectedKey(key);\n    setDeleteDialogOpen(true);\n  };\n\n  const copyKeyToClipboard = (keyString: string) => {\n    navigator.clipboard.writeText(keyString);\n    setIsCopied(true);\n    \n    toast({\n      title: \"Copied!\",\n      description: \"Key copied to clipboard\",\n    });\n    \n    setTimeout(() => {\n      setIsCopied(false);\n    }, 2000);\n  };\n\n  if (!match) {\n    return null;\n  }\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-2 mb-4\">\n        <div className=\"flex items-center gap-2\">\n          <Button \n            variant=\"ghost\" \n            size=\"icon\" \n            onClick={() => navigate(\"/admin/resellers\")}\n            className=\"h-8 w-8\"\n          >\n            <ArrowLeft className=\"h-4 w-4\" />\n          </Button>\n          <h2 className=\"text-2xl font-bold bg-gradient-to-r from-purple-500 to-indigo-600 bg-clip-text text-transparent\">\n            Manage Keys {reseller && `for ${reseller.username}`}\n          </h2>\n        </div>\n        <p className=\"text-muted-foreground text-sm\">View and manage all license keys for this reseller</p>\n      </div>\n\n      <Card className=\"overflow-hidden border border-purple-500/20 shadow-lg shadow-purple-500/5\">\n        <CardHeader className=\"px-6 py-4 border-b border-border bg-gradient-to-r from-purple-900/20 to-indigo-900/20 hidden sm:block\">\n          <CardTitle className=\"text-base font-medium bg-gradient-to-r from-purple-500 to-indigo-600 bg-clip-text text-transparent\">\n            License Keys\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"p-0\">\n          {/* Desktop Table View */}\n          <div className=\"hidden md:block overflow-x-auto\">\n            <table className=\"min-w-full divide-y divide-border\">\n              <thead className=\"bg-muted/50\">\n                <tr>\n                  <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                    License Key\n                  </th>\n                  <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                    Game\n                  </th>\n                  <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                    Created\n                  </th>\n                  <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                    Expires\n                  </th>\n                  <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                    Devices\n                  </th>\n                  <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                    Status\n                  </th>\n                  <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                    Actions\n                  </th>\n                </tr>\n              </thead>\n              <tbody className=\"divide-y divide-border\">\n                {isLoading ? (\n                  <tr>\n                    <td colSpan={7} className=\"px-6 py-4 text-center text-sm text-muted-foreground\">\n                      <div className=\"flex justify-center\">\n                        <div className=\"animate-spin h-5 w-5 border-t-2 border-purple-500 rounded-full\"></div>\n                      </div>\n                    </td>\n                  </tr>\n                ) : keys && keys.length > 0 ? (\n                  keys.map((key) => {\n                    const statusColor = getStatusColor(key.status);\n                    return (\n                      <tr key={key.id} className=\"hover:bg-purple-900/5\">\n                        <td className=\"px-6 py-4 whitespace-nowrap\">\n                          <div className=\"flex items-center\">\n                            <div className=\"text-sm font-medium font-mono\">\n                              <div className=\"flex items-center\">\n                                <span className=\"mr-2\">{key.keyString}</span>\n                                <TooltipProvider>\n                                  <Tooltip>\n                                    <TooltipTrigger asChild>\n                                      <Button\n                                        variant=\"ghost\"\n                                        size=\"icon\"\n                                        className=\"h-6 w-6\"\n                                        onClick={() => copyKeyToClipboard(key.keyString)}\n                                      >\n                                        {isCopied ? (\n                                          <Check className=\"h-3 w-3 text-green-500\" />\n                                        ) : (\n                                          <Copy className=\"h-3 w-3 text-muted-foreground\" />\n                                        )}\n                                      </Button>\n                                    </TooltipTrigger>\n                                    <TooltipContent>\n                                      <p>Copy key</p>\n                                    </TooltipContent>\n                                  </Tooltip>\n                                </TooltipProvider>\n                              </div>\n                            </div>\n                          </div>\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm text-muted-foreground\">\n                          <Badge variant=\"outline\" className=\"border-indigo-500 bg-indigo-500/10 text-indigo-500\">\n                            {key.game}\n                          </Badge>\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm text-muted-foreground\">\n                          {formatDate(key.createdAt)}\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm text-muted-foreground\">\n                          {formatDate(key.expiryDate)}\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap\">\n                          <div className=\"flex items-center\">\n                            <div className=\"text-sm text-muted-foreground\">\n                              {key.deviceCount} / {key.deviceLimit}\n                            </div>\n                          </div>\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap\">\n                          <Badge \n                            variant=\"outline\"\n                            className={`border-${statusColor.border} bg-${statusColor.bg} text-${statusColor.text}`}\n                          >\n                            {key.status}\n                          </Badge>\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium\">\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            className=\"border-red-500 bg-red-500/10 hover:bg-red-500/20 text-red-500\"\n                            onClick={() => openDeleteDialog(key)}\n                            disabled={key.isRevoked}\n                          >\n                            <Trash2 className=\"h-4 w-4 mr-1\" /> Revoke\n                          </Button>\n                        </td>\n                      </tr>\n                    );\n                  })\n                ) : (\n                  <tr>\n                    <td colSpan={7} className=\"px-6 py-4 text-center text-sm text-muted-foreground\">\n                      No keys found for this reseller\n                    </td>\n                  </tr>\n                )}\n              </tbody>\n            </table>\n          </div>\n          \n          {/* Mobile Card View */}\n          <div className=\"md:hidden space-y-4 p-4\">\n            {isLoading ? (\n              <div className=\"py-8 text-center\">\n                <div className=\"animate-spin h-8 w-8 border-t-2 border-purple-500 rounded-full mx-auto\"></div>\n                <p className=\"mt-3 text-muted-foreground\">Loading keys...</p>\n              </div>\n            ) : keys && keys.length > 0 ? (\n              keys.map((key) => {\n                const statusColor = getStatusColor(key.status);\n                return (\n                  <Card key={key.id} className=\"overflow-hidden border border-purple-500/20 shadow-sm\">\n                    <CardContent className=\"p-0\">\n                      <div className=\"flex items-center justify-between border-b border-border p-4\">\n                        <div>\n                          <div className=\"font-medium font-mono text-xs flex items-center\">\n                            <span className=\"mr-2\">{key.keyString}</span>\n                            <Button\n                              variant=\"ghost\"\n                              size=\"icon\"\n                              className=\"h-6 w-6\"\n                              onClick={() => copyKeyToClipboard(key.keyString)}\n                            >\n                              {isCopied ? (\n                                <Check className=\"h-3 w-3 text-green-500\" />\n                              ) : (\n                                <Copy className=\"h-3 w-3 text-muted-foreground\" />\n                              )}\n                            </Button>\n                          </div>\n                          <div className=\"text-xs text-muted-foreground mt-1\">\n                            <Badge variant=\"outline\" className=\"border-indigo-500 bg-indigo-500/10 text-indigo-500\">\n                              {key.game}\n                            </Badge>\n                          </div>\n                        </div>\n                        <Badge \n                          variant=\"outline\"\n                          className={`border-${statusColor.border} bg-${statusColor.bg} text-${statusColor.text}`}\n                        >\n                          {key.status}\n                        </Badge>\n                      </div>\n                      <div className=\"grid grid-cols-3 divide-x divide-border\">\n                        <div className=\"p-3 text-center\">\n                          <div className=\"text-xs text-muted-foreground flex flex-col items-center\">\n                            <Calendar className=\"h-3 w-3 mb-1\" />\n                            Created\n                          </div>\n                          <div className=\"font-medium text-xs\">\n                            {new Date(key.createdAt).toLocaleDateString()}\n                          </div>\n                        </div>\n                        <div className=\"p-3 text-center\">\n                          <div className=\"text-xs text-muted-foreground flex flex-col items-center\">\n                            <Clock className=\"h-3 w-3 mb-1\" />\n                            Expires\n                          </div>\n                          <div className=\"font-medium text-xs\">\n                            {new Date(key.expiryDate).toLocaleDateString()}\n                          </div>\n                        </div>\n                        <div className=\"p-3 text-center\">\n                          <div className=\"text-xs text-muted-foreground flex flex-col items-center\">\n                            <Smartphone className=\"h-3 w-3 mb-1\" />\n                            Devices\n                          </div>\n                          <div className=\"font-medium text-xs\">\n                            {key.deviceCount} / {key.deviceLimit}\n                          </div>\n                        </div>\n                      </div>\n                      <div className=\"p-3 border-t border-border\">\n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          className=\"w-full border-red-500 bg-red-500/10 hover:bg-red-500/20 text-red-500\"\n                          onClick={() => openDeleteDialog(key)}\n                          disabled={key.isRevoked}\n                        >\n                          <Trash2 className=\"h-4 w-4 mr-2\" /> Revoke Key\n                        </Button>\n                      </div>\n                    </CardContent>\n                  </Card>\n                );\n              })\n            ) : (\n              <div className=\"py-8 text-center text-muted-foreground\">\n                <p>No keys found for this reseller</p>\n              </div>\n            )}\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Delete confirmation dialog - Enhanced for better mobile support */}\n      <Dialog open={deleteDialogOpen} onOpenChange={setDeleteDialogOpen}>\n        <DialogContent className=\"sm:max-w-md mobile-dialog-content border border-purple-500/20\">\n          <div className=\"mobile-dialog-handle\"></div>\n          <DialogHeader>\n            <DialogTitle className=\"text-red-500 flex items-center\">\n              <AlertTriangle className=\"h-5 w-5 mr-2\" /> Revoke License Key\n            </DialogTitle>\n            <DialogDescription>\n              Are you sure you want to revoke this license key? This action cannot be undone and will immediately disable the key for all users.\n            </DialogDescription>\n          </DialogHeader>\n          \n          {selectedKey && (\n            <div className=\"bg-muted/30 p-3 rounded-md border border-border my-2\">\n              <div className=\"flex justify-between items-center\">\n                <div className=\"font-mono text-xs\">{selectedKey.keyString}</div>\n                <Badge variant=\"outline\" className=\"border-indigo-500 bg-indigo-500/10 text-indigo-500\">\n                  {selectedKey.game}\n                </Badge>\n              </div>\n              <div className=\"mt-2 grid grid-cols-2 gap-2 text-xs text-muted-foreground\">\n                <div className=\"flex items-center\">\n                  <Calendar className=\"h-3 w-3 mr-1\" /> Expires: {formatDate(selectedKey.expiryDate)}\n                </div>\n                <div className=\"flex items-center\">\n                  <Smartphone className=\"h-3 w-3 mr-1\" /> Devices: {selectedKey.deviceCount} / {selectedKey.deviceLimit}\n                </div>\n              </div>\n            </div>\n          )}\n          \n          <DialogFooter className=\"flex flex-col-reverse sm:flex-row sm:justify-end gap-2\">\n            <Button \n              variant=\"outline\" \n              onClick={() => setDeleteDialogOpen(false)}\n              className=\"sm:mt-0\"\n            >\n              Cancel\n            </Button>\n            <Button \n              variant=\"destructive\"\n              onClick={() => selectedKey && handleRevokeKey(selectedKey.id)}\n              disabled={revokeKeyMutation.isPending}\n              className=\"bg-red-600 hover:bg-red-700\"\n            >\n              {revokeKeyMutation.isPending ? (\n                <>\n                  <div className=\"animate-spin h-4 w-4 border-2 border-white rounded-full mr-2\"></div>\n                  Revoking...\n                </>\n              ) : (\n                <>\n                  <Trash2 className=\"h-4 w-4 mr-2\" /> Revoke Key\n                </>\n              )}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </AdminLayout>\n  );\n}","size_bytes":18399},"client/src/pages/admin/resellers.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport AdminLayout from \"@/layouts/admin-layout\";\nimport AddCreditModal from \"@/components/add-credit-modal\";\nimport {\n  Card,\n  CardContent,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { formatDate } from \"@/lib/utils\";\nimport { PlusCircle, Edit, Ban, Key } from \"lucide-react\";\n\nexport default function AdminResellers() {\n  const { toast } = useToast();\n  const [, navigate] = useLocation();\n  const [addCreditModalOpen, setAddCreditModalOpen] = useState(false);\n\n  // Fetch resellers\n  const { data: resellers = [], isLoading } = useQuery<any[]>({\n    queryKey: ['/api/admin/resellers'],\n  });\n\n  // Toggle reseller status mutation\n  const toggleStatusMutation = useMutation({\n    mutationFn: async ({ id, isActive }: { id: number; isActive: boolean }) => {\n      const response = await apiRequest(\n        \"POST\",\n        `/api/admin/resellers/${id}/toggle-status`,\n        { isActive }\n      );\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/admin/resellers'] });\n      toast({\n        title: \"Success\",\n        description: \"Reseller status updated successfully\",\n      });\n    },\n    onError: (error) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to update reseller status\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleToggleStatus = (id: number, currentStatus: boolean) => {\n    toggleStatusMutation.mutate({\n      id,\n      isActive: !currentStatus,\n    });\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-2 mb-4\">\n        <h2 className=\"text-2xl font-bold bg-gradient-to-r from-purple-500 to-indigo-600 bg-clip-text text-transparent\">Manage Resellers</h2>\n        <p className=\"text-muted-foreground text-sm\">Add credits or suspend reseller accounts</p>\n      </div>\n      \n      <div className=\"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-6\">\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 w-full sm:w-auto gap-2\">\n          <Button\n            onClick={() => setAddCreditModalOpen(true)}\n            className=\"bg-gradient-to-r from-purple-700 to-indigo-600 hover:from-purple-600 hover:to-indigo-500 text-white shadow-lg shadow-purple-900/20 border border-purple-500/20\"\n          >\n            <PlusCircle className=\"mr-2 h-4 w-4\" /> Add Credit\n          </Button>\n        </div>\n      </div>\n\n      <Card className=\"overflow-hidden border border-purple-500/20 shadow-lg shadow-purple-500/5\">\n        <CardHeader className=\"px-6 py-4 border-b border-border bg-gradient-to-r from-purple-900/20 to-indigo-900/20 hidden sm:block\">\n          <CardTitle className=\"text-base font-medium bg-gradient-to-r from-purple-500 to-indigo-600 bg-clip-text text-transparent\">Reseller Accounts</CardTitle>\n        </CardHeader>\n        <CardContent className=\"p-0\">\n          {/* Desktop Table View */}\n          <div className=\"hidden md:block overflow-x-auto\">\n            <table className=\"min-w-full divide-y divide-border\">\n              <thead className=\"bg-muted/50\">\n                <tr>\n                  <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                    Username\n                  </th>\n                  <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                    Registration Date\n                  </th>\n                  <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                    Credit Balance\n                  </th>\n                  <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                    Total Keys\n                  </th>\n                  <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                    Status\n                  </th>\n                  <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                    Actions\n                  </th>\n                </tr>\n              </thead>\n              <tbody className=\"divide-y divide-border\">\n                {isLoading ? (\n                  <tr>\n                    <td colSpan={6} className=\"px-6 py-4 text-center text-sm text-muted-foreground\">\n                      <div className=\"flex justify-center\">\n                        <div className=\"animate-spin h-5 w-5 border-t-2 border-purple-500 rounded-full\"></div>\n                      </div>\n                    </td>\n                  </tr>\n                ) : resellers.length > 0 ? (\n                  resellers.map((reseller) => (\n                    <tr key={reseller.id} className=\"hover:bg-purple-900/5\">\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\n                        <div className=\"flex items-center\">\n                          <div className=\"flex-shrink-0 h-8 w-8 bg-purple-900/30 rounded-full flex items-center justify-center border border-purple-500/20\">\n                            <span className=\"text-purple-400 font-medium\">\n                              {reseller.username.charAt(0).toUpperCase()}\n                            </span>\n                          </div>\n                          <div className=\"ml-3\">\n                            <div className=\"text-sm font-medium\">\n                              {reseller.username}\n                            </div>\n                          </div>\n                        </div>\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-muted-foreground\">\n                        {formatDate(reseller.registrationDate)}\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\n                        <div className=\"text-sm font-medium text-green-500\">\n                          {reseller.credits}\n                        </div>\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-muted-foreground\">\n                        {reseller.totalKeys || 0}\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\n                        <Badge \n                          variant={reseller.isActive ? \"outline\" : \"secondary\"}\n                          className={reseller.isActive ? \"border-green-500 bg-green-500/10 text-green-500\" : \"\"}\n                        >\n                          {reseller.isActive ? \"Active\" : \"Suspended\"}\n                        </Badge>\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium\">\n                        <div className=\"flex space-x-2\">\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            className=\"border-purple-500 bg-purple-500/10 hover:bg-purple-500/20 text-purple-500\"\n                            onClick={() => navigate(`/admin/resellers/${reseller.id}/keys`)}\n                          >\n                            <Key className=\"h-4 w-4 mr-1\" /> Keys\n                          </Button>\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            className={reseller.isActive \n                              ? \"border-red-500 bg-red-500/10 hover:bg-red-500/20 text-red-500\" \n                              : \"border-green-500 bg-green-500/10 hover:bg-green-500/20 text-green-500\"}\n                            onClick={() => handleToggleStatus(reseller.id, reseller.isActive)}\n                            disabled={toggleStatusMutation.isPending}\n                          >\n                            {reseller.isActive ? (\n                              <>\n                                <Ban className=\"h-4 w-4 mr-1\" /> Suspend\n                              </>\n                            ) : (\n                              \"Activate\"\n                            )}\n                          </Button>\n                        </div>\n                      </td>\n                    </tr>\n                  ))\n                ) : (\n                  <tr>\n                    <td colSpan={6} className=\"px-6 py-4 text-center text-sm text-muted-foreground\">\n                      No resellers found\n                    </td>\n                  </tr>\n                )}\n              </tbody>\n            </table>\n          </div>\n          \n          {/* Mobile Card View */}\n          <div className=\"md:hidden space-y-4 p-4\">\n            {isLoading ? (\n              <div className=\"py-8 text-center\">\n                <div className=\"animate-spin h-8 w-8 border-t-2 border-purple-500 rounded-full mx-auto\"></div>\n                <p className=\"mt-3 text-muted-foreground\">Loading resellers...</p>\n              </div>\n            ) : resellers.length > 0 ? (\n              resellers.map((reseller) => (\n                <Card key={reseller.id} className=\"overflow-hidden border border-purple-500/20 shadow-sm\">\n                  <CardContent className=\"p-0\">\n                    <div className=\"flex items-center border-b border-border p-4\">\n                      <div className=\"h-10 w-10 bg-purple-900/30 rounded-full flex items-center justify-center border border-purple-500/20 mr-3\">\n                        <span className=\"text-purple-400 font-medium\">\n                          {reseller.username.charAt(0).toUpperCase()}\n                        </span>\n                      </div>\n                      <div>\n                        <div className=\"font-medium\">{reseller.username}</div>\n                        <div className=\"text-xs text-muted-foreground\">Joined {formatDate(reseller.registrationDate)}</div>\n                      </div>\n                      <Badge \n                        variant={reseller.isActive ? \"outline\" : \"secondary\"}\n                        className={`ml-auto ${reseller.isActive ? \"border-green-500 bg-green-500/10 text-green-500\" : \"\"}`}\n                      >\n                        {reseller.isActive ? \"Active\" : \"Suspended\"}\n                      </Badge>\n                    </div>\n                    <div className=\"grid grid-cols-2 divide-x divide-border\">\n                      <div className=\"p-3 text-center\">\n                        <div className=\"text-xs text-muted-foreground\">Credits</div>\n                        <div className=\"font-medium text-green-500\">{reseller.credits}</div>\n                      </div>\n                      <div className=\"p-3 text-center\">\n                        <div className=\"text-xs text-muted-foreground\">Total Keys</div>\n                        <div className=\"font-medium\">{reseller.totalKeys || 0}</div>\n                      </div>\n                    </div>\n                    <div className=\"p-3 border-t border-border grid grid-cols-2 gap-2\">\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        className=\"border-purple-500 bg-purple-500/10 hover:bg-purple-500/20 text-purple-500\"\n                        onClick={() => navigate(`/admin/resellers/${reseller.id}/keys`)}\n                      >\n                        <Key className=\"h-4 w-4 mr-2\" /> View Keys\n                      </Button>\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        className={reseller.isActive \n                          ? \"border-red-500 bg-red-500/10 hover:bg-red-500/20 text-red-500\" \n                          : \"border-green-500 bg-green-500/10 hover:bg-green-500/20 text-green-500\"}\n                        onClick={() => handleToggleStatus(reseller.id, reseller.isActive)}\n                        disabled={toggleStatusMutation.isPending}\n                      >\n                        {reseller.isActive ? (\n                          <>\n                            <Ban className=\"h-4 w-4 mr-2\" /> Suspend\n                          </>\n                        ) : (\n                          \"Activate\"\n                        )}\n                      </Button>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))\n            ) : (\n              <div className=\"py-8 text-center text-muted-foreground\">\n                <p>No resellers found</p>\n              </div>\n            )}\n          </div>\n        </CardContent>\n      </Card>\n\n      <AddCreditModal\n        open={addCreditModalOpen}\n        onOpenChange={setAddCreditModalOpen}\n      />\n    </AdminLayout>\n  );\n}","size_bytes":13211},"client/src/pages/admin/tokens.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport AdminLayout from \"@/layouts/admin-layout\";\nimport GenerateTokenModal from \"@/components/generate-token-modal\";\nimport {\n  Card,\n  CardContent,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { formatDate } from \"@/lib/utils\";\nimport { PlusCircle, Copy, Check } from \"lucide-react\";\n\nexport default function AdminTokens() {\n  const [generateTokenModalOpen, setGenerateTokenModalOpen] = useState(false);\n  const [copiedTokenId, setCopiedTokenId] = useState<number | null>(null);\n  \n  // Fetch tokens\n  const { data: tokens, isLoading } = useQuery({\n    queryKey: ['/api/admin/tokens'],\n  });\n\n  const copyToClipboard = (text: string, id: number) => {\n    navigator.clipboard.writeText(text).then(() => {\n      setCopiedTokenId(id);\n      setTimeout(() => setCopiedTokenId(null), 2000);\n    });\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-2 mb-4\">\n        <h2 className=\"text-2xl font-bold bg-gradient-to-r from-purple-500 to-indigo-600 bg-clip-text text-transparent\">Referral Tokens</h2>\n        <p className=\"text-muted-foreground text-sm\">Generate and manage reseller invitation tokens</p>\n      </div>\n      \n      <div className=\"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-6\">\n        <div className=\"w-full sm:w-auto\">\n          <Button\n            onClick={() => setGenerateTokenModalOpen(true)}\n            className=\"w-full sm:w-auto bg-gradient-to-r from-purple-700 to-indigo-600 hover:from-purple-600 hover:to-indigo-500 text-white shadow-lg shadow-purple-900/20 border border-purple-500/20\"\n          >\n            <PlusCircle className=\"mr-2 h-4 w-4\" /> Generate New Token\n          </Button>\n        </div>\n      </div>\n\n      <Card className=\"overflow-hidden border border-purple-500/20 shadow-lg shadow-purple-500/5\">\n        <CardHeader className=\"px-6 py-4 border-b border-border bg-gradient-to-r from-purple-900/20 to-indigo-900/20 hidden sm:block\">\n          <CardTitle className=\"text-base font-medium bg-gradient-to-r from-purple-500 to-indigo-600 bg-clip-text text-transparent\">Available Tokens</CardTitle>\n        </CardHeader>\n        <CardContent className=\"p-0\">\n          {/* Desktop Table View */}\n          <div className=\"hidden md:block overflow-x-auto\">\n            <table className=\"min-w-full divide-y divide-border\">\n              <thead className=\"bg-muted/50\">\n                <tr>\n                  <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                    Token\n                  </th>\n                  <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                    Created Date\n                  </th>\n                  <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                    Used By\n                  </th>\n                  <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                    Credits\n                  </th>\n                  <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                    Status\n                  </th>\n                  <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                    Action\n                  </th>\n                </tr>\n              </thead>\n              <tbody className=\"divide-y divide-border\">\n                {isLoading ? (\n                  <tr>\n                    <td colSpan={6} className=\"px-6 py-4 text-center text-sm text-muted-foreground\">\n                      <div className=\"flex justify-center\">\n                        <div className=\"animate-spin h-5 w-5 border-t-2 border-purple-500 rounded-full\"></div>\n                      </div>\n                    </td>\n                  </tr>\n                ) : tokens && (tokens as any[]).length > 0 ? (\n                  (tokens as any[]).map((token: any) => (\n                    <tr key={token.id} className=\"hover:bg-purple-900/5\">\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\n                        <div className=\"text-sm font-mono bg-muted/30 p-1.5 rounded-md\">{token.token}</div>\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-muted-foreground\">\n                        {formatDate(token.createdAt)}\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm\">\n                        {token.usedBy ? (\n                          <span className=\"text-muted-foreground\">{token.usedBy}</span>\n                        ) : (\n                          <span className=\"text-muted-foreground/50\">-</span>\n                        )}\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm\">\n                        <span className={`font-medium ${token.credits > 0 ? 'text-green-500' : 'text-muted-foreground'}`}>\n                          {token.credits || 0}\n                        </span>\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\n                        <Badge \n                          variant={token.isUsed ? \"secondary\" : \"outline\"}\n                          className={!token.isUsed ? \"border-green-500 bg-green-500/10 text-green-500\" : \"\"}\n                        >\n                          {token.isUsed ? \"Used\" : \"Available\"}\n                        </Badge>\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium\">\n                        {!token.isUsed && (\n                          <Button\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            className=\"text-muted-foreground hover:text-foreground\"\n                            onClick={() => copyToClipboard(token.token, token.id)}\n                          >\n                            {copiedTokenId === token.id ? (\n                              <>\n                                <Check className=\"h-4 w-4 mr-1 text-green-500\" /> Copied!\n                              </>\n                            ) : (\n                              <>\n                                <Copy className=\"h-4 w-4 mr-1\" /> Copy\n                              </>\n                            )}\n                          </Button>\n                        )}\n                      </td>\n                    </tr>\n                  ))\n                ) : (\n                  <tr>\n                    <td colSpan={6} className=\"px-6 py-4 text-center text-sm text-muted-foreground\">\n                      No tokens found\n                    </td>\n                  </tr>\n                )}\n              </tbody>\n            </table>\n          </div>\n          \n          {/* Mobile Card View */}\n          <div className=\"md:hidden space-y-4 p-4\">\n            {isLoading ? (\n              <div className=\"py-8 text-center\">\n                <div className=\"animate-spin h-8 w-8 border-t-2 border-purple-500 rounded-full mx-auto\"></div>\n                <p className=\"mt-3 text-muted-foreground\">Loading tokens...</p>\n              </div>\n            ) : tokens && (tokens as any[]).length > 0 ? (\n              (tokens as any[]).map((token: any) => (\n                <Card key={token.id} className=\"overflow-hidden border border-purple-500/20 shadow-sm\">\n                  <CardContent className=\"p-0\">\n                    <div className=\"p-4 border-b border-border\">\n                      <div className=\"flex items-center justify-between mb-2\">\n                        <Badge \n                          variant={token.isUsed ? \"secondary\" : \"outline\"}\n                          className={!token.isUsed ? \"border-green-500 bg-green-500/10 text-green-500\" : \"\"}\n                        >\n                          {token.isUsed ? \"Used\" : \"Available\"}\n                        </Badge>\n                        <div className=\"text-xs text-muted-foreground\">\n                          {formatDate(token.createdAt)}\n                        </div>\n                      </div>\n                      {token.credits > 0 && (\n                        <div className=\"mb-2\">\n                          <span className=\"text-xs text-green-500 font-medium\">\n                            {token.credits} credits included\n                          </span>\n                        </div>\n                      )}\n                      <div className=\"bg-muted/30 p-2 rounded-md text-sm font-mono break-all\">\n                        {token.token}\n                      </div>\n                      {!token.isUsed && (\n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          className=\"w-full mt-3 text-muted-foreground\"\n                          onClick={() => copyToClipboard(token.token, token.id)}\n                        >\n                          {copiedTokenId === token.id ? (\n                            <>\n                              <Check className=\"h-4 w-4 mr-2 text-green-500\" /> Copied to clipboard\n                            </>\n                          ) : (\n                            <>\n                              <Copy className=\"h-4 w-4 mr-2\" /> Copy token\n                            </>\n                          )}\n                        </Button>\n                      )}\n                    </div>\n                    {token.usedBy && (\n                      <div className=\"p-3 bg-muted/10\">\n                        <div className=\"text-xs text-muted-foreground\">Used by</div>\n                        <div className=\"font-medium\">{token.usedBy}</div>\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n              ))\n            ) : (\n              <div className=\"py-8 text-center text-muted-foreground\">\n                <p>No tokens found</p>\n              </div>\n            )}\n          </div>\n        </CardContent>\n      </Card>\n\n      <GenerateTokenModal\n        open={generateTokenModalOpen}\n        onOpenChange={setGenerateTokenModalOpen}\n      />\n    </AdminLayout>\n  );\n}","size_bytes":10584},"client/src/pages/reseller/api.tsx":{"content":"import ResellerLayout from \"@/layouts/reseller-layout\";\nimport {\n  Card,\n  CardContent,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/card\";\nimport { CheckCircle, Webhook, Shield, CreditCard } from \"lucide-react\";\n\nexport default function ResellerApi() {\n  return (\n    <ResellerLayout>\n      <h2 className=\"text-2xl font-semibold mb-6\">API Reference</h2>\n      \n      <Card className=\"overflow-hidden mb-6\">\n        <CardHeader className=\"px-6 py-4 border-b border-gray-200\">\n          <CardTitle className=\"text-base font-medium\">Key Verification Endpoint</CardTitle>\n        </CardHeader>\n        <CardContent className=\"p-6\">\n          <h4 className=\"text-lg font-medium mb-2\">Request</h4>\n          <div className=\"bg-muted/40 p-4 rounded-md mb-4\">\n            <pre className=\"font-mono text-sm overflow-x-auto\">\n{`POST /api/verify\nContent-Type: application/json\n\n{\n  \"key\": \"YOUR_LICENSE_KEY\",\n  \"deviceId\": \"UNIQUE_DEVICE_IDENTIFIER\",\n  \"game\": \"GAME_NAME\"\n}`}\n            </pre>\n          </div>\n          \n          <h4 className=\"text-lg font-medium mb-2\">Response</h4>\n          <div className=\"bg-muted/40 p-4 rounded-md\">\n            <pre className=\"font-mono text-sm overflow-x-auto\">\n{`{\n  \"valid\": true,\n  \"expiry\": \"2023-12-31\",\n  \"deviceLimit\": 2,\n  \"currentDevices\": 1,\n  \"message\": \"License valid\"\n}`}\n            </pre>\n          </div>\n        </CardContent>\n      </Card>\n      \n      <Card className=\"overflow-hidden\">\n        <CardHeader className=\"px-6 py-4 border-b border-gray-200\">\n          <CardTitle className=\"text-base font-medium\">Integration Guide</CardTitle>\n        </CardHeader>\n        <CardContent className=\"p-6\">\n          <ol className=\"list-decimal pl-5 space-y-4\">\n            <li className=\"text-sm text-gray-800\">\n              <div className=\"flex items-start\">\n                <Shield className=\"h-5 w-5 text-primary mr-2 shrink-0 mt-0.5\" />\n                <div>\n                  <span className=\"font-medium block mb-1\">Generate a Unique Device ID</span>\n                  <p>Create a unique identifier for each device that won't change between app updates.\n                  This can be a combination of hardware IDs, device name, or other persistent identifiers.</p>\n                </div>\n              </div>\n            </li>\n            <li className=\"text-sm text-gray-800\">\n              <div className=\"flex items-start\">\n                <CreditCard className=\"h-5 w-5 text-primary mr-2 shrink-0 mt-0.5\" />\n                <div>\n                  <span className=\"font-medium block mb-1\">Store the License Key</span>\n                  <p>Securely store the license key in your application after validation.\n                  Consider encrypting the key or using a secure storage mechanism appropriate for the platform.</p>\n                </div>\n              </div>\n            </li>\n            <li className=\"text-sm text-gray-800\">\n              <div className=\"flex items-start\">\n                <Webhook className=\"h-5 w-5 text-primary mr-2 shrink-0 mt-0.5\" />\n                <div>\n                  <span className=\"font-medium block mb-1\">Implement Verification</span>\n                  <p>Add verification on app startup to ensure the license is still valid.\n                  Handle offline scenarios gracefully by allowing a certain time window between verifications.</p>\n                </div>\n              </div>\n            </li>\n            <li className=\"text-sm text-gray-800\">\n              <div className=\"flex items-start\">\n                <CheckCircle className=\"h-5 w-5 text-primary mr-2 shrink-0 mt-0.5\" />\n                <div>\n                  <span className=\"font-medium block mb-1\">Handle Errors</span>\n                  <p>Implement appropriate user messaging for invalid or expired licenses.\n                  Provide clear instructions for users to renew or troubleshoot their license issues.</p>\n                </div>\n              </div>\n            </li>\n          </ol>\n          \n          <div className=\"mt-8 p-4 bg-muted/30 rounded-lg border border-muted\">\n            <h5 className=\"font-medium mb-2\">Sample Implementation</h5>\n            <pre className=\"font-mono text-sm overflow-x-auto\">\n{`// Example JavaScript Implementation\nasync function verifyLicense(licenseKey, deviceId, game) {\n  try {\n    const response = await fetch('https://yourdomain.com/api/verify', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        key: licenseKey,\n        deviceId: deviceId,\n        game: game\n      }),\n    });\n    \n    const data = await response.json();\n    \n    if (data.valid) {\n      // License is valid, proceed with application\n      console.log('License valid until:', data.expiry);\n      return true;\n    } else {\n      // License invalid\n      console.error('License error:', data.message);\n      return false;\n    }\n  } catch (error) {\n    console.error('Verification error:', error);\n    return false;\n  }\n}`}\n            </pre>\n          </div>\n        </CardContent>\n      </Card>\n    </ResellerLayout>\n  );\n}\n","size_bytes":5105},"client/src/pages/reseller/dashboard.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport ResellerLayout from \"@/layouts/reseller-layout\";\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { formatDate } from \"@/lib/utils\";\nimport { Link } from \"wouter\";\nimport {\n  CreditCard,\n  Key,\n  Timer,\n  CalendarDays,\n  ChevronRight,\n  PlusCircle,\n  TrendingUp,\n  Gamepad2,\n  Star,\n  Wifi,\n  WifiOff,\n} from \"lucide-react\";\n\nexport default function ResellerDashboard() {\n\n  // Fetch reseller profile data\n  const { data: profile, isLoading: profileLoading } = useQuery({\n    queryKey: [\"/api/reseller/profile\"],\n  });\n\n  // Fetch keys data\n  const { data: keys, isLoading: keysLoading } = useQuery({\n    queryKey: [\"/api/reseller/keys\"],\n  });\n\n  // Get counts\n  const activeKeys = keys?.filter((key) => key.status === \"ACTIVE\")?.length || 0;\n  const expiredKeys = keys?.filter((key) => key.status === \"EXPIRED\" || key.status === \"REVOKED\")?.length || 0;\n\n  // Get five most recent keys\n  const recentKeys = keys\n    ?.sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime())\n    ?.slice(0, 5);\n\n  return (\n    <ResellerLayout>\n      <div className=\"space-y-2 mb-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h2 className=\"text-2xl font-bold bg-gradient-to-r from-purple-500 to-indigo-600 bg-clip-text text-transparent\">Reseller Dashboard</h2>\n            <p className=\"text-muted-foreground text-sm\">Manage your license keys and credits</p>\n          </div>\n        </div>\n      </div>\n\n      {/* Stats Cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6\">\n        <Card className=\"border border-purple-500/20 shadow-lg shadow-purple-500/5 overflow-hidden\">\n          <CardHeader className=\"pb-2\">\n            <CardDescription className=\"flex items-center\">\n              <CreditCard className=\"h-4 w-4 mr-1 text-purple-400\" /> Credits\n            </CardDescription>\n            <CardTitle className=\"text-2xl font-bold\">\n              {profileLoading ? (\n                <div className=\"h-8 w-16 animate-pulse bg-muted rounded\"></div>\n              ) : (\n                profile?.credits || 0\n              )}\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <p className=\"text-sm text-muted-foreground\">Available for key generation</p>\n          </CardContent>\n        </Card>\n\n        <Card className=\"border border-purple-500/20 shadow-lg shadow-purple-500/5 overflow-hidden\">\n          <CardHeader className=\"pb-2\">\n            <CardDescription className=\"flex items-center\">\n              <Key className=\"h-4 w-4 mr-1 text-purple-400\" /> Active Keys\n            </CardDescription>\n            <CardTitle className=\"text-2xl font-bold\">\n              {keysLoading ? (\n                <div className=\"h-8 w-16 animate-pulse bg-muted rounded\"></div>\n              ) : (\n                activeKeys\n              )}\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <p className=\"text-sm text-muted-foreground\">Currently valid licenses</p>\n          </CardContent>\n        </Card>\n\n        <Card className=\"border border-purple-500/20 shadow-lg shadow-purple-500/5 overflow-hidden\">\n          <CardHeader className=\"pb-2\">\n            <CardDescription className=\"flex items-center\">\n              <Timer className=\"h-4 w-4 mr-1 text-purple-400\" /> Expired Keys\n            </CardDescription>\n            <CardTitle className=\"text-2xl font-bold\">\n              {keysLoading ? (\n                <div className=\"h-8 w-16 animate-pulse bg-muted rounded\"></div>\n              ) : (\n                expiredKeys\n              )}\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <p className=\"text-sm text-muted-foreground\">Expired or revoked licenses</p>\n          </CardContent>\n        </Card>\n\n        <Card className=\"border border-purple-500/20 shadow-lg shadow-purple-500/5 overflow-hidden\">\n          <CardHeader className=\"pb-2\">\n            <CardDescription className=\"flex items-center\">\n              <CalendarDays className=\"h-4 w-4 mr-1 text-purple-400\" /> Member Since\n            </CardDescription>\n            <CardTitle className=\"text-2xl font-bold\">\n              {profileLoading ? (\n                <div className=\"h-8 w-32 animate-pulse bg-muted rounded\"></div>\n              ) : (\n                profile?.registrationDate ? formatDate(profile.registrationDate) : \"N/A\"\n              )}\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <p className=\"text-sm text-muted-foreground\">Account registration date</p>\n          </CardContent>\n        </Card>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        {/* Quick Actions Card */}\n        <Card className=\"border border-purple-500/20 shadow-lg shadow-purple-500/5 lg:col-span-1 overflow-hidden\">\n          <CardHeader className=\"px-6 py-4 border-b border-border bg-gradient-to-r from-purple-900/20 to-indigo-900/20\">\n            <CardTitle className=\"text-base font-medium bg-gradient-to-r from-purple-500 to-indigo-600 bg-clip-text text-transparent\">Quick Actions</CardTitle>\n          </CardHeader>\n          <CardContent className=\"p-4\">\n            <div className=\"space-y-2\">\n              <Link href=\"/reseller/generate\">\n                <Button\n                  variant=\"outline\"\n                  className=\"w-full justify-between text-left mb-2 hover:bg-purple-900/10 hover:text-purple-200 border-purple-500/20\"\n                >\n                  <div className=\"flex items-center\">\n                    <PlusCircle className=\"mr-2 h-4 w-4 text-purple-400\" />\n                    <span>Generate New Keys</span>\n                  </div>\n                  <ChevronRight className=\"h-4 w-4\" />\n                </Button>\n              </Link>\n              \n              <Link href=\"/reseller/keys\">\n                <Button\n                  variant=\"outline\"\n                  className=\"w-full justify-between text-left mb-2 hover:bg-purple-900/10 hover:text-purple-200 border-purple-500/20\"\n                >\n                  <div className=\"flex items-center\">\n                    <Key className=\"mr-2 h-4 w-4 text-purple-400\" />\n                    <span>Manage Keys</span>\n                  </div>\n                  <ChevronRight className=\"h-4 w-4\" />\n                </Button>\n              </Link>\n              \n              <Button\n                variant=\"outline\"\n                className=\"w-full justify-between text-left hover:bg-purple-900/10 hover:text-purple-200 border-purple-500/20\"\n                disabled\n              >\n                <div className=\"flex items-center\">\n                  <TrendingUp className=\"mr-2 h-4 w-4 text-purple-400\" />\n                  <span>View Sales Report</span>\n                </div>\n                <Badge variant=\"outline\" className=\"text-xs bg-purple-900/20 text-purple-300\">Coming Soon</Badge>\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Recent Activities Card */}\n        <Card className=\"border border-purple-500/20 shadow-lg shadow-purple-500/5 lg:col-span-2 overflow-hidden\">\n          <CardHeader className=\"px-6 py-4 border-b border-border bg-gradient-to-r from-purple-900/20 to-indigo-900/20\">\n            <CardTitle className=\"text-base font-medium bg-gradient-to-r from-purple-500 to-indigo-600 bg-clip-text text-transparent\">Recent Key Activities</CardTitle>\n          </CardHeader>\n          <CardContent className=\"p-0\">\n            {keysLoading ? (\n              <div className=\"p-8 text-center\">\n                <div className=\"animate-spin h-8 w-8 border-t-2 border-purple-500 rounded-full mx-auto\"></div>\n                <p className=\"mt-3 text-muted-foreground\">Loading recent activities...</p>\n              </div>\n            ) : recentKeys && recentKeys.length > 0 ? (\n              <div className=\"divide-y divide-border\">\n                {recentKeys.map((key) => (\n                  <div key={key.id} className=\"p-4 hover:bg-muted/30 transition-colors\">\n                    <div className=\"flex justify-between items-start mb-1\">\n                      <div className=\"flex items-center\">\n                        <Gamepad2 className=\"h-5 w-5 mr-2 text-purple-400\" />\n                        <div>\n                          <div className=\"font-medium\">{key.game}</div>\n                          <code className=\"text-xs font-mono text-muted-foreground\">{key.keyString}</code>\n                        </div>\n                      </div>\n                      <Badge \n                        variant=\"outline\"\n                        className={`\n                          ${key.status === \"ACTIVE\" ? \"bg-green-500/10 text-green-500\" : \n                          key.status === \"EXPIRED\" ? \"bg-red-500/10 text-red-500\" : \n                          \"bg-gray-500/10 text-gray-500\"}\n                        `}\n                      >\n                        {key.status}\n                      </Badge>\n                    </div>\n                    <div className=\"flex items-center justify-between text-xs text-muted-foreground mt-1\">\n                      <div>Created: {formatDate(key.createdAt)}</div>\n                      <div>Expires: {formatDate(key.expiryDate)}</div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            ) : (\n              <div className=\"p-6 text-center\">\n                <Star className=\"h-8 w-8 text-purple-400/50 mx-auto mb-3\" />\n                <h3 className=\"text-lg font-medium mb-1\">No Keys Generated Yet</h3>\n                <p className=\"text-muted-foreground text-sm mb-4\">Generate your first key to see activity here</p>\n                <Link href=\"/reseller/generate\">\n                  <Button className=\"bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700\">\n                    <PlusCircle className=\"h-4 w-4 mr-2\" /> Generate Keys\n                  </Button>\n                </Link>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n    </ResellerLayout>\n  );\n}","size_bytes":10348},"client/src/pages/reseller/generate.tsx":{"content":"import React, { useState } from \"react\";\nimport ResellerLayout from \"@/layouts/reseller-layout\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Form, FormControl, FormDescription, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { useForm } from \"react-hook-form\";\nimport { z } from \"zod\";\nimport { useMutation, useQuery } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { Alert, AlertDescription, AlertTitle } from \"@/components/ui/alert\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { Info } from \"lucide-react\";\nimport { generateRandomKey } from \"@/lib/utils\";\n\n// Define the form schema\nconst generateKeySchema = z.object({\n  game: z.string().min(1, \"Game selection is required\"),\n  deviceLimit: z.string().min(1, \"Device limit is required\"),\n  days: z.number().min(1, \"Must be at least 1 day\").default(30),\n  keyCount: z.number().min(1, \"Must generate at least 1 key\").default(1),\n  customKey: z.string().optional(),\n});\n\ntype GenerateKeyValues = z.infer<typeof generateKeySchema>;\n\nexport default function ResellerGenerate() {\n  const { toast } = useToast();\n  const [generatedKeys, setGeneratedKeys] = useState<string[]>([]);\n\n  // Fetch reseller profile\n  const { data: profile } = useQuery({\n    queryKey: ['/api/reseller/profile'],\n  });\n\n  const form = useForm<GenerateKeyValues>({\n    resolver: zodResolver(generateKeySchema),\n    defaultValues: {\n      game: \"\",\n      deviceLimit: \"1\",\n      days: 30,\n      keyCount: 1,\n      customKey: \"\",\n    },\n  });\n\n  // Generate key mutation\n  const generateKeyMutation = useMutation({\n    mutationFn: async (values: GenerateKeyValues) => {\n      try {\n        // Parse the device limit as a number\n        const deviceLimit = parseInt(values.deviceLimit);\n        \n        // Calculate expiry date based on days\n        const today = new Date();\n        const expiryDate = new Date();\n        expiryDate.setDate(today.getDate() + values.days);\n        \n        // Get user session for resellerId\n        const sessionResponse = await apiRequest(\"GET\", \"/api/auth/session\");\n        const sessionData = await sessionResponse.json();\n        \n        if (!sessionData.isAuthenticated || !sessionData.user || !sessionData.user.id) {\n          throw new Error(\"User session not found. Please log in again.\");\n        }\n        \n        const payload = {\n          game: values.game,\n          deviceLimit: deviceLimit,\n          expiryDate: expiryDate,\n          keyString: values.customKey || undefined,\n          count: values.keyCount,\n          resellerId: sessionData.user.id, // Add the resellerId from session\n        };\n        \n        console.log(\"Sending key generation payload:\", payload);\n        \n        const response = await apiRequest(\"POST\", \"/api/reseller/keys/generate\", payload);\n        if (!response.ok) {\n          const errorData = await response.json();\n          throw new Error(errorData.message || \"Failed to generate key\");\n        }\n        \n        const data = await response.json();\n        return data;\n      } catch (error: any) {\n        console.error(\"Key generation error:\", error);\n        throw new Error(error.message || \"Failed to generate key\");\n      }\n    },\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: ['/api/reseller/profile'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/reseller/keys'] });\n      \n      if (data.keys && data.keys.length > 0) {\n        setGeneratedKeys(data.keys.map((key: any) => key.keyString));\n        \n        toast({\n          title: \"Success\",\n          description: `Generated ${data.keys.length} key(s) successfully`,\n        });\n      }\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to generate keys\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  function onSubmit(values: GenerateKeyValues) {\n    generateKeyMutation.mutate(values);\n  }\n\n  const handleGenerateRandomKey = () => {\n    const game = form.getValues(\"game\");\n    if (!game) {\n      toast({\n        title: \"Error\",\n        description: \"Please select a game first\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    \n    const randomKey = generateRandomKey(game);\n    form.setValue(\"customKey\", randomKey);\n  };\n\n  const copyToClipboard = (text: string) => {\n    navigator.clipboard.writeText(text);\n    toast({\n      title: \"Copied\",\n      description: \"Key copied to clipboard\",\n    });\n  };\n\n  return (\n    <ResellerLayout>\n      <div className=\"space-y-2 mb-6\">\n        <h2 className=\"text-2xl font-bold bg-gradient-to-r from-purple-500 to-indigo-600 bg-clip-text text-transparent\">Generate New Keys</h2>\n        <p className=\"text-muted-foreground text-sm\">Create license keys for your customers</p>\n      </div>\n      \n      <Card className=\"border border-purple-500/20 shadow-lg shadow-purple-500/5 overflow-hidden\">\n        <CardHeader className=\"px-6 py-4 border-b border-border bg-gradient-to-r from-purple-900/20 to-indigo-900/20\">\n          <CardTitle className=\"text-base font-medium bg-gradient-to-r from-purple-500 to-indigo-600 bg-clip-text text-transparent\">Key Generation</CardTitle>\n        </CardHeader>\n        <CardContent className=\"p-4 sm:p-6\">\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n              <FormField\n                control={form.control}\n                name=\"game\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Select Game</FormLabel>\n                    <Select\n                      onValueChange={field.onChange}\n                      defaultValue={field.value}\n                    >\n                      <FormControl>\n                        <SelectTrigger>\n                          <SelectValue placeholder=\"Select a game\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        <SelectItem value=\"PUBG MOBILE\">PUBG MOBILE</SelectItem>\n                        <SelectItem value=\"LAST ISLAND OF SURVIVAL\">LAST ISLAND OF SURVIVAL</SelectItem>\n                        <SelectItem value=\"STANDOFF2\">STANDOFF2</SelectItem>\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"deviceLimit\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Device Limit</FormLabel>\n                    <Select\n                      onValueChange={field.onChange}\n                      defaultValue={field.value}\n                    >\n                      <FormControl>\n                        <SelectTrigger>\n                          <SelectValue placeholder=\"Select device limit\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        <SelectItem value=\"1\">1 Device</SelectItem>\n                        <SelectItem value=\"2\">2 Devices</SelectItem>\n                        <SelectItem value=\"100\">100 Devices (Unlimited)</SelectItem>\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"days\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Number of Days</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"number\"\n                        min=\"1\"\n                        max=\"365\"\n                        value={field.value.toString()}\n                        onChange={(e) => field.onChange(parseInt(e.target.value) || 30)}\n                        className=\"focus:border-purple-500 focus:ring-purple-500\"\n                      />\n                    </FormControl>\n                    <FormDescription>\n                      License will be valid for this many days from today\n                    </FormDescription>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n                <FormField\n                  control={form.control}\n                  name=\"keyCount\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Number of Keys</FormLabel>\n                      <FormControl>\n                        <Input\n                          type=\"number\"\n                          min=\"1\"\n                          max=\"100\"\n                          value={field.value.toString()}\n                          onChange={(e) => field.onChange(parseInt(e.target.value) || 1)}\n                          className=\"focus:border-purple-500 focus:ring-purple-500\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"customKey\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Custom Key (Optional)</FormLabel>\n                      <div className=\"flex space-x-2\">\n                        <FormControl>\n                          <Input\n                            placeholder=\"Leave empty for auto-generate\"\n                            {...field}\n                            className=\"focus:border-purple-500 focus:ring-purple-500\"\n                          />\n                        </FormControl>\n                        <Button\n                          type=\"button\"\n                          variant=\"outline\"\n                          onClick={handleGenerateRandomKey}\n                          className=\"border-purple-500/30 text-purple-300 hover:bg-purple-900/40\"\n                        >\n                          Random\n                        </Button>\n                      </div>\n                      <FormDescription>\n                        Custom key will be used only for the first key if generating multiple\n                      </FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <Alert className={`border ${(profile?.credits || 0) < form.watch(\"keyCount\") ? \"bg-red-900/30 text-red-100 border-red-500/30\" : \"bg-purple-900/30 text-purple-100 border-purple-500/30\"}`}>\n                <Info className={`h-4 w-4 ${(profile?.credits || 0) < form.watch(\"keyCount\") ? \"text-red-400\" : \"text-purple-400\"}`} />\n                <AlertTitle className={`font-bold ${(profile?.credits || 0) < form.watch(\"keyCount\") ? \"text-red-300\" : \"text-purple-300\"}`}>\n                  {(profile?.credits || 0) < form.watch(\"keyCount\") ? \"Insufficient Credits!\" : \"Cost Information\"}\n                </AlertTitle>\n                <AlertDescription className={`${(profile?.credits || 0) < form.watch(\"keyCount\") ? \"text-red-100\" : \"text-purple-100\"}`}>\n                  Cost per key: <span className=\"font-medium text-white\">1 credit</span>. You have{\" \"}\n                  <span className=\"font-medium text-white\">{profile?.credits || 0}</span> credits available.\n                  {(profile?.credits || 0) < form.watch(\"keyCount\") && (\n                    <div className=\"mt-2 text-red-200 font-medium\">\n                      You need {form.watch(\"keyCount\") - (profile?.credits || 0)} more credits to generate {form.watch(\"keyCount\")} key(s).\n                    </div>\n                  )}\n                </AlertDescription>\n              </Alert>\n\n              <Button\n                type=\"submit\"\n                className=\"w-full bg-purple-600 hover:bg-purple-700 text-white text-lg py-6 glow disabled:opacity-50 disabled:cursor-not-allowed\"\n                disabled={generateKeyMutation.isPending || (profile?.credits || 0) < form.watch(\"keyCount\")}\n              >\n                {generateKeyMutation.isPending\n                  ? \"Generating...\"\n                  : (profile?.credits || 0) < form.watch(\"keyCount\")\n                  ? \"❌ INSUFFICIENT CREDITS\"\n                  : \"✨ GENERATE KEYS ✨\"}\n              </Button>\n            </form>\n          </Form>\n\n          {generatedKeys.length > 0 && (\n            <div className=\"mt-6 p-4 border border-purple-500/30 rounded-md bg-gradient\">\n              <h3 className=\"text-lg font-medium mb-4 text-purple-300\">✨ Your Generated Keys:</h3>\n              <div className=\"space-y-3\">\n                {generatedKeys.map((key, index) => (\n                  <div key={index} className=\"flex flex-col sm:flex-row items-stretch sm:items-center gap-2\">\n                    <code className=\"flex-1 font-mono text-sm bg-purple-900/40 text-purple-100 p-3 rounded-md border border-purple-500/20\">\n                      {key}\n                    </code>\n                    <Button\n                      size=\"sm\"\n                      variant=\"outline\"\n                      className=\"border-purple-500/30 text-purple-300 hover:bg-purple-900/40 hover:text-purple-100\"\n                      onClick={() => copyToClipboard(key)}\n                    >\n                      Copy Key\n                    </Button>\n                  </div>\n                ))}\n              </div>\n              <p className=\"mt-4 text-xs text-purple-300 opacity-70\">Remember to keep your keys secure and share them only with trusted users.</p>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </ResellerLayout>\n  );\n}","size_bytes":14265},"client/src/pages/reseller/keys.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport ResellerLayout from \"@/layouts/reseller-layout\";\nimport KeyDetailsModal from \"@/components/key-details-modal\";\nimport {\n  Card,\n  CardContent,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { formatDate, getStatusColor } from \"@/lib/utils\";\nimport { Search, Eye, Trash2, Gamepad2, Calendar, CalendarClock, Smartphone } from \"lucide-react\";\n\nexport default function ResellerKeys() {\n  const { toast } = useToast();\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [gameFilter, setGameFilter] = useState(\"all\");\n  const [selectedKeyId, setSelectedKeyId] = useState<number | null>(null);\n  const [keyDetailsOpen, setKeyDetailsOpen] = useState(false);\n  const [revokeDialogOpen, setRevokeDialogOpen] = useState(false);\n  const [keyToRevoke, setKeyToRevoke] = useState<number | null>(null);\n\n  // Fetch keys\n  const { data: keys, isLoading } = useQuery({\n    queryKey: ['/api/reseller/keys'],\n  });\n\n  // Revoke key mutation\n  const revokeKeyMutation = useMutation({\n    mutationFn: async (keyId: number) => {\n      const response = await apiRequest(\n        \"POST\",\n        `/api/reseller/keys/${keyId}/revoke`,\n        {}\n      );\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/reseller/keys'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/reseller/profile'] });\n      toast({\n        title: \"Success\",\n        description: \"Key revoked successfully\",\n      });\n      setRevokeDialogOpen(false);\n    },\n    onError: (error) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to revoke key\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleViewKey = (keyId: number) => {\n    setSelectedKeyId(keyId);\n    setKeyDetailsOpen(true);\n  };\n\n  const handleRevokeKey = (keyId: number) => {\n    setKeyToRevoke(keyId);\n    setRevokeDialogOpen(true);\n  };\n\n  const confirmRevokeKey = () => {\n    if (keyToRevoke) {\n      revokeKeyMutation.mutate(keyToRevoke);\n    }\n  };\n\n  // Filter keys\n  const filteredKeys = keys?.filter((key) => {\n    // Filter by search term\n    const matchesSearch = searchTerm === \"\" || \n      key.keyString.toLowerCase().includes(searchTerm.toLowerCase());\n    \n    // Filter by game\n    const matchesGame = gameFilter === \"all\" || key.game === gameFilter;\n    \n    return matchesSearch && matchesGame;\n  });\n\n  return (\n    <ResellerLayout>\n      <div className=\"space-y-2 mb-4\">\n        <h2 className=\"text-2xl font-bold bg-gradient-to-r from-purple-500 to-indigo-600 bg-clip-text text-transparent\">Manage Keys</h2>\n        <p className=\"text-muted-foreground text-sm\">View and revoke your license keys</p>\n      </div>\n      \n      <div className=\"flex flex-col sm:flex-row gap-4 mb-6\">\n        <div className=\"relative flex-1\">\n          <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4\" />\n          <Input\n            type=\"text\"\n            placeholder=\"Search keys...\"\n            className=\"pl-9 pr-4 py-2 bg-background border-border\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n          />\n        </div>\n        <Select\n          value={gameFilter}\n          onValueChange={setGameFilter}\n        >\n          <SelectTrigger className=\"w-full sm:w-[180px] bg-background border-border\">\n            <SelectValue placeholder=\"All Games\" />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"all\">All Games</SelectItem>\n            <SelectItem value=\"PUBG MOBILE\">PUBG MOBILE</SelectItem>\n            <SelectItem value=\"LAST ISLAND OF SURVIVAL\">LAST ISLAND OF SURVIVAL</SelectItem>\n            <SelectItem value=\"STANDOFF2\">STANDOFF2</SelectItem>\n          </SelectContent>\n        </Select>\n      </div>\n\n      {/* Desktop View */}\n      <Card className=\"overflow-hidden border border-purple-500/20 shadow-lg shadow-purple-500/5 hidden md:block\">\n        <CardHeader className=\"px-6 py-4 border-b border-border bg-gradient-to-r from-purple-900/20 to-indigo-900/20\">\n          <CardTitle className=\"text-base font-medium bg-gradient-to-r from-purple-500 to-indigo-600 bg-clip-text text-transparent\">Your License Keys</CardTitle>\n        </CardHeader>\n        <CardContent className=\"p-0\">\n          <div className=\"overflow-x-auto\">\n            <table className=\"min-w-full divide-y divide-border\">\n              <thead className=\"bg-muted/50\">\n                <tr>\n                  <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                    Key\n                  </th>\n                  <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                    Game\n                  </th>\n                  <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                    Created\n                  </th>\n                  <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                    Expiry\n                  </th>\n                  <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                    Devices\n                  </th>\n                  <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                    Status\n                  </th>\n                  <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                    Actions\n                  </th>\n                </tr>\n              </thead>\n              <tbody className=\"divide-y divide-border\">\n                {isLoading ? (\n                  <tr>\n                    <td colSpan={7} className=\"px-6 py-4 text-center text-sm text-muted-foreground\">\n                      <div className=\"flex justify-center\">\n                        <div className=\"animate-spin h-5 w-5 border-t-2 border-purple-500 rounded-full\"></div>\n                      </div>\n                    </td>\n                  </tr>\n                ) : filteredKeys && filteredKeys.length > 0 ? (\n                  filteredKeys.map((key) => {\n                    const statusColor = getStatusColor(key.status);\n                    return (\n                      <tr key={key.id} className=\"hover:bg-muted/30\">\n                        <td className=\"px-6 py-4 whitespace-nowrap\">\n                          <div className=\"text-sm font-mono bg-muted/30 p-1.5 rounded\">\n                            {key.keyString.length > 20 \n                              ? `${key.keyString.substring(0, 20)}...` \n                              : key.keyString}\n                          </div>\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm text-muted-foreground\">\n                          {key.game}\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm text-muted-foreground\">\n                          {formatDate(key.createdAt)}\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm text-muted-foreground\">\n                          {formatDate(key.expiryDate)}\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm text-muted-foreground\">\n                          {key.devices}/{key.deviceLimit}\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap\">\n                          <Badge \n                            variant=\"outline\"\n                            className={`${statusColor.bg} ${statusColor.text}`}\n                          >\n                            {key.status}\n                          </Badge>\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium\">\n                          <div className=\"flex space-x-2\">\n                            <Button\n                              size=\"sm\"\n                              variant=\"outline\"\n                              className=\"border-blue-500/20 bg-blue-900/10 text-blue-500 hover:bg-blue-900/20\"\n                              onClick={() => handleViewKey(key.id)}\n                            >\n                              <Eye className=\"h-4 w-4 mr-1\" /> View\n                            </Button>\n                            {key.status === \"ACTIVE\" && (\n                              <Button\n                                size=\"sm\"\n                                variant=\"outline\"\n                                className=\"border-red-500/20 bg-red-900/10 text-red-500 hover:bg-red-900/20\"\n                                onClick={() => handleRevokeKey(key.id)}\n                              >\n                                <Trash2 className=\"h-4 w-4 mr-1\" /> Revoke\n                              </Button>\n                            )}\n                          </div>\n                        </td>\n                      </tr>\n                    );\n                  })\n                ) : (\n                  <tr>\n                    <td colSpan={7} className=\"px-6 py-4 text-center text-sm text-muted-foreground\">\n                      No keys found. {searchTerm || gameFilter !== \"all\" ? \"Try changing your search filters.\" : \"\"}\n                    </td>\n                  </tr>\n                )}\n              </tbody>\n            </table>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Mobile View */}\n      <div className=\"md:hidden space-y-4\">\n        {isLoading ? (\n          <div className=\"py-8 text-center\">\n            <div className=\"animate-spin h-8 w-8 border-t-2 border-purple-500 rounded-full mx-auto\"></div>\n            <p className=\"mt-3 text-muted-foreground\">Loading keys...</p>\n          </div>\n        ) : filteredKeys && filteredKeys.length > 0 ? (\n          filteredKeys.map((key) => {\n            const statusColor = getStatusColor(key.status);\n            return (\n              <Card key={key.id} className=\"overflow-hidden border border-purple-500/20 shadow-sm\">\n                <CardContent className=\"p-0\">\n                  <div className=\"flex items-center justify-between border-b border-border p-4\">\n                    <div className=\"bg-muted/30 px-3 py-2 rounded font-mono text-sm overflow-hidden text-ellipsis max-w-[160px]\">\n                      {key.keyString}\n                    </div>\n                    <Badge \n                      variant=\"outline\"\n                      className={`${statusColor.bg} ${statusColor.text}`}\n                    >\n                      {key.status}\n                    </Badge>\n                  </div>\n                  \n                  <div className=\"px-4 py-3 space-y-2 border-b border-border\">\n                    <div className=\"flex items-center text-sm\">\n                      <Gamepad2 className=\"h-4 w-4 mr-2 text-purple-400\" />\n                      <span className=\"text-muted-foreground\">Game:</span>\n                      <span className=\"ml-2 font-medium\">{key.game}</span>\n                    </div>\n                    <div className=\"flex items-center text-sm\">\n                      <Calendar className=\"h-4 w-4 mr-2 text-purple-400\" />\n                      <span className=\"text-muted-foreground\">Created:</span>\n                      <span className=\"ml-2\">{formatDate(key.createdAt)}</span>\n                    </div>\n                    <div className=\"flex items-center text-sm\">\n                      <CalendarClock className=\"h-4 w-4 mr-2 text-purple-400\" />\n                      <span className=\"text-muted-foreground\">Expires:</span>\n                      <span className=\"ml-2\">{formatDate(key.expiryDate)}</span>\n                    </div>\n                    <div className=\"flex items-center text-sm\">\n                      <Smartphone className=\"h-4 w-4 mr-2 text-purple-400\" />\n                      <span className=\"text-muted-foreground\">Devices:</span>\n                      <span className=\"ml-2\">{key.devices}/{key.deviceLimit}</span>\n                    </div>\n                  </div>\n                  \n                  <div className=\"flex p-3 gap-2\">\n                    <Button\n                      size=\"sm\"\n                      variant=\"outline\"\n                      className=\"flex-1 border-blue-500/20 bg-blue-900/10 text-blue-500 hover:bg-blue-900/20\"\n                      onClick={() => handleViewKey(key.id)}\n                    >\n                      <Eye className=\"h-4 w-4 mr-2\" /> View Details\n                    </Button>\n                    {key.status === \"ACTIVE\" && (\n                      <Button\n                        size=\"sm\"\n                        variant=\"outline\"\n                        className=\"flex-1 border-red-500/20 bg-red-900/10 text-red-500 hover:bg-red-900/20\"\n                        onClick={() => handleRevokeKey(key.id)}\n                      >\n                        <Trash2 className=\"h-4 w-4 mr-2\" /> Revoke\n                      </Button>\n                    )}\n                  </div>\n                </CardContent>\n              </Card>\n            );\n          })\n        ) : (\n          <Card className=\"border border-purple-500/20 shadow-sm\">\n            <CardContent className=\"p-8 text-center\">\n              <p className=\"text-muted-foreground\">\n                No keys found. {searchTerm || gameFilter !== \"all\" ? \"Try changing your search filters.\" : \"\"}\n              </p>\n            </CardContent>\n          </Card>\n        )}\n      </div>\n\n      {/* Key Details Modal */}\n      <KeyDetailsModal\n        keyId={selectedKeyId}\n        open={keyDetailsOpen}\n        onOpenChange={setKeyDetailsOpen}\n      />\n\n      {/* Revoke Key Confirmation Dialog */}\n      <Dialog open={revokeDialogOpen} onOpenChange={setRevokeDialogOpen}>\n        <DialogContent className=\"max-w-[90vw] sm:max-w-md !top-[30%] md:!top-[50%] !left-[5vw] md:!left-[50%] !right-[5vw] md:!right-auto !transform-none md:!translate-x-[-50%] md:!translate-y-[-50%] !max-h-[60vh] !overflow-y-auto\">\n          <DialogHeader className=\"text-center space-y-3 pb-4\">\n            <DialogTitle className=\"text-lg font-semibold text-red-500\">\n              Revoke License Key\n            </DialogTitle>\n            <DialogDescription className=\"text-sm text-muted-foreground leading-relaxed\">\n              Are you sure you want to revoke this key? This action cannot be undone.\n              Users will no longer be able to use this license key after revocation.\n            </DialogDescription>\n          </DialogHeader>\n          <DialogFooter className=\"flex flex-col gap-3 pt-4\">\n            <Button \n              variant=\"destructive\" \n              className=\"w-full h-12 text-base font-medium\"\n              onClick={confirmRevokeKey}\n              disabled={revokeKeyMutation.isPending}\n            >\n              {revokeKeyMutation.isPending ? \"Revoking...\" : \"Revoke Key\"}\n            </Button>\n            <Button \n              variant=\"outline\" \n              className=\"w-full h-12 text-base font-medium\" \n              onClick={() => setRevokeDialogOpen(false)}\n            >\n              Cancel\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </ResellerLayout>\n  );\n}","size_bytes":16184},"server/database.ts":{"content":"import mongoose from 'mongoose';\nimport { Admin } from './models/Admin';\n\nconst MONGODB_URI = process.env.MONGODB_URI;\n\nasync function seedDefaultAdmin(): Promise<void> {\n  try {\n    // Check if admin with username \"admin\" already exists\n    const existingAdmin = await Admin.findOne({ username: 'admin' });\n    \n    if (!existingAdmin) {\n      // Get the next ID for the admin\n      const lastAdmin = await Admin.findOne().sort({ id: -1 });\n      const nextId = lastAdmin ? lastAdmin.id + 1 : 1;\n      \n      // Create default admin user\n      const defaultAdmin = new Admin({\n        id: nextId,\n        username: 'admin',\n        password: 'admin123', // This will be automatically encrypted by the pre-save hook\n        email: 'mohansuchil4@gmail.com'\n      });\n      \n      await defaultAdmin.save();\n      console.log('✅ Default admin user created ');\n    } else {\n      // Backfill email for existing admin if missing or incorrect\n      if (!existingAdmin.email || existingAdmin.email !== 'mohansuchil4@gmail.com') {\n        await Admin.updateOne(\n          { _id: existingAdmin._id }, \n          { $set: { email: 'mohansuchil4@gmail.com' } }\n        );\n        console.log('✅ Default admin email updated to mohansuchil4@gmail.com');\n      } else {\n        console.log('✅ Default admin user already exists with correct email');\n      }\n    }\n  } catch (error) {\n    console.error('❌ Error seeding default admin:', error);\n    // Don't throw error here to avoid breaking the app startup\n  }\n}\n\nexport async function connectDatabase(): Promise<void> {\n  if (!MONGODB_URI) {\n    throw new Error('MONGODB_URI environment variable is required');\n  }\n  \n  try {\n    const options: mongoose.ConnectOptions = {\n      maxPoolSize: 10, // Maintain up to 10 socket connections\n      serverSelectionTimeoutMS: 5000, // Keep trying to send operations for 5 seconds\n      socketTimeoutMS: 45000, // Close sockets after 45 seconds of inactivity\n    };\n\n    await mongoose.connect(MONGODB_URI, options);\n    \n    console.log('✅ Connected to MongoDB successfully');\n    \n    // Seed default admin user after successful connection\n    await seedDefaultAdmin();\n    \n    // Handle connection events\n    mongoose.connection.on('error', (error) => {\n      console.error('❌ MongoDB connection error:', error);\n    });\n\n    mongoose.connection.on('disconnected', () => {\n      console.warn('⚠️  MongoDB disconnected');\n    });\n\n    mongoose.connection.on('reconnected', () => {\n      console.log('🔄 MongoDB reconnected');\n    });\n\n  } catch (error) {\n    console.error('❌ Failed to connect to MongoDB:', error);\n    throw error;\n  }\n}\n\nexport async function disconnectDatabase(): Promise<void> {\n  try {\n    await mongoose.disconnect();\n    console.log('✅ Disconnected from MongoDB');\n  } catch (error) {\n    console.error('❌ Error disconnecting from MongoDB:', error);\n    throw error;\n  }\n}\n","size_bytes":2902},"server/fix-reseller-passwords.ts":{"content":"import { connectDatabase } from './database';\nimport { Reseller } from './models/Reseller';\nimport { nanoid } from 'nanoid';\n\nasync function fixResellerPasswords(): Promise<void> {\n  console.log('🔐 Fixing reseller passwords with secure temporary passwords...');\n  \n  try {\n    await connectDatabase();\n    \n    // Find all resellers with the weak default password hash\n    const resellers = await Reseller.find({});\n    \n    const passwordUpdates: { username: string; tempPassword: string }[] = [];\n    \n    for (const reseller of resellers) {\n      // Generate a secure temporary password\n      const tempPassword = `TEMP-${nanoid(12).toUpperCase()}`;\n      \n      // Update the password (will be hashed automatically by pre-save hook)\n      reseller.password = tempPassword;\n      await reseller.save();\n      \n      passwordUpdates.push({\n        username: reseller.username,\n        tempPassword\n      });\n      \n      console.log(`✅ Updated password for reseller: ${reseller.username}`);\n    }\n    \n    console.log('\\n🔐 IMPORTANT: Temporary Passwords Generated');\n    console.log('=' .repeat(50));\n    console.log('Please securely share these temporary passwords with your resellers:');\n    console.log('They should change these passwords on first login.\\n');\n    \n    passwordUpdates.forEach(({ username, tempPassword }) => {\n      console.log(`👤 ${username}: ${tempPassword}`);\n    });\n    \n    console.log('\\n⚠️  Security Note:');\n    console.log('- These are one-time temporary passwords');\n    console.log('- Resellers should change them immediately after login');\n    console.log('- Consider implementing forced password change on first login');\n    console.log('- Store these passwords securely and delete this log after distribution');\n    \n    console.log('\\n✅ Password security fix completed successfully!');\n    \n  } catch (error) {\n    console.error('❌ Failed to fix reseller passwords:', error);\n    throw error;\n  }\n}\n\n// Run fix if this file is executed directly\nif (import.meta.url === `file://${process.argv[1]}`) {\n  fixResellerPasswords()\n    .then(() => {\n      console.log('Password fix completed successfully!');\n      process.exit(0);\n    })\n    .catch((error) => {\n      console.error('Password fix failed:', error);\n      process.exit(1);\n    });\n}\n\nexport { fixResellerPasswords };","size_bytes":2331},"server/migrate-to-mongodb.ts":{"content":"import fs from 'fs';\nimport path from 'path';\nimport { connectDatabase } from './database';\nimport { Admin } from './models/Admin';\nimport { Reseller } from './models/Reseller';\nimport { Key } from './models/Key';\nimport { Token } from './models/Token';\nimport { Device } from './models/Device';\nimport { OnlineUpdate } from './models/OnlineUpdate';\n\ninterface JsonAdmin {\n  id: number;\n  username: string;\n  password: string;\n}\n\ninterface JsonReseller {\n  id: number;\n  username: string;\n  password: string;\n  credits: number;\n  registrationDate: string;\n  isActive: boolean;\n  referralToken: string;\n}\n\ninterface JsonToken {\n  id: number;\n  token: string;\n  createdAt: string;\n  usedBy: string | null;\n  isUsed: boolean;\n}\n\ninterface JsonKey {\n  id: number;\n  keyString: string;\n  game: string;\n  resellerId: number;\n  createdAt: string;\n  expiryDate: string;\n  deviceLimit: number;\n  isRevoked: boolean;\n}\n\ninterface JsonDevice {\n  id: number;\n  keyId: number;\n  deviceId: string;\n  firstConnected: string;\n}\n\ninterface JsonOnlineUpdate {\n  id: number;\n  title: string;\n  message: string;\n  buttonText?: string;\n  linkUrl?: string;\n  isActive: boolean;\n  createdAt: string;\n  updatedAt: string;\n}\n\ninterface ResellerFileData {\n  resellerId: number;\n  username: string;\n  keys: JsonKey[];\n  credits?: number;\n}\n\nconst DATA_DIR = path.join(process.cwd(), 'data');\n\nfunction readJsonFile<T>(filePath: string): T[] {\n  try {\n    if (!fs.existsSync(filePath)) {\n      console.log(`📄 File not found: ${filePath}`);\n      return [];\n    }\n    \n    const data = fs.readFileSync(filePath, 'utf8');\n    const parsed = JSON.parse(data);\n    return Array.isArray(parsed) ? parsed : [];\n  } catch (error) {\n    console.error(`❌ Error reading ${filePath}:`, error);\n    return [];\n  }\n}\n\nasync function migrateAdmins(): Promise<void> {\n  console.log('\\n🔧 Migrating Admins...');\n  const admins = readJsonFile<JsonAdmin>(path.join(DATA_DIR, 'admin.json'));\n  \n  if (admins.length === 0) {\n    // Create default admin if none exists\n    console.log('Creating default admin...');\n    const defaultAdmin = new Admin({\n      id: 1,\n      username: 'admin',\n      password: 'admin123' // This will be hashed automatically\n    });\n    await defaultAdmin.save();\n    console.log('✅ Default admin created');\n    return;\n  }\n\n  for (const adminData of admins) {\n    try {\n      const existingAdmin = await Admin.findOne({ id: adminData.id });\n      if (existingAdmin) {\n        console.log(`⏭️  Admin ${adminData.username} already exists, skipping...`);\n        continue;\n      }\n\n      const admin = new Admin({\n        id: adminData.id,\n        username: adminData.username,\n        password: adminData.password // This will be hashed automatically by the pre-save hook\n      });\n      \n      await admin.save();\n      console.log(`✅ Migrated admin: ${adminData.username}`);\n    } catch (error) {\n      console.error(`❌ Failed to migrate admin ${adminData.username}:`, error);\n    }\n  }\n}\n\nasync function migrateResellers(): Promise<void> {\n  console.log('\\n👥 Migrating Resellers...');\n  const resellers = readJsonFile<JsonReseller>(path.join(DATA_DIR, 'resellers.json'));\n  \n  // Also check for individual reseller files\n  const files = fs.readdirSync(DATA_DIR);\n  const resellerFiles = files.filter(file => \n    file.endsWith('.json') && \n    !['admin.json', 'resellers.json', 'keys.json', 'tokens.json', 'devices.json', 'online_updates.json'].includes(file)\n  );\n\n  // Create a map of resellers from individual files\n  const resellerDataMap = new Map<string, ResellerFileData>();\n  \n  for (const file of resellerFiles) {\n    try {\n      const filePath = path.join(DATA_DIR, file);\n      const data = fs.readFileSync(filePath, 'utf8');\n      const resellerData: ResellerFileData = JSON.parse(data);\n      resellerDataMap.set(resellerData.username, resellerData);\n      console.log(`📄 Found reseller file: ${file} (${resellerData.keys.length} keys)`);\n    } catch (error) {\n      console.error(`❌ Error reading reseller file ${file}:`, error);\n    }\n  }\n\n  // Migrate resellers from resellers.json or create from individual files\n  const resellersToMigrate = resellers.length > 0 ? resellers : Array.from(resellerDataMap.values()).map(data => ({\n    id: data.resellerId,\n    username: data.username,\n    password: 'defaultpass123', // Default password, should be changed\n    credits: data.credits || 0,\n    registrationDate: new Date().toISOString(),\n    isActive: true,\n    referralToken: `REF-${data.username.toUpperCase()}`\n  }));\n\n  for (const resellerData of resellersToMigrate) {\n    try {\n      const existingReseller = await Reseller.findOne({ id: resellerData.id });\n      if (existingReseller) {\n        console.log(`⏭️  Reseller ${resellerData.username} already exists, skipping...`);\n        continue;\n      }\n\n      // Get additional data from individual file if available\n      const fileData = resellerDataMap.get(resellerData.username);\n      const credits = fileData?.credits || resellerData.credits || 0;\n\n      const reseller = new Reseller({\n        id: resellerData.id,\n        username: resellerData.username,\n        password: resellerData.password, // This will be hashed automatically\n        credits,\n        registrationDate: new Date(resellerData.registrationDate),\n        isActive: resellerData.isActive,\n        referralToken: resellerData.referralToken\n      });\n      \n      await reseller.save();\n      console.log(`✅ Migrated reseller: ${resellerData.username} (${credits} credits)`);\n    } catch (error) {\n      console.error(`❌ Failed to migrate reseller ${resellerData.username}:`, error);\n    }\n  }\n}\n\nasync function migrateKeys(): Promise<void> {\n  console.log('\\n🔑 Migrating Keys...');\n  \n  // First try to get keys from global keys.json\n  const globalKeys = readJsonFile<JsonKey>(path.join(DATA_DIR, 'keys.json'));\n  \n  // Then collect keys from individual reseller files\n  const files = fs.readdirSync(DATA_DIR);\n  const resellerFiles = files.filter(file => \n    file.endsWith('.json') && \n    !['admin.json', 'resellers.json', 'keys.json', 'tokens.json', 'devices.json', 'online_updates.json'].includes(file)\n  );\n\n  const allKeys: JsonKey[] = [...globalKeys];\n\n  for (const file of resellerFiles) {\n    try {\n      const filePath = path.join(DATA_DIR, file);\n      const data = fs.readFileSync(filePath, 'utf8');\n      const resellerData: ResellerFileData = JSON.parse(data);\n      allKeys.push(...resellerData.keys);\n      console.log(`📄 Found ${resellerData.keys.length} keys in ${file}`);\n    } catch (error) {\n      console.error(`❌ Error reading keys from ${file}:`, error);\n    }\n  }\n\n  console.log(`📊 Total keys to migrate: ${allKeys.length}`);\n\n  for (const keyData of allKeys) {\n    try {\n      const existingKey = await Key.findOne({ id: keyData.id });\n      if (existingKey) {\n        console.log(`⏭️  Key ${keyData.keyString} already exists, skipping...`);\n        continue;\n      }\n\n      const key = new Key({\n        id: keyData.id,\n        keyString: keyData.keyString,\n        game: keyData.game,\n        resellerId: keyData.resellerId,\n        createdAt: new Date(keyData.createdAt),\n        expiryDate: new Date(keyData.expiryDate),\n        deviceLimit: keyData.deviceLimit,\n        isRevoked: keyData.isRevoked\n      });\n      \n      await key.save();\n      console.log(`✅ Migrated key: ${keyData.keyString} (${keyData.game})`);\n    } catch (error) {\n      console.error(`❌ Failed to migrate key ${keyData.keyString}:`, error);\n    }\n  }\n}\n\nasync function migrateTokens(): Promise<void> {\n  console.log('\\n🎟️  Migrating Tokens...');\n  const tokens = readJsonFile<JsonToken>(path.join(DATA_DIR, 'tokens.json'));\n  \n  for (const tokenData of tokens) {\n    try {\n      const existingToken = await Token.findOne({ id: tokenData.id });\n      if (existingToken) {\n        console.log(`⏭️  Token ${tokenData.token} already exists, skipping...`);\n        continue;\n      }\n\n      const token = new Token({\n        id: tokenData.id,\n        token: tokenData.token,\n        createdAt: new Date(tokenData.createdAt),\n        usedBy: tokenData.usedBy,\n        isUsed: tokenData.isUsed\n      });\n      \n      await token.save();\n      console.log(`✅ Migrated token: ${tokenData.token}`);\n    } catch (error) {\n      console.error(`❌ Failed to migrate token ${tokenData.token}:`, error);\n    }\n  }\n}\n\nasync function migrateDevices(): Promise<void> {\n  console.log('\\n📱 Migrating Devices...');\n  const devices = readJsonFile<JsonDevice>(path.join(DATA_DIR, 'devices.json'));\n  \n  for (const deviceData of devices) {\n    try {\n      const existingDevice = await Device.findOne({ id: deviceData.id });\n      if (existingDevice) {\n        console.log(`⏭️  Device ${deviceData.deviceId} already exists, skipping...`);\n        continue;\n      }\n\n      const device = new Device({\n        id: deviceData.id,\n        keyId: deviceData.keyId,\n        deviceId: deviceData.deviceId,\n        firstConnected: new Date(deviceData.firstConnected)\n      });\n      \n      await device.save();\n      console.log(`✅ Migrated device: ${deviceData.deviceId}`);\n    } catch (error) {\n      console.error(`❌ Failed to migrate device ${deviceData.deviceId}:`, error);\n    }\n  }\n}\n\nasync function migrateOnlineUpdates(): Promise<void> {\n  console.log('\\n📢 Migrating Online Updates...');\n  const updates = readJsonFile<JsonOnlineUpdate>(path.join(DATA_DIR, 'online_updates.json'));\n  \n  for (const updateData of updates) {\n    try {\n      const existingUpdate = await OnlineUpdate.findOne({ id: updateData.id });\n      if (existingUpdate) {\n        console.log(`⏭️  Update ${updateData.title} already exists, skipping...`);\n        continue;\n      }\n\n      const update = new OnlineUpdate({\n        id: updateData.id,\n        title: updateData.title,\n        message: updateData.message,\n        buttonText: updateData.buttonText || null,\n        linkUrl: updateData.linkUrl || null,\n        isActive: updateData.isActive,\n        createdAt: new Date(updateData.createdAt),\n        updatedAt: new Date(updateData.updatedAt)\n      });\n      \n      await update.save();\n      console.log(`✅ Migrated online update: ${updateData.title}`);\n    } catch (error) {\n      console.error(`❌ Failed to migrate online update ${updateData.title}:`, error);\n    }\n  }\n}\n\nasync function createBackup(): Promise<void> {\n  console.log('\\n💾 Creating backup of existing data...');\n  const backupDir = path.join(process.cwd(), 'data-backup');\n  \n  if (!fs.existsSync(backupDir)) {\n    fs.mkdirSync(backupDir, { recursive: true });\n  }\n\n  // Copy all JSON files to backup directory\n  const files = fs.readdirSync(DATA_DIR);\n  for (const file of files) {\n    if (file.endsWith('.json')) {\n      const sourcePath = path.join(DATA_DIR, file);\n      const backupPath = path.join(backupDir, file);\n      fs.copyFileSync(sourcePath, backupPath);\n      console.log(`📄 Backed up: ${file}`);\n    }\n  }\n\n  console.log(`✅ Backup completed in: ${backupDir}`);\n}\n\nexport async function runMigration(): Promise<void> {\n  console.log('🚀 Starting migration from JSON to MongoDB...');\n  console.log('=' .repeat(50));\n\n  try {\n    // Connect to MongoDB\n    await connectDatabase();\n    \n    // Create backup first\n    await createBackup();\n\n    // Run migrations in order\n    await migrateAdmins();\n    await migrateTokens();\n    await migrateResellers(); \n    await migrateKeys();\n    await migrateDevices();\n    await migrateOnlineUpdates();\n\n    // Display summary\n    const [adminCount, resellerCount, keyCount, tokenCount, deviceCount, updateCount] = await Promise.all([\n      Admin.countDocuments(),\n      Reseller.countDocuments(),\n      Key.countDocuments(),\n      Token.countDocuments(),\n      Device.countDocuments(),\n      OnlineUpdate.countDocuments()\n    ]);\n\n    console.log('\\n📊 Migration Summary:');\n    console.log('=' .repeat(30));\n    console.log(`👑 Admins: ${adminCount}`);\n    console.log(`👥 Resellers: ${resellerCount}`);\n    console.log(`🔑 Keys: ${keyCount}`);\n    console.log(`🎟️  Tokens: ${tokenCount}`);\n    console.log(`📱 Devices: ${deviceCount}`);\n    console.log(`📢 Online Updates: ${updateCount}`);\n    \n    console.log('\\n✅ Migration completed successfully!');\n    console.log('🔒 All passwords have been encrypted with bcrypt');\n    console.log('💾 Original data backed up to data-backup/ folder');\n\n  } catch (error) {\n    console.error('❌ Migration failed:', error);\n    throw error;\n  }\n}\n\n// Run migration if this file is executed directly\nif (import.meta.url === `file://${process.argv[1]}`) {\n  runMigration()\n    .then(() => {\n      console.log('Migration completed successfully!');\n      process.exit(0);\n    })\n    .catch((error) => {\n      console.error('Migration failed:', error);\n      process.exit(1);\n    });\n}","size_bytes":12855},"server/mongodb-storage.ts":{"content":"import { \n  Admin as AdminType, InsertAdmin,\n  Token as TokenType, InsertToken,\n  Reseller as ResellerType, InsertReseller,\n  Key as KeyType, InsertKey, \n  Device as DeviceType, InsertDevice,\n  OnlineUpdate as OnlineUpdateType, InsertOnlineUpdate, UpdateOnlineUpdate\n} from \"@shared/schema\";\nimport { nanoid } from \"nanoid\";\nimport { IStorage } from \"./storage\";\n\n// Import MongoDB models\nimport { Admin, IAdmin } from \"./models/Admin\";\nimport { Reseller, IReseller } from \"./models/Reseller\";\nimport { Key, IKey } from \"./models/Key\";\nimport { Token, IToken } from \"./models/Token\";\nimport { Device, IDevice } from \"./models/Device\";\nimport { OnlineUpdate, IOnlineUpdate } from \"./models/OnlineUpdate\";\nimport { OTP, IOTP } from \"./models/OTP\";\n\nexport class MongoDBStorage implements IStorage {\n  private adminIdCounter: number = 1;\n  private tokenIdCounter: number = 1;\n  private resellerIdCounter: number = 1;\n  private keyIdCounter: number = 1;\n  private deviceIdCounter: number = 1;\n  private onlineUpdateIdCounter: number = 1;\n  private otpIdCounter: number = 1;\n\n  constructor() {\n    this.initializeCounters();\n  }\n\n  private async initializeCounters(): Promise<void> {\n    try {\n      // Initialize ID counters based on existing data\n      const [lastAdmin, lastToken, lastReseller, lastKey, lastDevice, lastUpdate, lastOTP] = await Promise.all([\n        Admin.findOne().sort({ id: -1 }),\n        Token.findOne().sort({ id: -1 }),\n        Reseller.findOne().sort({ id: -1 }),\n        Key.findOne().sort({ id: -1 }),\n        Device.findOne().sort({ id: -1 }),\n        OnlineUpdate.findOne().sort({ id: -1 }),\n        OTP.findOne().sort({ id: -1 })\n      ]);\n\n      this.adminIdCounter = lastAdmin ? lastAdmin.id + 1 : 1;\n      this.tokenIdCounter = lastToken ? lastToken.id + 1 : 1;\n      this.resellerIdCounter = lastReseller ? lastReseller.id + 1 : 1;\n      this.keyIdCounter = lastKey ? lastKey.id + 1 : 1;\n      this.deviceIdCounter = lastDevice ? lastDevice.id + 1 : 1;\n      this.onlineUpdateIdCounter = lastUpdate ? lastUpdate.id + 1 : 1;\n      this.otpIdCounter = lastOTP ? lastOTP.id + 1 : 1;\n\n      console.log('✅ MongoDB Storage counters initialized');\n    } catch (error) {\n      console.error('❌ Error initializing counters:', error);\n    }\n  }\n\n  // Admin methods\n  async getAdmin(id: number): Promise<AdminType | undefined> {\n    try {\n      const admin = await Admin.findOne({ id });\n      return admin ? this.convertAdminDoc(admin) : undefined;\n    } catch (error) {\n      console.error('Error getting admin:', error);\n      return undefined;\n    }\n  }\n\n  async getAdminByUsername(username: string): Promise<AdminType | undefined> {\n    try {\n      const admin = await Admin.findOne({ username });\n      return admin ? this.convertAdminDoc(admin) : undefined;\n    } catch (error) {\n      console.error('Error getting admin by username:', error);\n      return undefined;\n    }\n  }\n\n  async createAdmin(insertAdmin: InsertAdmin): Promise<AdminType> {\n    try {\n      const admin = new Admin({\n        id: this.adminIdCounter++,\n        username: insertAdmin.username,\n        password: insertAdmin.password\n      });\n      \n      await admin.save();\n      return this.convertAdminDoc(admin);\n    } catch (error) {\n      console.error('Error creating admin:', error);\n      throw error;\n    }\n  }\n\n  // Token methods\n  async createToken(credits: number = 0): Promise<TokenType> {\n    try {\n      const tokenString = `REF-${nanoid(10).toUpperCase()}`;\n      const token = new Token({\n        id: this.tokenIdCounter++,\n        token: tokenString,\n        createdAt: new Date(),\n        usedBy: null,\n        isUsed: false,\n        credits\n      });\n      \n      await token.save();\n      return this.convertTokenDoc(token);\n    } catch (error) {\n      console.error('Error creating token:', error);\n      throw error;\n    }\n  }\n\n  async getAllTokens(): Promise<TokenType[]> {\n    try {\n      const tokens = await Token.find().sort({ createdAt: -1 });\n      return tokens.map(this.convertTokenDoc);\n    } catch (error) {\n      console.error('Error getting all tokens:', error);\n      return [];\n    }\n  }\n\n  async getToken(tokenString: string): Promise<TokenType | undefined> {\n    try {\n      const token = await Token.findOne({ token: tokenString });\n      return token ? this.convertTokenDoc(token) : undefined;\n    } catch (error) {\n      console.error('Error getting token:', error);\n      return undefined;\n    }\n  }\n\n  async useToken(tokenString: string, username: string): Promise<TokenType | undefined> {\n    try {\n      const token = await Token.findOneAndUpdate(\n        { token: tokenString, isUsed: false },\n        { isUsed: true, usedBy: username },\n        { new: true }\n      );\n      return token ? this.convertTokenDoc(token) : undefined;\n    } catch (error) {\n      console.error('Error using token:', error);\n      return undefined;\n    }\n  }\n\n  // Reseller methods\n  async getReseller(id: number): Promise<ResellerType | undefined> {\n    try {\n      const reseller = await Reseller.findOne({ id });\n      return reseller ? this.convertResellerDoc(reseller) : undefined;\n    } catch (error) {\n      console.error('Error getting reseller:', error);\n      return undefined;\n    }\n  }\n\n  async getResellerByUsername(username: string): Promise<ResellerType | undefined> {\n    try {\n      const reseller = await Reseller.findOne({ username });\n      return reseller ? this.convertResellerDoc(reseller) : undefined;\n    } catch (error) {\n      console.error('Error getting reseller by username:', error);\n      return undefined;\n    }\n  }\n\n  async createReseller(insertReseller: InsertReseller & { credits?: number }): Promise<ResellerType> {\n    try {\n      const reseller = new Reseller({\n        id: this.resellerIdCounter++,\n        username: insertReseller.username,\n        password: insertReseller.password,\n        credits: insertReseller.credits || 0,\n        registrationDate: new Date(),\n        isActive: true,\n        referralToken: insertReseller.referralToken\n      });\n      \n      await reseller.save();\n      return this.convertResellerDoc(reseller);\n    } catch (error) {\n      console.error('Error creating reseller:', error);\n      throw error;\n    }\n  }\n\n  async getAllResellers(): Promise<ResellerType[]> {\n    try {\n      const resellers = await Reseller.find().sort({ registrationDate: -1 });\n      return resellers.map(this.convertResellerDoc);\n    } catch (error) {\n      console.error('Error getting all resellers:', error);\n      return [];\n    }\n  }\n\n  async updateResellerCredits(id: number, amount: number): Promise<ResellerType | undefined> {\n    try {\n      const reseller = await Reseller.findOneAndUpdate(\n        { id },\n        { $inc: { credits: amount } },\n        { new: true }\n      );\n      return reseller ? this.convertResellerDoc(reseller) : undefined;\n    } catch (error) {\n      console.error('Error updating reseller credits:', error);\n      return undefined;\n    }\n  }\n\n  async updateResellerStatus(id: number, isActive: boolean): Promise<ResellerType | undefined> {\n    try {\n      const reseller = await Reseller.findOneAndUpdate(\n        { id },\n        { isActive },\n        { new: true }\n      );\n      return reseller ? this.convertResellerDoc(reseller) : undefined;\n    } catch (error) {\n      console.error('Error updating reseller status:', error);\n      return undefined;\n    }\n  }\n\n  // Key methods\n  async createKey(insertKey: InsertKey): Promise<KeyType> {\n    try {\n      const key = new Key({\n        id: this.keyIdCounter++,\n        keyString: insertKey.keyString,\n        game: insertKey.game,\n        resellerId: insertKey.resellerId,\n        createdAt: new Date(),\n        expiryDate: insertKey.expiryDate,\n        deviceLimit: insertKey.deviceLimit,\n        isRevoked: false\n      });\n      \n      await key.save();\n      return this.convertKeyDoc(key);\n    } catch (error) {\n      console.error('Error creating key:', error);\n      throw error;\n    }\n  }\n\n  async getKey(keyString: string): Promise<KeyType | undefined> {\n    try {\n      const key = await Key.findOne({ keyString });\n      return key ? this.convertKeyDoc(key) : undefined;\n    } catch (error) {\n      console.error('Error getting key:', error);\n      return undefined;\n    }\n  }\n\n  async getKeysByResellerId(resellerId: number): Promise<KeyType[]> {\n    try {\n      const keys = await Key.find({ resellerId }).sort({ createdAt: -1 });\n      return keys.map(this.convertKeyDoc);\n    } catch (error) {\n      console.error('Error getting keys by reseller ID:', error);\n      return [];\n    }\n  }\n\n  async getAllKeys(): Promise<KeyType[]> {\n    try {\n      const keys = await Key.find().sort({ createdAt: -1 });\n      return keys.map(this.convertKeyDoc);\n    } catch (error) {\n      console.error('Error getting all keys:', error);\n      return [];\n    }\n  }\n\n  async revokeKey(keyId: number): Promise<KeyType | undefined> {\n    try {\n      const key = await Key.findOneAndUpdate(\n        { id: keyId },\n        { isRevoked: true },\n        { new: true }\n      );\n      return key ? this.convertKeyDoc(key) : undefined;\n    } catch (error) {\n      console.error('Error revoking key:', error);\n      return undefined;\n    }\n  }\n\n  // Device methods\n  async addDevice(insertDevice: InsertDevice): Promise<DeviceType> {\n    try {\n      const device = new Device({\n        id: this.deviceIdCounter++,\n        keyId: insertDevice.keyId,\n        deviceId: insertDevice.deviceId,\n        firstConnected: new Date()\n      });\n      \n      await device.save();\n      return this.convertDeviceDoc(device);\n    } catch (error) {\n      console.error('Error adding device:', error);\n      throw error;\n    }\n  }\n\n  async getDevicesByKeyId(keyId: number): Promise<DeviceType[]> {\n    try {\n      const devices = await Device.find({ keyId }).sort({ firstConnected: -1 });\n      return devices.map(this.convertDeviceDoc);\n    } catch (error) {\n      console.error('Error getting devices by key ID:', error);\n      return [];\n    }\n  }\n\n  async removeDevice(deviceId: string, keyId: number): Promise<boolean> {\n    try {\n      const result = await Device.deleteOne({ deviceId, keyId });\n      return result.deletedCount > 0;\n    } catch (error) {\n      console.error('Error removing device:', error);\n      return false;\n    }\n  }\n\n  // Online update methods\n  async createOnlineUpdate(insertUpdate: InsertOnlineUpdate): Promise<OnlineUpdateType> {\n    try {\n      const now = new Date();\n      const update = new OnlineUpdate({\n        id: this.onlineUpdateIdCounter++,\n        title: insertUpdate.title,\n        message: insertUpdate.message,\n        buttonText: insertUpdate.buttonText || null,\n        linkUrl: insertUpdate.linkUrl || null,\n        isActive: insertUpdate.isActive ?? true,\n        createdAt: now,\n        updatedAt: now\n      });\n      \n      await update.save();\n      return this.convertOnlineUpdateDoc(update);\n    } catch (error) {\n      console.error('Error creating online update:', error);\n      throw error;\n    }\n  }\n\n  async getAllOnlineUpdates(): Promise<OnlineUpdateType[]> {\n    try {\n      const updates = await OnlineUpdate.find().sort({ createdAt: -1 });\n      return updates.map(this.convertOnlineUpdateDoc);\n    } catch (error) {\n      console.error('Error getting all online updates:', error);\n      return [];\n    }\n  }\n\n  async getOnlineUpdate(id: number): Promise<OnlineUpdateType | undefined> {\n    try {\n      const update = await OnlineUpdate.findOne({ id });\n      return update ? this.convertOnlineUpdateDoc(update) : undefined;\n    } catch (error) {\n      console.error('Error getting online update:', error);\n      return undefined;\n    }\n  }\n\n  async updateOnlineUpdate(id: number, updateData: Partial<UpdateOnlineUpdate>): Promise<OnlineUpdateType | undefined> {\n    try {\n      const update = await OnlineUpdate.findOneAndUpdate(\n        { id },\n        { ...updateData, updatedAt: new Date() },\n        { new: true }\n      );\n      return update ? this.convertOnlineUpdateDoc(update) : undefined;\n    } catch (error) {\n      console.error('Error updating online update:', error);\n      return undefined;\n    }\n  }\n\n  async deleteOnlineUpdate(id: number): Promise<boolean> {\n    try {\n      const result = await OnlineUpdate.deleteOne({ id });\n      return result.deletedCount > 0;\n    } catch (error) {\n      console.error('Error deleting online update:', error);\n      return false;\n    }\n  }\n\n  async getActiveOnlineUpdates(): Promise<OnlineUpdateType[]> {\n    try {\n      const updates = await OnlineUpdate.find({ isActive: true }).sort({ createdAt: -1 });\n      return updates.map(this.convertOnlineUpdateDoc);\n    } catch (error) {\n      console.error('Error getting active online updates:', error);\n      return [];\n    }\n  }\n\n  // Stats methods\n  async getStats(): Promise<{ totalResellers: number; activeKeys: number; availableTokens: number; }> {\n    try {\n      const now = new Date();\n      const [totalResellers, activeKeys, availableTokens] = await Promise.all([\n        Reseller.countDocuments(),\n        Key.countDocuments({ isRevoked: false, expiryDate: { $gt: now } }),\n        Token.countDocuments({ isUsed: false })\n      ]);\n\n      return {\n        totalResellers,\n        activeKeys,\n        availableTokens\n      };\n    } catch (error) {\n      console.error('Error getting stats:', error);\n      return { totalResellers: 0, activeKeys: 0, availableTokens: 0 };\n    }\n  }\n\n  // Document conversion methods\n  private convertAdminDoc(doc: IAdmin): AdminType {\n    return {\n      id: doc.id,\n      username: doc.username,\n      password: doc.password,\n      email: doc.email\n    };\n  }\n\n  private convertTokenDoc(doc: IToken): TokenType {\n    return {\n      id: doc.id,\n      token: doc.token,\n      createdAt: doc.createdAt,\n      usedBy: doc.usedBy,\n      isUsed: doc.isUsed,\n      credits: doc.credits\n    };\n  }\n\n  private convertResellerDoc(doc: IReseller): ResellerType {\n    return {\n      id: doc.id,\n      username: doc.username,\n      password: doc.password,\n      credits: doc.credits,\n      registrationDate: doc.registrationDate,\n      isActive: doc.isActive,\n      referralToken: doc.referralToken\n    };\n  }\n\n  private convertKeyDoc(doc: IKey): KeyType {\n    return {\n      id: doc.id,\n      keyString: doc.keyString,\n      game: doc.game,\n      resellerId: doc.resellerId,\n      createdAt: doc.createdAt,\n      expiryDate: doc.expiryDate,\n      deviceLimit: doc.deviceLimit,\n      isRevoked: doc.isRevoked\n    };\n  }\n\n  private convertDeviceDoc(doc: IDevice): DeviceType {\n    return {\n      id: doc.id,\n      keyId: doc.keyId,\n      deviceId: doc.deviceId,\n      firstConnected: doc.firstConnected\n    };\n  }\n\n  private convertOnlineUpdateDoc(doc: IOnlineUpdate): OnlineUpdateType {\n    return {\n      id: doc.id,\n      title: doc.title,\n      message: doc.message,\n      buttonText: doc.buttonText,\n      linkUrl: doc.linkUrl,\n      isActive: doc.isActive,\n      createdAt: doc.createdAt,\n      updatedAt: doc.updatedAt\n    };\n  }\n\n  // Special method for password verification (since we can't expose hashed passwords)\n  async verifyAdminPassword(username: string, password: string): Promise<boolean> {\n    try {\n      const admin = await Admin.findOne({ username });\n      if (!admin) return false;\n      return await admin.comparePassword(password);\n    } catch (error) {\n      console.error('Error verifying admin password:', error);\n      return false;\n    }\n  }\n\n  async verifyResellerPassword(username: string, password: string): Promise<boolean> {\n    try {\n      const reseller = await Reseller.findOne({ username });\n      if (!reseller) return false;\n      return await reseller.comparePassword(password);\n    } catch (error) {\n      console.error('Error verifying reseller password:', error);\n      return false;\n    }\n  }\n\n  // OTP methods\n  async createOTP(adminId: number, otp: string): Promise<{ id: number; adminId: number; otp: string; expiresAt: Date; isUsed: boolean }> {\n    try {\n      const otpDoc = new OTP({\n        id: this.otpIdCounter++,\n        adminId,\n        otp,\n        isUsed: false,\n        expiresAt: new Date(Date.now() + 60 * 1000) // 1 minute from now\n      });\n      \n      await otpDoc.save();\n      return {\n        id: otpDoc.id,\n        adminId: otpDoc.adminId,\n        otp: otpDoc.otp,\n        expiresAt: otpDoc.expiresAt,\n        isUsed: otpDoc.isUsed\n      };\n    } catch (error) {\n      console.error('Error creating OTP:', error);\n      throw error;\n    }\n  }\n\n  async getOTP(adminId: number, otp: string): Promise<{ id: number; adminId: number; otp: string; expiresAt: Date; isUsed: boolean } | undefined> {\n    try {\n      const otpDoc = await OTP.findOne({ adminId, otp });\n      if (!otpDoc) return undefined;\n      \n      return {\n        id: otpDoc.id,\n        adminId: otpDoc.adminId,\n        otp: otpDoc.otp,\n        expiresAt: otpDoc.expiresAt,\n        isUsed: otpDoc.isUsed\n      };\n    } catch (error) {\n      console.error('Error getting OTP:', error);\n      return undefined;\n    }\n  }\n\n  async markOTPAsUsed(id: number): Promise<boolean> {\n    try {\n      const result = await OTP.findOneAndUpdate(\n        { id },\n        { isUsed: true },\n        { new: true }\n      );\n      return !!result;\n    } catch (error) {\n      console.error('Error marking OTP as used:', error);\n      return false;\n    }\n  }\n\n  async cleanupExpiredOTPs(): Promise<void> {\n    try {\n      await OTP.deleteMany({ expiresAt: { $lt: new Date() } });\n      console.log('✅ Expired OTPs cleaned up');\n    } catch (error) {\n      console.error('❌ Error cleaning up expired OTPs:', error);\n    }\n  }\n}","size_bytes":17586},"server/reset-admin.ts":{"content":"import { connectDatabase } from './database';\nimport { Admin } from './models/Admin';\n\nasync function resetAdminPassword(): Promise<void> {\n  console.log('🔧 Checking and resetting admin credentials...');\n  \n  try {\n    await connectDatabase();\n    \n    // Check if admin exists\n    const existingAdmin = await Admin.findOne({ username: 'admin' });\n    \n    if (existingAdmin) {\n      console.log(`Found existing admin: ${existingAdmin.username}`);\n      \n      // Update password to 'admin123' (will be hashed automatically)\n      existingAdmin.password = 'admin123';\n      await existingAdmin.save();\n      \n      console.log('✅ Admin password updated to: admin123');\n    } else {\n      // Create new admin if doesn't exist\n      console.log('No admin found, creating new admin...');\n      const newAdmin = new Admin({\n        id: 1,\n        username: 'admin',\n        password: 'admin123' // Will be hashed automatically\n      });\n      \n      await newAdmin.save();\n      console.log('✅ New admin created');\n    }\n    \n    // Verify the admin can authenticate\n    const admin = await Admin.findOne({ username: 'admin' });\n    if (admin) {\n      const testAuth = await admin.comparePassword('admin123');\n      console.log(`✅ Password verification test: ${testAuth ? 'PASSED' : 'FAILED'}`);\n    }\n    \n    console.log('\\n🔐 Admin Credentials:');\n    console.log('Username: admin');\n    console.log('Password: admin123');\n    console.log('\\nYou can now login to the admin panel with these credentials.');\n    \n  } catch (error) {\n    console.error('❌ Failed to reset admin password:', error);\n    throw error;\n  }\n}\n\n// Run reset if this file is executed directly\nif (import.meta.url === `file://${process.argv[1]}`) {\n  resetAdminPassword()\n    .then(() => {\n      console.log('Admin reset completed successfully!');\n      process.exit(0);\n    })\n    .catch((error) => {\n      console.error('Admin reset failed:', error);\n      process.exit(1);\n    });\n}\n\nexport { resetAdminPassword };","size_bytes":2000},"server/models/Admin.ts":{"content":"import mongoose, { Document, Schema } from 'mongoose';\nimport bcrypt from 'bcryptjs';\n\nexport interface IAdmin extends Document {\n  id: number;\n  username: string;\n  password: string;\n  email: string;\n  comparePassword(candidatePassword: string): Promise<boolean>;\n}\n\nconst adminSchema = new Schema<IAdmin>({\n  id: {\n    type: Number,\n    required: true,\n    unique: true,\n  },\n  username: {\n    type: String,\n    required: true,\n    unique: true,\n    trim: true,\n  },\n  password: {\n    type: String,\n    required: true,\n  },\n  email: {\n    type: String,\n    required: true,\n    unique: true,\n    trim: true,\n    lowercase: true,\n  },\n}, {\n  timestamps: true,\n  collection: 'admins'\n});\n\n// Hash password before saving\nadminSchema.pre<IAdmin>('save', async function(next) {\n  if (!this.isModified('password')) {\n    return next();\n  }\n  \n  try {\n    const salt = await bcrypt.genSalt(12);\n    this.password = await bcrypt.hash(this.password, salt);\n    next();\n  } catch (error) {\n    next(error as Error);\n  }\n});\n\n// Compare password method\nadminSchema.methods.comparePassword = async function(candidatePassword: string): Promise<boolean> {\n  return bcrypt.compare(candidatePassword, this.password);\n};\n\nexport const Admin = mongoose.model<IAdmin>('Admin', adminSchema);","size_bytes":1272},"server/models/Device.ts":{"content":"import mongoose, { Document, Schema } from 'mongoose';\n\nexport interface IDevice extends Document {\n  id: number;\n  keyId: number;\n  deviceId: string;\n  firstConnected: Date;\n}\n\nconst deviceSchema = new Schema<IDevice>({\n  id: {\n    type: Number,\n    required: true,\n    unique: true,\n  },\n  keyId: {\n    type: Number,\n    required: true,\n    index: true,\n  },\n  deviceId: {\n    type: String,\n    required: true,\n    trim: true,\n  },\n  firstConnected: {\n    type: Date,\n    default: Date.now,\n  },\n}, {\n  timestamps: true,\n  collection: 'devices'\n});\n\n// Compound index to prevent duplicate devices per key\ndeviceSchema.index({ keyId: 1, deviceId: 1 }, { unique: true });\n\nexport const Device = mongoose.model<IDevice>('Device', deviceSchema);","size_bytes":743},"server/models/Key.ts":{"content":"import mongoose, { Document, Schema } from 'mongoose';\n\nexport interface IKey extends Document {\n  id: number;\n  keyString: string;\n  game: string;\n  resellerId: number;\n  createdAt: Date;\n  expiryDate: Date;\n  deviceLimit: number;\n  isRevoked: boolean;\n}\n\nconst keySchema = new Schema<IKey>({\n  id: {\n    type: Number,\n    required: true,\n    unique: true,\n  },\n  keyString: {\n    type: String,\n    required: true,\n    unique: true,\n    trim: true,\n  },\n  game: {\n    type: String,\n    required: true,\n    enum: [\"PUBG MOBILE\", \"LAST ISLAND OF SURVIVAL\", \"STANDOFF2\"],\n  },\n  resellerId: {\n    type: Number,\n    required: true,\n    index: true,\n  },\n  createdAt: {\n    type: Date,\n    default: Date.now,\n  },\n  expiryDate: {\n    type: Date,\n    required: true,\n  },\n  deviceLimit: {\n    type: Number,\n    required: true,\n    min: 1,\n  },\n  isRevoked: {\n    type: Boolean,\n    default: false,\n  },\n}, {\n  timestamps: true,\n  collection: 'keys'\n});\n\n// Index for efficient queries\nkeySchema.index({ resellerId: 1, isRevoked: 1 });\nkeySchema.index({ expiryDate: 1, isRevoked: 1 });\n\nexport const Key = mongoose.model<IKey>('Key', keySchema);","size_bytes":1139},"server/models/OnlineUpdate.ts":{"content":"import mongoose, { Document, Schema } from 'mongoose';\n\nexport interface IOnlineUpdate extends Document {\n  id: number;\n  title: string;\n  message: string;\n  buttonText: string | null;\n  linkUrl: string | null;\n  isActive: boolean;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nconst onlineUpdateSchema = new Schema<IOnlineUpdate>({\n  id: {\n    type: Number,\n    required: true,\n    unique: true,\n  },\n  title: {\n    type: String,\n    required: true,\n    maxlength: 100,\n    trim: true,\n  },\n  message: {\n    type: String,\n    required: true,\n    maxlength: 500,\n    trim: true,\n  },\n  buttonText: {\n    type: String,\n    default: null,\n    maxlength: 50,\n    trim: true,\n  },\n  linkUrl: {\n    type: String,\n    default: null,\n    validate: {\n      validator: function(v: string) {\n        if (!v) return true; // Allow null/empty\n        return /^https?:\\/\\/.+/.test(v);\n      },\n      message: 'Must be a valid URL'\n    }\n  },\n  isActive: {\n    type: Boolean,\n    default: true,\n  },\n  createdAt: {\n    type: Date,\n    default: Date.now,\n  },\n  updatedAt: {\n    type: Date,\n    default: Date.now,\n  },\n}, {\n  timestamps: true,\n  collection: 'online_updates'\n});\n\n// Index for efficient queries\nonlineUpdateSchema.index({ isActive: 1, createdAt: -1 });\n\n// Update the updatedAt field before saving\nonlineUpdateSchema.pre<IOnlineUpdate>('save', function(next) {\n  if (this.isModified() && !this.isNew) {\n    this.updatedAt = new Date();\n  }\n  next();\n});\n\nexport const OnlineUpdate = mongoose.model<IOnlineUpdate>('OnlineUpdate', onlineUpdateSchema);","size_bytes":1545},"server/models/Reseller.ts":{"content":"import mongoose, { Document, Schema } from 'mongoose';\nimport bcrypt from 'bcryptjs';\n\nexport interface IReseller extends Document {\n  id: number;\n  username: string;\n  password: string;\n  credits: number;\n  registrationDate: Date;\n  isActive: boolean;\n  referralToken: string;\n  comparePassword(candidatePassword: string): Promise<boolean>;\n}\n\nconst resellerSchema = new Schema<IReseller>({\n  id: {\n    type: Number,\n    required: true,\n    unique: true,\n  },\n  username: {\n    type: String,\n    required: true,\n    unique: true,\n    trim: true,\n  },\n  password: {\n    type: String,\n    required: true,\n  },\n  credits: {\n    type: Number,\n    default: 0,\n    min: 0,\n  },\n  registrationDate: {\n    type: Date,\n    default: Date.now,\n  },\n  isActive: {\n    type: Boolean,\n    default: true,\n  },\n  referralToken: {\n    type: String,\n    required: true,\n  },\n}, {\n  timestamps: true,\n  collection: 'resellers'\n});\n\n// Hash password before saving\nresellerSchema.pre<IReseller>('save', async function(next) {\n  if (!this.isModified('password')) {\n    return next();\n  }\n  \n  try {\n    const salt = await bcrypt.genSalt(12);\n    this.password = await bcrypt.hash(this.password, salt);\n    next();\n  } catch (error) {\n    next(error as Error);\n  }\n});\n\n// Compare password method\nresellerSchema.methods.comparePassword = async function(candidatePassword: string): Promise<boolean> {\n  return bcrypt.compare(candidatePassword, this.password);\n};\n\nexport const Reseller = mongoose.model<IReseller>('Reseller', resellerSchema);","size_bytes":1519},"server/models/Token.ts":{"content":"import mongoose, { Document, Schema } from 'mongoose';\n\nexport interface IToken extends Document {\n  id: number;\n  token: string;\n  createdAt: Date;\n  usedBy: string | null;\n  isUsed: boolean;\n  credits: number;\n}\n\nconst tokenSchema = new Schema<IToken>({\n  id: {\n    type: Number,\n    required: true,\n    unique: true,\n  },\n  token: {\n    type: String,\n    required: true,\n    unique: true,\n    trim: true,\n  },\n  createdAt: {\n    type: Date,\n    default: Date.now,\n  },\n  usedBy: {\n    type: String,\n    default: null,\n  },\n  isUsed: {\n    type: Boolean,\n    default: false,\n  },\n  credits: {\n    type: Number,\n    default: 0,\n    min: 0,\n  },\n}, {\n  timestamps: true,\n  collection: 'tokens'\n});\n\n// Index for efficient queries\ntokenSchema.index({ isUsed: 1 });\n\nexport const Token = mongoose.model<IToken>('Token', tokenSchema);","size_bytes":831},"client/src/hooks/use-websocket.tsx":{"content":"import { useEffect, useRef, useState } from \"react\";\nimport { useAuth } from \"./use-auth\";\nimport { useToast } from \"./use-toast\";\n\ninterface WebSocketMessage {\n  type: string;\n  isActive?: boolean;\n  message?: string;\n}\n\nexport function useWebSocket() {\n  const { user, isAuthenticated, logout } = useAuth();\n  const { toast } = useToast();\n  const wsRef = useRef<WebSocket | null>(null);\n  const [isConnected, setIsConnected] = useState(false);\n  const reconnectTimeoutRef = useRef<NodeJS.Timeout>();\n  const reconnectAttempts = useRef(0);\n  const maxReconnectAttempts = 5;\n\n  const connect = () => {\n    if (!isAuthenticated || !user || user.role !== 'reseller') {\n      return;\n    }\n\n    try {\n      // Create WebSocket connection\n      const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';\n      const wsUrl = `${protocol}//${window.location.host}/ws`;\n      \n      console.log('Connecting to WebSocket:', wsUrl);\n      \n      const ws = new WebSocket(wsUrl);\n      wsRef.current = ws;\n\n      ws.onopen = () => {\n        console.log('WebSocket connected');\n        setIsConnected(true);\n        reconnectAttempts.current = 0;\n        \n        // Authenticate with the server\n        ws.send(JSON.stringify({\n          type: 'auth',\n          resellerId: user.id\n        }));\n      };\n\n      ws.onmessage = (event) => {\n        try {\n          const data: WebSocketMessage = JSON.parse(event.data);\n          console.log('WebSocket message received:', data);\n          \n          switch (data.type) {\n            case 'auth_success':\n              console.log('WebSocket authentication successful');\n              break;\n              \n            case 'status_change':\n              if (data.isActive === false) {\n                // Account suspended - show alert and logout\n                toast({\n                  title: \"Account Suspended\",\n                  description: data.message || \"YOUR ACCOUNT HAS BEEN SUSPENDED BY ADMIN, CONTACT ADMIN FOR MORE DETAILS.\",\n                  variant: \"destructive\",\n                  duration: 0, // Don't auto-dismiss\n                });\n                \n                // Automatically logout the user\n                setTimeout(() => {\n                  logout();\n                }, 2000);\n              } else {\n                // Account reactivated\n                toast({\n                  title: \"Account Reactivated\",\n                  description: data.message || \"Your account has been reactivated by the admin.\",\n                  variant: \"default\",\n                });\n                \n                // Refresh the page to update the UI\n                setTimeout(() => {\n                  window.location.reload();\n                }, 1500);\n              }\n              break;\n          }\n        } catch (error) {\n          console.error('Error parsing WebSocket message:', error);\n        }\n      };\n\n      ws.onclose = (event) => {\n        console.log('WebSocket disconnected:', event.code, event.reason);\n        setIsConnected(false);\n        wsRef.current = null;\n        \n        // Attempt to reconnect if not intentionally closed\n        if (event.code !== 1000 && reconnectAttempts.current < maxReconnectAttempts) {\n          const delay = Math.min(1000 * Math.pow(2, reconnectAttempts.current), 30000);\n          console.log(`Attempting to reconnect in ${delay}ms (attempt ${reconnectAttempts.current + 1}/${maxReconnectAttempts})`);\n          \n          reconnectTimeoutRef.current = setTimeout(() => {\n            reconnectAttempts.current++;\n            connect();\n          }, delay);\n        }\n      };\n\n      ws.onerror = (error) => {\n        console.error('WebSocket error:', error);\n        setIsConnected(false);\n      };\n    } catch (error) {\n      console.error('Error creating WebSocket connection:', error);\n    }\n  };\n\n  const disconnect = () => {\n    if (reconnectTimeoutRef.current) {\n      clearTimeout(reconnectTimeoutRef.current);\n    }\n    \n    if (wsRef.current) {\n      wsRef.current.close(1000, 'Client disconnecting');\n      wsRef.current = null;\n    }\n    \n    setIsConnected(false);\n  };\n\n  useEffect(() => {\n    if (isAuthenticated && user && user.role === 'reseller') {\n      connect();\n    } else {\n      disconnect();\n    }\n\n    return () => {\n      disconnect();\n    };\n  }, [isAuthenticated, user]);\n\n  return {\n    isConnected,\n    connect,\n    disconnect\n  };\n}","size_bytes":4395},"server/email-service.ts":{"content":"import nodemailer from 'nodemailer';\n\n// Hardcoded Gmail SMTP configuration as requested\nconst GMAIL_USER = 'services.gohan@gmail.com';\nconst GMAIL_APP_PASSWORD = 'tjjr ppgw usyg ohrz';\n\n// Create transporter with hardcoded Gmail SMTP settings\nconst transporter = nodemailer.createTransport({\n  service: 'gmail',\n  auth: {\n    user: GMAIL_USER,\n    pass: GMAIL_APP_PASSWORD\n  }\n});\n\n// Generate a 6-digit OTP\nexport function generateOTP(): string {\n  return Math.floor(100000 + Math.random() * 900000).toString();\n}\n\n// Send OTP email\nexport async function sendOTPEmail(to: string, otp: string): Promise<boolean> {\n  try {\n    const mailOptions = {\n      from: `\"DEXX-TER Security\" <${GMAIL_USER}>`,\n      to: to,\n      subject: 'DEXX-TER Admin Login - OTP Verification',\n      html: `\n        <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; background-color: #f8f9fa;\">\n          <div style=\"background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 30px; border-radius: 10px; text-align: center; margin-bottom: 20px;\">\n            <h1 style=\"color: white; margin: 0; font-size: 28px; font-weight: bold;\">DEXX-TER</h1>\n            <p style=\"color: #e0e6ff; margin: 10px 0 0 0; font-size: 16px;\">Professional License Management System</p>\n          </div>\n          \n          <div style=\"background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);\">\n            <h2 style=\"color: #333; margin-top: 0; text-align: center;\">Admin Login Verification</h2>\n            \n            <p style=\"color: #666; font-size: 16px; line-height: 1.6;\">\n              A login attempt was made to your DEXX-TER admin account. Please use the following One-Time Password (OTP) to complete your login:\n            </p>\n            \n            <div style=\"background: #f8f9ff; border: 2px dashed #667eea; padding: 20px; margin: 25px 0; text-align: center; border-radius: 8px;\">\n              <div style=\"font-size: 32px; font-weight: bold; color: #667eea; letter-spacing: 8px; font-family: 'Courier New', monospace;\">\n                ${otp}\n              </div>\n              <p style=\"margin: 10px 0 0 0; color: #888; font-size: 14px;\">This OTP expires in 1 minute</p>\n            </div>\n            \n            <div style=\"background: #fff3cd; border-left: 4px solid #ffc107; padding: 15px; margin: 20px 0; border-radius: 4px;\">\n              <p style=\"margin: 0; color: #856404; font-size: 14px;\">\n                <strong>⚠️ Security Notice:</strong> If you did not request this login, please ignore this email and contact support immediately.\n              </p>\n            </div>\n            \n            <div style=\"text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid #eee;\">\n              <p style=\"color: #888; font-size: 12px; margin: 0;\">\n                This is an automated message from DEXX-TER Security System<br>\n                Please do not reply to this email.\n              </p>\n            </div>\n          </div>\n        </div>\n      `\n    };\n\n    const info = await transporter.sendMail(mailOptions);\n    console.log('✅ OTP email sent successfully:', info.messageId);\n    return true;\n  } catch (error) {\n    console.error('❌ Error sending OTP email:', error);\n    return false;\n  }\n}\n\n// Test email configuration\nexport async function testEmailConfiguration(): Promise<boolean> {\n  try {\n    await transporter.verify();\n    console.log('✅ Email service is ready');\n    return true;\n  } catch (error) {\n    console.error('❌ Email service configuration error:', error);\n    return false;\n  }\n}","size_bytes":3628},"server/models/OTP.ts":{"content":"import mongoose, { Document, Schema } from 'mongoose';\n\nexport interface IOTP extends Document {\n  id: number;\n  adminId: number;\n  otp: string;\n  isUsed: boolean;\n  expiresAt: Date;\n  createdAt: Date;\n}\n\nconst otpSchema = new Schema<IOTP>({\n  id: {\n    type: Number,\n    required: true,\n    unique: true,\n  },\n  adminId: {\n    type: Number,\n    required: true,\n    ref: 'Admin',\n  },\n  otp: {\n    type: String,\n    required: true,\n    length: 6,\n  },\n  isUsed: {\n    type: Boolean,\n    default: false,\n  },\n  expiresAt: {\n    type: Date,\n    required: true,\n    default: () => new Date(Date.now() + 60 * 1000), // 1 minute from now\n  },\n}, {\n  timestamps: true,\n  collection: 'otps'\n});\n\n// Create TTL index for automatic cleanup of expired OTPs\notpSchema.index({ expiresAt: 1 }, { expireAfterSeconds: 0 });\n\n// Method to check if OTP is valid (not used and not expired)\notpSchema.methods.isValid = function(): boolean {\n  return !this.isUsed && new Date() < this.expiresAt;\n};\n\nexport const OTP = mongoose.model<IOTP>('OTP', otpSchema);","size_bytes":1038}},"version":1}